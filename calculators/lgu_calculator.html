<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LG U+ ì¸í„°ë„· ëª¨ë°”ì¼ ê²°í•©í• ì¸ ê³„ì‚°ê¸°</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@400;500;700&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Noto Sans KR', sans-serif; background-color: #f8fafc; }
        .input-group { margin-bottom: 1.5rem; }
        .input-label { display: block; margin-bottom: 0.5rem; font-weight: 500; color: #334155; }
        .input-field, .select-field { width: 100%; padding: 0.5rem 0.75rem; border: 1px solid #cbd5e1; border-radius: 0.375rem; box-shadow: sm; transition: border-color 0.15s ease-in-out, box-shadow 0.15s ease-in-out; }
        .input-field:focus, .select-field:focus { border-color: #ec4899; outline: none; box-shadow: 0 0 0 0.2rem rgba(236, 72, 153, 0.25); }
        .input-field:disabled, .select-field:disabled { background-color: #e2e8f0; cursor: not-allowed; opacity: 0.7; }
        .btn-primary { background-color: #ec4899; color: white; padding: 0.75rem 1.5rem; border-radius: 0.375rem; font-weight: 600; transition: background-color 0.3s ease; border: none; cursor: pointer;}
        .btn-primary:hover { background-color: #db2777; }
        .btn-secondary { background-color: #64748b; color: white; padding: 0.5rem 1rem; border-radius: 0.375rem; font-weight: 500; transition: background-color 0.3s ease; border: none; cursor: pointer;}
        .btn-secondary:hover { background-color: #475569; }
        .section-title { font-size: 1.5rem; font-weight: 700; color: #c026d3; margin-bottom: 1rem; padding-bottom: 0.5rem; border-bottom: 2px solid #f0abfc; }
        .result-card { background-color: white; padding: 1.5rem; border-radius: 0.5rem; box-shadow: 0 4px 6px -1px rgba(0,0,0,0.1), 0 2px 4px -1px rgba(0,0,0,0.06); margin-bottom: 1.5rem; }
        .result-label { color: #475569; }
        .result-value { color: #1e293b; font-weight: 600; }
        .total-value { color: #d946ef; font-size: 1.5rem; font-weight: 700; }
        .mobile-line-item { border: 1px solid #e2e8f0; padding: 1rem; border-radius: 0.375rem; margin-bottom: 0.75rem; }
        .radio-label { margin-right: 1rem; margin-bottom: 0.5rem; display: inline-flex; align-items: center; cursor: pointer; }
        .radio-input { margin-right: 0.5rem; accent-color: #ec4899; }
        .toggle-switch { position: relative; display: inline-block; width: 40px; height: 20px; margin-left: 10px; vertical-align: middle; }
        .toggle-switch input { opacity: 0; width: 0; height: 0; }
        .slider { position: absolute; cursor: pointer; top: 0; left: 0; right: 0; bottom: 0; background-color: #ccc; transition: .4s; border-radius: 20px; }
        .slider:before { position: absolute; content: ""; height: 16px; width: 16px; left: 2px; bottom: 2px; background-color: white; transition: .4s; border-radius: 50%; }
        input:checked+.slider { background-color: #ec4899; }
        input:checked+.slider:before { transform: translateX(20px); }
        .discount-details { background-color: #fce7f3; border: 1px solid #f9a8d4; padding: 0.75rem; border-radius: 0.375rem; font-size: 0.875rem; }
        .discount-details ul { padding-left: 1.25rem; list-style-type: disc; margin-left: 0.5rem; }
        .summary-item { margin-bottom: 0.25rem; }
        .hidden { display: none !important; }
        .summary-card-main { background-color: #fff; border: 2px solid #ec4899; border-radius: 0.5rem; padding: 1.5rem; box-shadow: 0 10px 15px -3px rgba(0,0,0,0.1), 0 4px 6px -2px rgba(0,0,0,0.05); display: grid; grid-template-columns: 1fr 1fr; gap: 1.5rem; }
        .summary-column { display: flex; flex-direction: column; gap: 1.5rem; }
        .summary-item-block { background-color: #f8fafc; padding: 1rem; border-radius: 0.5rem; text-align: center; }
        .summary-item-label { font-size: 1rem; font-weight: 500; color: #475569; margin-bottom: 0.25rem; }
        .summary-item-value { font-size: 2.25rem; font-weight: 700; color: #c026d3; line-height: 1.1; }
        .pre-discount-price { font-size: 0.875rem; color: #64748b; text-decoration: line-through; margin-bottom: 0.25rem; }
        .discount-value { color: #2563eb; }
        .gift-value { color: #16a34a; }
        .discount-reason { margin-top: 1rem; padding: 0.75rem; background-color: #fefce8; border-radius: 0.375rem; font-size: 0.875rem; color: #854d0e; text-align: center; border-left: 4px solid #f59e0b; grid-column: 1 / -1; }
        .btn-kakao { background-color: #FEE500; color: #191919; }
        .btn-kakao:hover { background-color: #F7E600; }
    </style>
</head>
<body class="text-slate-800">
    <header class="bg-pink-700 text-white p-6 shadow-md">
        <div class="container mx-auto max-w-4xl">
            <h1 class="text-3xl font-bold text-center">LG U+ ê²°í•© í• ì¸ ê³„ì‚°ê¸°</h1>
            <p class="text-center text-pink-200 mt-1">ì„ íƒí•˜ì‹  ì„œë¹„ìŠ¤ì™€ í• ì¸ ìœ í˜•ì— ë”°ë¥¸ ì˜ˆìƒ ìš”ê¸ˆì„ ê³„ì‚°í•´ ë³´ì„¸ìš”.</p>
        </div>
    </header>

    <main class="container mx-auto max-w-4xl p-4 sm:p-6 lg:p-8">
        <section id="inputSection" class="mb-8">
            <h2 class="section-title">1. ì„œë¹„ìŠ¤ ì„ íƒ (3ë…„ ì•½ì • ê¸°ì¤€, VAT í¬í•¨)</h2>
            <p class="mb-6 text-sm text-slate-600">ì•„ë˜ í•­ëª©ë“¤ì„ ì„ íƒí•˜ê±°ë‚˜ ì…ë ¥í•´ì£¼ì„¸ìš”. ëª¨ë“  ìš”ê¸ˆì€ LG U+ í‘œì¤€ 3ë…„ ì•½ì •, ë¶€ê°€ì„¸ í¬í•¨ ì •ê°€ë¥¼ ê¸°ì¤€ìœ¼ë¡œ í•©ë‹ˆë‹¤.</p>
            
            <div class="input-group">
                <label class="input-label">ì¸í„°ë„· ìœ í˜• ì„ íƒ</label>
                <div class="flex items-center space-x-4">
                    <label class="radio-label"><input type="radio" name="internetType" value="bundle" class="radio-input" checked> ì¸í„°ë„· + TV ë²ˆë“¤</label>
                    <label class="radio-label"><input type="radio" name="internetType" value="standalone" class="radio-input"> ì¸í„°ë„· ë‹¨ë…</label>
                </div>
            </div>

            <div class="grid md:grid-cols-2 gap-6">
                <div class="input-group">
                    <label for="internetPlan" class="input-label">ì¸í„°ë„· ìš”ê¸ˆì œ</label>
                    <select id="internetPlan" class="select-field">
                        <option value="none">ì„ íƒ ì•ˆí•¨</option>
                    </select>
                    <p class="text-xs text-slate-500 mt-1" id="internetNotes">ì°¸ê³ : WiFi ê³µìœ ê¸° í¬í•¨.</p>
                </div>
                
                <div class="input-group">
                    <label for="tvPlan" class="input-label">U+tv ìš”ê¸ˆì œ (1ë²ˆì§¸ TV)</label>
                    <select id="tvPlan" class="select-field">
                        <option value="none">ì„ íƒ ì•ˆí•¨</option>
                    </select>
                     <p class="text-xs text-slate-500 mt-1">ì°¸ê³ : ìœ„ ìš”ê¸ˆì€ ì…‹í†±ë°•ìŠ¤ í¬í•¨, ì¸í„°ë„· ê²°í•© ì‹œ 3ë…„ ì•½ì • ê¸°ì¤€ì…ë‹ˆë‹¤.</p>
                </div>

                <div class="input-group">
                    <label for="additionalTvPlan" class="input-label">ì¶”ê°€ U+tv ì„ íƒ (2ë²ˆì§¸ TV)</label>
                    <select id="additionalTvPlan" class="select-field">
                        <option value="none">ì„ íƒ ì•ˆí•¨</option>
                    </select>
                      <p class="text-xs text-slate-500 mt-1">ì°¸ê³ : ì¶”ê°€ TV ìš”ê¸ˆì€ í”Œëœê³¼ ì…‹í†±ë°•ìŠ¤ ì„ëŒ€ë£Œê°€ í¬í•¨ëœ ì´ ê¸ˆì•¡ì…ë‹ˆë‹¤.</p>
                </div>
                
                <div class="input-group">
                    <label for="phonePlan" class="input-label">ì¸í„°ë„·ì „í™” ìš”ê¸ˆì œ (ì„ íƒ)</label>
                    <select id="phonePlan" class="select-field">
                        <option value="none" selected>ì„ íƒ ì•ˆí•¨</option>
                    </select>
                </div>
            </div>

            <div class="input-group mt-6">
                <label class="input-label">ëª¨ë°”ì¼ íšŒì„  ì •ë³´ (ê²°í•© í• ì¸ì— ì˜í–¥)</label>
                <div class="flex items-center mb-2">
                    <label for="mobileLinesCount" class="mr-2 text-sm text-slate-700">ê²°í•©í•  ëª¨ë°”ì¼ íšŒì„  ìˆ˜:</label>
                    <input type="number" id="mobileLinesCount" min="0" max="10" value="0" class="input-field w-20 text-center">
                </div>
                <div id="mobileLinesContainer" class="space-y-3"></div>
                 <p class="text-xs text-slate-500 mt-1">ì°¸ê³ : 'ì°¸ì‰¬ìš´ ê°€ì¡±ê²°í•©'ì€ ìµœëŒ€ 10íšŒì„ , 'íˆ¬ê²Œë” ê²°í•©'ì€ ìµœëŒ€ 5íšŒì„ ê¹Œì§€ íœ´ëŒ€í° ê²°í•© ê°€ëŠ¥.</p>
            </div>
        </section>

        <section id="discountTypeSection" class="mb-8">
            <h2 class="section-title">2. ê²°í•© í• ì¸ ìœ í˜• ì„ íƒ</h2>
            <div class="bg-white p-6 rounded-lg shadow">
                <p class="mb-4 text-sm text-slate-600">ê°€ì¥ ìœ ë¦¬í•œ í• ì¸ ìœ í˜•ì„ ì„ íƒí•˜ê±°ë‚˜, ê° ìœ í˜•ë³„ ì˜ˆìƒ ìš”ê¸ˆì„ ë¹„êµí•´ë³´ì„¸ìš”. (ì¸í„°ë„· ìš”ê¸ˆ í• ì¸ ê¸°ì¤€)</p>
                <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-x-4 gap-y-2">
                    <div class="flex items-center">
                        <label class="radio-label"><input type="radio" name="discountType" value="none" class="radio-input" checked> ê²°í•©í• ì¸ ì—†ìŒ</label>
                    </div>
                    <div class="flex items-center">
                        <label class="radio-label"><input type="radio" name="discountType" value="cham_family" class="radio-input"> ì°¸ì‰¬ìš´ ê°€ì¡±ê²°í•©</label>
                        <label class="toggle-switch">
                            <input type="checkbox" id="chamFamilyDetailsToggle">
                            <span class="slider"></span>
                        </label>
                        <span class="ml-1 text-xs text-slate-500">(ìƒì„¸ë³´ê¸°)</span>
                    </div>
                    <div class="flex items-center">
                        <label class="radio-label"><input type="radio" name="discountType" value="together_bundle" class="radio-input"> íˆ¬ê²Œë” ê²°í•©</label>
                        <label class="toggle-switch">
                            <input type="checkbox" id="togetherDetailsToggle">
                            <span class="slider"></span>
                        </label>
                        <span class="ml-1 text-xs text-slate-500">(ìƒì„¸ë³´ê¸°)</span>
                    </div>
                    <div class="flex items-center">
                        <label class="radio-label"><input type="radio" name="discountType" value="internet_family_all_together" class="radio-input"> ì¸í„°ë„· ê°€ì¡±ë¼ë¦¬ ë‹¤ëª¨ì—¬ ê²°í•©</label>
                        <label class="toggle-switch">
                            <input type="checkbox" id="internetFamilyDetailsToggle">
                            <span class="slider"></span>
                        </label>
                        <span class="ml-1 text-xs text-slate-500">(ìƒì„¸ë³´ê¸°)</span>
                    </div>
                    <div class="flex items-center">
                        <label class="radio-label"><input type="radio" name="discountType" value="mvno_bundle" class="radio-input"> ì•Œëœ°í° ê²°í•©</label>
                        <label class="toggle-switch">
                            <input type="checkbox" id="mvnoLGUDetailsToggle">
                            <span class="slider"></span>
                        </label>
                        <span class="ml-1 text-xs text-slate-500">(ìƒì„¸ë³´ê¸°)</span>
                    </div>
                </div>

                <div id="chamFamilyDetailsContainer" class="mt-3 hidden discount-details">
                    <p class="font-semibold mb-1">ì°¸ì‰¬ìš´ ê°€ì¡±ê²°í•© ìƒì„¸:</p>
                    <p>ì˜ˆìƒ ì¸í„°ë„· í• ì¸: <span id="detailCfInternetDiscount" class="font-bold">0</span>ì›</p>
                    <p>ì˜ˆìƒ íœ´ëŒ€í° ì´ í• ì¸: <span id="detailCfMobileDiscount" class="font-bold">0</span>ì›</p>
                    <hr class="my-2 border-pink-300">
                    <p class="text-xs mt-2 mb-1 text-pink-700 font-semibold">ì£¼ìš” ì°¸ê³ ì‚¬í•­:</p>
                    <ul class="list-disc text-xs space-y-0.5">
                        <li>ì¡°ê±´ ì—†ì´ ê°€ì¡±ì´ ëª¨ì´ë©´ í• ì¸ì„ ë°›ëŠ” ê²°í•© ìƒí’ˆ.</li>
                        <li>ìµœëŒ€ ì¸í„°ë„· 3íšŒì„  + íœ´ëŒ€í° 10íšŒì„  ê²°í•© ê°€ëŠ¥.</li>
                        <li>íœ´ëŒ€í° í• ì¸ì€ 2ëŒ€ë¶€í„° ì ìš©. (ìš”ê¸ˆì œ êµ¬ê°„ë³„ í• ì¸ì•¡ ìƒì´: 2,200ì› ~ 11,000ì›/ëŒ€)</li>
                        <li>ì¸í„°ë„· í• ì¸ì€ íœ´ëŒ€í° 1ëŒ€ ì´ìƒ ê²°í•© ì‹œ ì ìš©. (100M: 5,500ì›, 500M: 9,900ì›, 1G: 13,200ì›)</li>
                        <li>ì¸í„°ë„·ê³¼ íœ´ëŒ€í° ëª…ì˜ì ë‹¬ë¼ë„ ê²°í•© ê°€ëŠ¥ (ê°€ì¡±ê´€ê³„ ì¦ë¹™ í•„ìš”).</li>
                        <li>ì•Œëœ°í° ê²°í•© ì‹œ, ê²°í•© ë‚´ ì•Œëœ°í° íœ´ëŒ€í° ë²ˆí˜¸ ê°œìˆ˜ X U+ íœ´ëŒ€í°ì— 440ì› ì¶”ê°€ í• ì¸ ì œê³µ ê°€ëŠ¥.</li>
                    </ul>
                </div>
                <div id="togetherDetailsContainer" class="mt-3 hidden discount-details">
                    <p class="font-semibold mb-1">íˆ¬ê²Œë” ê²°í•© ìƒì„¸:</p>
                    <p>ì˜ˆìƒ ì¸í„°ë„· í• ì¸: <span id="detailTgInternetDiscount" class="font-bold">0</span>ì›</p>
                    <p>ì˜ˆìƒ íœ´ëŒ€í° ì´ í• ì¸: <span id="detailTgMobileDiscount" class="font-bold">0</span>ì›</p>
                    <hr class="my-2 border-pink-300">
                    <p class="text-xs mt-2 mb-1 text-pink-700 font-semibold">ì£¼ìš” ì°¸ê³ ì‚¬í•­:</p>
                    <ul class="list-disc text-xs space-y-0.5">
                        <li>ì¡°ê±´: ì¸í„°ë„· 500M ì´ìƒ & ëª¨ë“  ê²°í•© íœ´ëŒ€í°ì´ ì›” 85,000ì› ì´ìƒ ìš”ê¸ˆì œ ì´ìš© ì‹œ.</li>
                        <li>ëŒ€ìƒ: ê°€ì¡±, ì¹œêµ¬, ì§€ì¸ ëª¨ë‘ ê²°í•© ê°€ëŠ¥.</li>
                        <li>ì¸í„°ë„· í• ì¸: 11,000ì› (100M ì¸í„°ë„· ê²°í•© ë¶ˆê°€).</li>
                        <li>íœ´ëŒ€í° í• ì¸ì€ ê²°í•© íšŒì„  ìˆ˜(2~5íšŒì„ )ì— ë”°ë¼ ê° íœ´ëŒ€í°ì— ì ìš© (ì¸ë‹¹ 10,000ì› ~ 20,000ì›).</li>
                    </ul>
                </div>
                 <div id="internetFamilyDetailsContainer" class="mt-3 hidden discount-details">
                    <p class="font-semibold mb-1">ì¸í„°ë„· ê°€ì¡±ë¼ë¦¬ ë‹¤ëª¨ì—¬ ê²°í•© ìƒì„¸:</p>
                    <p>ì˜ˆìƒ ì¶”ê°€ ì¸í„°ë„· í• ì¸ (ìíšŒì„ ): <span id="detailIfInternetDiscount" class="font-bold">0</span>ì›</p>
                    <hr class="my-2 border-pink-300">
                    <p class="text-xs mt-2 mb-1 text-pink-700 font-semibold">ì£¼ìš” ì°¸ê³ ì‚¬í•­:</p>
                    <ul class="list-disc text-xs space-y-0.5">
                        <li>ì¡°ê±´: ë³¸ì¸ ë˜ëŠ” ì§ê³„ê°€ì¡±ì˜ ê¸°ì¡´ U+ ì¸í„°ë„·(ëª¨íšŒì„ ) ì‚¬ìš© ì‹œ, ì‹ ê·œ ì¥ì†Œ ì¶”ê°€ íšŒì„ (ìíšŒì„ )ì— í• ì¸.</li>
                        <li>í• ì¸ì•¡ (ìíšŒì„  ì¸í„°ë„·): 5,500ì›.</li>
                        <li>ê²°í•© í•œë„: ëª¨íšŒì„  1ê°œ + ìíšŒì„  10ê°œ.</li>
                        <li>íƒ€ ê²°í•©ê³¼ ì¤‘ë³µ ë¶ˆê°€.</li>
                    </ul>
                </div>
                <div id="mvnoLGUDetailsContainer" class="mt-3 hidden discount-details">
                    <p class="font-semibold mb-1">ì•Œëœ°í° ê²°í•© ìƒì„¸:</p>
                    <p>ì˜ˆìƒ ì¸í„°ë„· í• ì¸: <span id="detailMvnoLGUInternetDiscount" class="font-bold">0</span>ì›</p>
                    <hr class="my-2 border-pink-300">
                    <p class="text-xs mt-2 mb-1 text-pink-700 font-semibold">ì£¼ìš” ì°¸ê³ ì‚¬í•­:</p>
                    <ul class="list-disc text-xs space-y-1">
                        <li>ê²°í•© ê°€ëŠ¥ ìš”ê¸ˆì œ í™•ì¸: <a href="https://www.uplusmvno.com/plan/plan-list" target="_blank" class="text-blue-600 hover:underline font-bold">U+ì•Œëœ°í° íŒŒíŠ¸ë„ˆìŠ¤ ë°”ë¡œê°€ê¸°</a></li>
                        <li>í™•ì¸ ë°©ë²•: ìœ„ ë§í¬ ì ‘ì† â†’ ì™¼ìª½ ë©”ë‰´ 'U+ì¸í„°ë„· ê²°í•©ìš”ê¸ˆì œ' ì²´í¬ â†’ ì˜¤ë¥¸ìª½ ìš”ê¸ˆì œ ë¦¬ìŠ¤íŠ¸ì—ì„œ í™•ì¸</li>
                        <li>ê³„ì•½ëœ ì•Œëœ° í†µì‹ ì‚¬ ë° ìš”ê¸ˆì œë§Œ ê²°í•© ê°€ëŠ¥í•©ë‹ˆë‹¤.</li>
                        <li>ì¸í„°ë„· í• ì¸ í˜œíƒ (íœ´ëŒ€í° ìš”ê¸ˆ í• ì¸ ì—†ìŒ):
                            <ul class="list-disc pl-4">
                                <li>100M ì¸í„°ë„· + ì•Œëœ°í°: 5,500ì› í• ì¸</li>
                                <li>500M ì¸í„°ë„· + ì•Œëœ°í°: 9,900ì› í• ì¸</li>
                                <li>1G ì¸í„°ë„· + ì•Œëœ°í°: 13,200ì› í• ì¸</li>
                            </ul>
                        </li>
                    </ul>
                </div>
            </div>
        </section>

        <section id="installationSection" class="mb-8">
            <h2 class="section-title">3. ì„¤ì¹˜ ì˜µì…˜</h2>
            <div class="input-group bg-white p-6 rounded-lg shadow">
                <label class="input-label">ì„¤ì¹˜ í¬ë§ ì‹œì  (ì„¤ì¹˜ë¹„ ë³€ë™)</label>
                <div class="space-y-2">
                    <label class="radio-label"><input type="radio" name="installationTime" value="weekday" class="radio-input" checked> í‰ì¼ ì£¼ê°„</label>
                    <label class="radio-label"><input type="radio" name="installationTime" value="weekend" class="radio-input"> ì£¼ë§/ì•¼ê°„ (í• ì¦ ì ìš©)</label>
                </div>
            </div>
        </section>

        <div class="text-center mb-8">
            <button id="calculateButton" class="btn-primary text-lg">ì˜ˆìƒ ìš”ê¸ˆ ê³„ì‚°í•˜ê¸°</button>
            <button id="resetButton" class="btn-secondary text-lg ml-4">ì´ˆê¸°í™”</button>
        </div>

        <section id="resultSection" class="hidden">
            <h2 class="section-title">ğŸ“Š ê³„ì‚° ê²°ê³¼</h2>

            <div role="alert" class="my-4 p-4 rounded-md border-l-4 bg-blue-50 border-blue-400">
                <div class="flex items-center">
                    <div class="flex-shrink-0">
                        <svg class="h-6 w-6 text-blue-600" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                            <path stroke-linecap="round" stroke-linejoin="round" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
                        </svg>
                    </div>
                    <div class="ml-3">
                        <p class="font-bold text-blue-800">â€» ì¤‘ìš”: ê²°í•©ìƒí’ˆ ì§ì ‘ ì‹ ì²­ ì•ˆë‚´</p>
                        <p class="text-sm text-blue-700 mt-1">
                            ëª¨ë“  ê²°í•© í• ì¸ì€ ì¸í„°ë„· ì„¤ì¹˜ê°€ ì™„ë£Œëœ í›„, ê³ ê°ë‹˜ê»˜ì„œ ì§ì ‘ ì´ìš©í•˜ì‹œëŠ” í†µì‹ ì‚¬ ê³ ê°ì„¼í„°(ì˜ˆ: íœ´ëŒ€í° í†µì‹ ì‚¬)ë¡œ ì—°ë½í•˜ì‹œì–´ 'ìœ ë¬´ì„  ê²°í•©'ì„ ì‹ ì²­í•´ì•¼ ìµœì¢… ì ìš©ë©ë‹ˆë‹¤.
                        </p>
                    </div>
                </div>
            </div>
            
            <div class="summary-card-main">
                <div class="summary-column">
                    <div class="summary-item-block">
                        <p class="pre-discount-price"><span id="preDiscountWiredFeeEl">0</span> ì›</p>
                        <p class="summary-item-label">ì›” ì¸í„°ë„·/TV ìš”ê¸ˆ</p>
                        <p class="summary-item-value"><span id="finalWiredFeeEl">0</span> ì›</p>
                    </div>
                    <div class="summary-item-block">
                        <p class="summary-item-label">ì¸í„°ë„· í• ì¸</p>
                        <p class="summary-item-value discount-value">- <span id="internetDiscountEl">0</span> ì›</p>
                    </div>
                </div>
                <div class="summary-column">
                    <div class="summary-item-block">
                        <p class="summary-item-label">í˜„ê¸ˆ ì‚¬ì€í’ˆ</p>
                        <p class="summary-item-value gift-value"><span id="giftAmountEl">0</span> ì›</p>
                    </div>
                    <div class="summary-item-block">
                        <p class="summary-item-label">íœ´ëŒ€í° í• ì¸</p>
                        <p class="summary-item-value discount-value">- <span id="mobileDiscountEl">0</span> ì›</p>
                    </div>
                </div>
                 <p id="discountReason" class="discount-reason hidden"></p>
            </div>
            
            <div id="consultationButtons" class="mt-8 p-6 rounded-lg bg-slate-100 border border-slate-200">
                <h3 class="text-xl font-bold text-slate-800 flex items-center justify-center mb-1">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 mr-2 text-blue-500" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z" /></svg>
                    ì´ ê²°ê³¼ë¡œ ìƒë‹´í•˜ê¸°
                </h3>
                <p class="text-sm text-slate-600 mb-6 text-center">ê³„ì‚° ê²°ê³¼ë¥¼ ì „ë¬¸ê°€ì—ê²Œ ë³´ë‚´ê³  ë°”ë¡œ ìƒë‹´ì„ ì‹œì‘í•˜ì„¸ìš”!</p>
                <div class="grid grid-cols-1 sm:grid-cols-2 gap-3">
                    <button id="sendKakaoButton" class="w-full py-3 px-5 rounded-lg font-bold text-base transition-colors btn-kakao">ì¹´ì¹´ì˜¤í†¡ìœ¼ë¡œ ë³´ë‚´ê¸°</button>
                    <button id="sendSmsButton" class="w-full py-3 px-5 rounded-lg font-bold text-base transition-colors bg-slate-700 text-white hover:bg-slate-600">ë¬¸ì ë©”ì‹œì§€ë¡œ ë³´ë‚´ê¸°</button>
                </div>
            </div>

            <div class="text-center my-8">
                <button id="detailsToggleButton" class="btn-secondary text-sm">ìƒì„¸ ìš”ê¸ˆ ë‚´ì—­ ì „ì²´ ë³´ê¸° â–¼</button>
            </div>

            <div id="detailsContainer" class="hidden">
                <div class="result-card">
                    <h3 class="text-xl font-semibold text-pink-600 mb-3">ìš”ê¸ˆ ìš”ì•½ (VAT í¬í•¨)</h3>
                    <div class="grid md:grid-cols-2 gap-4">
                        <div>
                            <p class="result-label summary-item">ì„ íƒ ì¸í„°ë„·: <span id="selectedInternet" class="result-value"></span></p>
                            <p class="result-label summary-item">ì„ íƒ U+tv (1ë²ˆì§¸): <span id="selectedTv" class="result-value"></span></p>
                            <p class="result-label summary-item">ì„ íƒ ì¶”ê°€ U+tv (2ë²ˆì§¸): <span id="selectedAdditionalTv" class="result-value"></span></p>
                            <p class="result-label summary-item">ì„ íƒ ì¸í„°ë„·ì „í™”: <span id="selectedPhone" class="result-value"></span></p>
                            <p class="result-label summary-item">ëª¨ë°”ì¼ íšŒì„  ìˆ˜: <span id="selectedMobileCount" class="result-value"></span></p>
                            <p class="result-label summary-item">ì ìš© í• ì¸ ìœ í˜•: <span id="selectedDiscountType" class="result-value"></span></p>
                        </div>
                        <div>
                            <p class="result-label summary-item">ì›” ì¸í„°ë„· ê¸°ë³¸ë£Œ (TVê²°í•©ì—¬ë¶€ ë°˜ì˜): <span id="totalBaseInternetCost" class="result-value">0</span> ì›</p>
                            <p class="result-label text-green-600 summary-item">ì›” ì´ ì¸í„°ë„· ê²°í•© í• ì¸ì•¡: <span id="totalInternetDiscountAmount" class="result-value text-green-600">0</span> ì›</p>
                            
                            <div id="tvCostSummaryContainer" class="hidden"> 
                                <hr class="my-1 border-slate-200">
                                <p class="result-label summary-item">ì›” U+tv ìš”ê¸ˆ (1ë²ˆì§¸): <span id="tvBaseCostDisplay" class="result-value">0</span> ì›</p>
                            </div>
                             <div id="additionalTvCostSummaryContainer" class="hidden">
                                <hr class="my-1 border-slate-200">
                                <p class="result-label summary-item">ì›” ì¶”ê°€ U+tv ìš”ê¸ˆ (2ë²ˆì§¸): <span id="additionalTvCostDisplay" class="result-value">0</span> ì›</p>
                            </div>
                            <div id="phoneCostSummaryContainer" class="hidden">
                                <hr class="my-1 border-slate-200">
                                <p class="result-label summary-item">ì›” ì¸í„°ë„·ì „í™” ê¸°ë³¸ë£Œ: <span id="phoneBaseCostDisplay" class="result-value">0</span> ì›</p>
                            </div>
                            <hr class="my-1 border-pink-300">
                            <p class="mt-2 text-lg font-semibold">ìµœì¢… ì˜ˆìƒ ì›” ë‚©ë¶€ì•¡ (ìœ ì„ ìƒí’ˆ): <span id="finalMonthlyCost" class="total-value">0</span> ì›</p>
                        </div>
                    </div>

                    <div id="mobileDiscountDetailsContainer" class="mt-6 hidden">
                        <h4 class="text-lg font-semibold text-pink-600 mb-2 border-t pt-4">ëª¨ë°”ì¼ ìš”ê¸ˆ í• ì¸ ìƒì„¸</h4>
                        <div id="mobileDiscountResultList" class="space-y-2 text-sm"></div>
                    </div>
                </div>

                <div class="result-card">
                    <h3 class="text-xl font-semibold text-pink-600 mb-3">ğŸ ì‚¬ì€í’ˆ í˜œíƒ (ì˜ˆìƒ í˜„ê¸ˆ)</h3>
                    <p class="result-label summary-item">í˜„ê¸ˆ ì‚¬ì€í’ˆ: <span id="giftCash" class="result-value">0</span> ì›</p>
                     <p class="text-xs text-pink-500 mt-1">* ì‚¬ì€í’ˆ ì •ë³´ëŠ” ë³€ë™ë  ìˆ˜ ìˆìœ¼ë‹ˆ ê°€ì… ì‹œì ì— ë°˜ë“œì‹œ ì¬í™•ì¸ ë°”ëë‹ˆë‹¤.</p>
                </div>

                <div class="result-card">
                    <h3 class="text-xl font-semibold text-pink-600 mb-3">ì´ˆê¸° ì„¤ì¹˜ ë¹„ìš© (ì„ íƒí•œ ëª¨ë“  ìœ ì„  ì„œë¹„ìŠ¤ ê¸°ì¤€)</h3>
                    <p class="result-label">ì˜ˆìƒ ì´ ì„¤ì¹˜ë¹„: <span id="installationCostResult" class="result-value text-lg">0</span> ì›</p>
                    <p class="text-xs text-slate-500 mt-1">* ì„ íƒí•˜ì‹  ì„¤ì¹˜ ì‹œì (í‰ì¼/ì£¼ë§) ë° ì„œë¹„ìŠ¤ ì¡°í•©ì— ë”°ë¼ ê³„ì‚°ë©ë‹ˆë‹¤. í”„ë¡œëª¨ì…˜ìœ¼ë¡œ ë©´ì œë  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
                </div>
            </div>
        </section>
        
    </main>

    <footer class="text-center p-6 mt-12 bg-pink-800 text-pink-200 text-sm">
        <p>ë³¸ ê³„ì‚°ê¸°ëŠ” LG U+ íŒë§¤ì  ë¯¸ì†Œì— ì œê³µí•©ë‹ˆë‹¤.</p>
        <p>&copy; 2024 LG U+ ê²°í•© í• ì¸ ê³„ì‚°ê¸°. ëª¨ë“  ì •ë³´ëŠ” ì°¸ê³ ìš©ì…ë‹ˆë‹¤.</p>
    </footer>

    <script>
        const lguMobilePlans = [
            { "plan_name": "5G ì‹œê·¸ë‹ˆì²˜", "network_type": "5G", "price": 130000, "url": "https://www.lguplus.com/mobile/plan/mplan/5g-all/5g-unlimited/Z202205253" },
            { "plan_name": "5G í”„ë¦¬ë¯¸ì–´ ìŠˆí¼", "network_type": "5G", "price": 115000, "url": "https://www.lguplus.com/mobile/plan/mplan/5g-all/5g-unlimited/Z202205251" },
            { "plan_name": "5G í”„ë¦¬ë¯¸ì–´ í”ŒëŸ¬ìŠ¤", "network_type": "5G", "price": 105000, "url": "https://www.lguplus.com/mobile/plan/mplan/5g-all/5g-unlimited/Z202205252" },
            { "plan_name": "5G í”„ë¦¬ë¯¸ì–´ ë ˆê·¤ëŸ¬", "network_type": "5G", "price": 95000, "url": "https://www.lguplus.com/mobile/plan/mplan/5g-all/5g-unlimited/LPZ0000433" },
            { "plan_name": "5G í”„ë¦¬ë¯¸ì–´ ì—ì„¼ì…œ", "network_type": "5G", "price": 85000, "url": "https://www.lguplus.com/mobile/plan/mplan/5g-all/5g-unlimited/LPZ0000409" },
            { "plan_name": "5G ìŠ¤íƒ ë‹¤ë“œ", "network_type": "5G", "price": 75000, "url": "https://www.lguplus.com/mobile/plan/mplan/5g-all/5g-unlimited/LPZ0000415" },
            { "plan_name": "5G ìŠ¤íƒ ë‹¤ë“œ ì—ì„¼ì…œ", "network_type": "5G", "price": 70000, "url": "https://www.lguplus.com/mobile/plan/mplan/5g-all/5g-unlimited/LPZ0000784" },
            { "plan_name": "ì¶”ê°€ ìš”ê¸ˆ ê±±ì • ì—†ëŠ” ë°ì´í„° 69", "network_type": "LTE", "price": 69000, "url": "https://www.lguplus.com/mobile/plan/mplan/lte-all/lte-unlimited/LPZ0000464" },
            { "plan_name": "5G ë°ì´í„° ìŠˆí¼", "network_type": "5G", "price": 68000, "url": "https://www.lguplus.com/mobile/plan/mplan/5g-all/5g-unlimited/LPZ0000781" },
            { "plan_name": "5G ë°ì´í„° í”ŒëŸ¬ìŠ¤", "network_type": "5G", "price": 66000, "url": "https://www.lguplus.com/mobile/plan/mplan/5g-all/5g-unlimited/LPZ0000782" },
            { "plan_name": "5G ë°ì´í„° ë ˆê·¤ëŸ¬", "network_type": "5G", "price": 63000, "url": "https://www.lguplus.com/mobile/plan/mplan/5g-all/5g-unlimited/LPZ0000783" },
            { "plan_name": "5G ì‹¬í”Œ+", "network_type": "5G", "price": 61000, "url": "https://www.lguplus.com/mobile/plan/mplan/5g-all/5g-unlimited/LPZ0002860" },
            { "plan_name": "5G ë² ì´ì§+", "network_type": "5G", "price": 59000, "url": "https://www.lguplus.com/mobile/plan/mplan/5g-all/5g-unlimited/LPZ1001268" },
            { "plan_name": "5G ë¼ì´íŠ¸+", "network_type": "5G", "price": 55000, "url": "https://www.lguplus.com/mobile/plan/mplan/5g-all/5g-unlimited/LPZ0000437" },
            { "plan_name": "5G ë³µì§€ 55 (ë³µì§€í• ì¸ ëŒ€ìƒì)", "network_type": "5G", "price": 55000, "url": "https://www.lguplus.com/mobile/plan/mplan/5g-all/5g-unlimited/" },
            { "plan_name": "5G ìŠ¬ë¦¼+", "network_type": "5G", "price": 47000, "url": "https://www.lguplus.com/mobile/plan/mplan/5g-all/5g-unlimited/LPZ0000487" },
            { "plan_name": "5G ë¼ì´íŠ¸ ì²­ì†Œë…„ (ë§Œ 18ì„¸ ì´í•˜)", "network_type": "5G", "price": 45000, "url": "https://www.lguplus.com/mobile/plan/mplan/5g-all/5g-unlimited/" },
            { "plan_name": "5G í‚¤ì¦ˆ 45 (ë§Œ 12ì„¸ ì´í•˜)", "network_type": "5G", "price": 45000, "url": "https://www.lguplus.com/mobile/plan/mplan/5g-all/5g-unlimited/" },
            { "plan_name": "5G í‚¤ì¦ˆ 39 (ë§Œ 12ì„¸ ì´í•˜)", "network_type": "5G", "price": 39000, "url": "https://www.lguplus.com/mobile/plan/mplan/5g-all/5g-unlimited/" },
            { "plan_name": "5G ë¯¸ë‹ˆ", "network_type": "5G", "price": 37000, "url": "https://www.lguplus.com/mobile/plan/mplan/5g-all/5g-unlimited/LPZ1000325" },
            { "plan_name": "LTE ë°ì´í„° 33", "network_type": "LTE", "price": 33000, "url": "https://www.lguplus.com/mobile/plan/mplan/lte-all/" }
        ];
        
        const lguData = {
            "company": "LG U+",
            "internet_plans": {
                "standalone": {
                    "100M": { "name": "ì¸í„°ë„·(ë‹¨ë…) 100M", "price": 22000, "speed_mbps": 100, "type": "100M" },
                    "500M": { "name": "ì¸í„°ë„·(ë‹¨ë…) 500M", "price": 33000, "speed_mbps": 500, "type": "500M" },
                    "1G": { "name": "ì¸í„°ë„·(ë‹¨ë…) 1GB", "price": 38500, "speed_mbps": 1000, "type": "1G" }
                },
                "with_tv_base": {
                    "100M": { "name": "ì¸í„°ë„· 100M (TV ê²°í•© ì‹œ)", "price": 22000, "speed_mbps": 100, "type": "100M" },
                    "500M": { "name": "ì¸í„°ë„· 500M (TV ê²°í•© ì‹œ)", "price": 27500, "speed_mbps": 500, "type": "500M" },
                    "1G": { "name": "ì¸í„°ë„· 1GB (TV ê²°í•© ì‹œ)", "price": 33000, "speed_mbps": 1000, "type": "1G" }
                }
            },
            "tv_plans": {
                "basic_uhd4": { "name": "TVë² ì´ì§ + UHD4", "channels_info": "211ì±„ë„", "price": 16500, "category": "ë² ì´ì§" },
                "premium_uhd4": { "name": "TVí”„ë¦¬ë¯¸ì—„ + UHD4", "channels_info": "254ì±„ë„", "price": 20900, "category": "í”„ë¦¬ë¯¸ì—„" },
                "premium_lite_uhd4": { "name": "TVí”„ë¦¬ë¯¸ì—„ ë¼ì´íŠ¸ + UHD4", "channels_info": "259ì±„ë„", "price": 23100, "category": "í”„ë¦¬ë¯¸ì—„ ë¼ì´íŠ¸" },
                "premium_disney_uhd4": { "name": "TVí”„ë¦¬ë¯¸ì—„ ë””ì¦ˆë‹ˆ + UHD4", "price": 29000, "notes": "STB assumed as UHD4 if not specified", "category": "í”„ë¦¬ë¯¸ì—„ ë””ì¦ˆë‹ˆ" },
                "premium_netflix_hd_uhd4": { "name": "TVí”„ë¦¬ë¯¸ì—„ ë„·í”Œë¦­ìŠ¤ HD + UHD4", "price": 32200, "notes": "STB assumed as UHD4 if not specified", "category": "í”„ë¦¬ë¯¸ì—„ ë„·í”Œë¦­ìŠ¤ HD" },
                "premium_netflix_uhd_uhd4": { "name": "TVí”„ë¦¬ë¯¸ì—„ ë„·í”Œë¦­ìŠ¤ UHD + UHD4", "price": 35700, "notes": "STB assumed as UHD4 if not specified", "category": "í”„ë¦¬ë¯¸ì—„ ë„·í”Œë¦­ìŠ¤ UHD" }
            },
            "phone_plans": {
                "voip_own_device": { "name": "ì¸í„°ë„· ì „í™”(070) - ë‹¨ë§ê¸° ë³´ìœ ", "price": 3300 },
                "voip_rental_device": { "name": "ì¸í„°ë„· ì „í™” (070) - ë‹¨ë§ê¸° ì„ëŒ€", "price": 5562 }
            },
            "additional_tv_options": {
                "basic_uhd4_add": { "name": "TV ì¶”ê°€ ë² ì´ì§ + UHD4", "channels_info": "211ì±„ë„", "price": 11550 },
                "basic_advanced_stb_for_100m_internet_add": { "name": "TV ì¶”ê°€ ë² ì´ì§(ê³ ê¸‰í˜•) / 100mb ì¸í„°ë„· ì‹œ", "price": 10450, "condition": "100mb ì¸í„°ë„· ì´ìš© ì‹œ" },
                "premium_uhd4_add": { "name": "TV ì¶”ê°€ í”„ë¦¬ë¯¸ì—„(UHD4)", "price": 13750 }
            },
            "bundle_discounts_on_internet": {
                "with_tv": {
                    "100M": { "cham_family": { "discount": 5500 }, "internet_family_all_together": { "discount": 5500 } },
                    "500M": { "cham_family": { "discount": 9900 }, "internet_family_all_together": { "discount": 5500 }, "together_bundle": { "discount": 11000 } },
                    "1G": { "cham_family": { "discount": 13200 }, "internet_family_all_together": { "discount": 5500 }, "together_bundle": { "discount": 11000 } }
                },
                "standalone_internet": {
                    "100M": { "cham_family": { "discount": 5500 }, "internet_family_all_together": { "discount": 5500 } },
                    "500M": { "cham_family": { "discount": 9900 }, "internet_family_all_together": { "discount": 5500 }, "together_bundle": { "discount": 11000 } },
                    "1G": { "cham_family": { "discount": 13200 }, "internet_family_all_together": { "discount": 5500 }, "together_bundle": { "discount": 11000 } }
                }
            },
            "mobile_discounts": {
                "cham_family": [
                    { "lines": [2], "tiers": { "under_47k": 2200, "under_69k": 3300, "over_69k": 5500 } },
                    { "lines": [3], "tiers": { "under_47k": 3300, "under_69k": 5500, "over_69k": 7700 } },
                    { "lines": [4, 5, 6, 7, 8, 9, 10], "tiers": { "under_47k": 4400, "under_69k": 7700, "over_69k": 11000 } }
                ],
                "together_bundle": [
                    { "lines": [2], "discount_per_line": 10000 },
                    { "lines": [3], "discount_per_line": 14000 },
                    { "lines": [4, 5], "discount_per_line": 20000 }
                ]
            },
            "installation_fees": {
                "internet_only": { "weekday": 36300, "weekend": 45375 },
                "internet_with_landline_phone": { "weekday": 36300, "weekend": 45375 },
                "internet_with_voip": { "weekday": 36300, "weekend": 45375 },
                "internet_with_tv": { "weekday": 56100, "weekend": 70125 },
                "internet_with_tv_and_phone": { "weekday": 56100, "weekend": 70125 },
                "internet_with_tv_and_additional_tv": { "weekday": 78100, "weekend": 97625 }
            }
        };
        const giftTableLGU = { "100Më‹¨ë…": { cash: 200000 }, "500Më‹¨ë…": { cash: 230000 }, "1Gë‹¨ë…": { cash: 230000 }, "100Më²ˆë“¤": { cash: 400000 }, "500Më²ˆë“¤": { cash: 470000 }, "1Gë²ˆë“¤": { cash: 470000 } };
        const mvnoBundleConfigFallback = { internetDiscount: { "100M": 5500, "500M": 9900, "1G": 13200 } };
        
        
        // --- DOM Element References ---
        const internetTypeRadios = document.querySelectorAll('input[name="internetType"]');
        const internetPlanEl = document.getElementById('internetPlan');
        const tvPlanEl = document.getElementById('tvPlan');
        const additionalTvPlanEl = document.getElementById('additionalTvPlan');
        const phonePlanEl = document.getElementById('phonePlan');
        const mobileLinesCountEl = document.getElementById('mobileLinesCount');
        const mobileLinesContainerEl = document.getElementById('mobileLinesContainer');
        const discountTypeRadios = document.querySelectorAll('input[name="discountType"]');
        const calculateButton = document.getElementById('calculateButton');
        const resetButton = document.getElementById('resetButton');
        
        // Discount Details Toggles
        const chamFamilyDetailsToggleEl = document.getElementById('chamFamilyDetailsToggle');
        const chamFamilyDetailsContainerEl = document.getElementById('chamFamilyDetailsContainer');
        const detailCfInternetDiscountEl = document.getElementById('detailCfInternetDiscount');
        const detailCfMobileDiscountEl = document.getElementById('detailCfMobileDiscount');
        const togetherDetailsToggleEl = document.getElementById('togetherDetailsToggle');
        const togetherDetailsContainerEl = document.getElementById('togetherDetailsContainer');
        const detailTgInternetDiscountEl = document.getElementById('detailTgInternetDiscount');
        const detailTgMobileDiscountEl = document.getElementById('detailTgMobileDiscount');
        const internetFamilyDetailsToggleEl = document.getElementById('internetFamilyDetailsToggle');
        const internetFamilyDetailsContainerEl = document.getElementById('internetFamilyDetailsContainer');
        const detailIfInternetDiscountEl = document.getElementById('detailIfInternetDiscount');
        const mvnoLGUDetailsToggleEl = document.getElementById('mvnoLGUDetailsToggle');
        const mvnoLGUDetailsContainerEl = document.getElementById('mvnoLGUDetailsContainer');
        const detailMvnoLGUInternetDiscountEl = document.getElementById('detailMvnoLGUInternetDiscount');
        
        // Result Section Elements
        const resultSection = document.getElementById('resultSection');
        
        // New Summary Card Elements
        const preDiscountWiredFeeEl = document.getElementById('preDiscountWiredFeeEl');
        const finalWiredFeeEl = document.getElementById('finalWiredFeeEl');
        const internetDiscountEl = document.getElementById('internetDiscountEl');
        const giftAmountEl = document.getElementById('giftAmountEl');
        const mobileDiscountEl = document.getElementById('mobileDiscountEl');
        const discountReasonEl = document.getElementById('discountReason');
        
        
        // Details Section Elements
        const detailsToggleButton = document.getElementById('detailsToggleButton');
        const detailsContainer = document.getElementById('detailsContainer');
        const selectedInternetEl = document.getElementById('selectedInternet');
        const selectedTvEl = document.getElementById('selectedTv');
        const selectedAdditionalTvEl = document.getElementById('selectedAdditionalTv');
        const selectedPhoneEl = document.getElementById('selectedPhone');
        const selectedMobileCountEl = document.getElementById('selectedMobileCount');
        const selectedDiscountTypeEl = document.getElementById('selectedDiscountType');
        const totalBaseInternetCostEl = document.getElementById('totalBaseInternetCost');
        const totalInternetDiscountAmountEl = document.getElementById('totalInternetDiscountAmount');
        const tvCostSummaryContainerEl = document.getElementById('tvCostSummaryContainer');
        const tvBaseCostDisplayEl = document.getElementById('tvBaseCostDisplay');
        const additionalTvCostSummaryContainerEl = document.getElementById('additionalTvCostSummaryContainer');
        const additionalTvCostDisplayEl = document.getElementById('additionalTvCostDisplay');
        const phoneCostSummaryContainerEl = document.getElementById('phoneCostSummaryContainer');
        const phoneBaseCostDisplayEl = document.getElementById('phoneBaseCostDisplay');
        const finalMonthlyCostEl = document.getElementById('finalMonthlyCost');
        const installationCostResultEl = document.getElementById('installationCostResult');
        const giftCashEl = document.getElementById('giftCash');
        const mobileDiscountDetailsContainerEl = document.getElementById('mobileDiscountDetailsContainer');
        const mobileDiscountResultListEl = document.getElementById('mobileDiscountResultList');

        // Consultation Buttons
        const sendSmsButton = document.getElementById('sendSmsButton');
        const sendKakaoButton = document.getElementById('sendKakaoButton');
        
        const allDetailSectionsLGU = [
            { radioValue: 'cham_family', toggleEl: chamFamilyDetailsToggleEl, containerEl: chamFamilyDetailsContainerEl, updateFn: updateChamFamilyDetails },
            { radioValue: 'together_bundle', toggleEl: togetherDetailsToggleEl, containerEl: togetherDetailsContainerEl, updateFn: updateTogetherDetails },
            { radioValue: 'internet_family_all_together', toggleEl: internetFamilyDetailsToggleEl, containerEl: internetFamilyDetailsContainerEl, updateFn: updateInternetFamilyDetails },
            { radioValue: 'mvno_bundle', toggleEl: mvnoLGUDetailsToggleEl, containerEl: mvnoLGUDetailsContainerEl, updateFn: updateMvnoLGUDetails }
        ];
        
        // --- Functions ---
        
        function resetCalculator() {
            window.scrollTo({ top: 0, behavior: 'smooth' });
            resultSection.classList.add('hidden');
            detailsContainer.classList.add('hidden');
            detailsToggleButton.textContent = 'ìƒì„¸ ìš”ê¸ˆ ë‚´ì—­ ì „ì²´ ë³´ê¸° â–¼';
        
            document.querySelector('input[name="internetType"][value="bundle"]').checked = true;
            document.querySelector('input[name="discountType"][value="none"]').checked = true;
            document.querySelectorAll('.toggle-switch input[type="checkbox"]').forEach(toggle => {
                toggle.checked = false;
            });
            allDetailSectionsLGU.forEach(section => {
                if(section.containerEl) section.containerEl.classList.add('hidden');
            });
            handleInternetTypeChange();
            updateMobileLineControls();
            updateAllDiscountDetails();
        }
        
        function updateInternetPlanDisability() {
            const selectedDiscount = document.querySelector('input[name="discountType"]:checked').value;
            const option100M = internetPlanEl.querySelector('option[value="100M"]');
            if (option100M) {
                option100M.disabled = selectedDiscount === 'together_bundle';
            }
        }
        
        function getMobileDiscount(discountType, numLines, planInputs) {
            let totalBundleDiscount = 0;
            let totalSelectiveDiscount = 0;
        
            const bundleRules = lguData.mobile_discounts[discountType];
            if (numLines >= 2 && bundleRules) {
                if (discountType === 'cham_family') {
                    const lineCountForRule = Math.min(numLines, 10);
                    const rule = bundleRules.find(r => r.lines.includes(lineCountForRule)) || bundleRules[bundleRules.length - 1];
                    if (rule) {
                        planInputs.forEach(input => {
                            if (input.price >= 69000) totalBundleDiscount += rule.tiers.over_69k;
                            else if (input.price >= 47000) totalBundleDiscount += rule.tiers.under_69k;
                            else totalBundleDiscount += rule.tiers.under_47k;
                        });
                    }
                } else if (discountType === 'together_bundle') {
                    const lineCountForRule = Math.min(numLines, 5);
                    const rule = bundleRules.find(r => r.lines.includes(lineCountForRule)) || bundleRules[bundleRules.length - 1];
                    if (rule) {
                        const eligibleLines = planInputs.filter(p => p.price >= 85000).length;
                        if (eligibleLines === numLines) {
                            totalBundleDiscount = numLines * rule.discount_per_line;
                        }
                    }
                }
            }
        
            planInputs.forEach(input => {
                if (input.selectiveDiscountChecked) {
                    totalSelectiveDiscount += Math.floor(input.price * 0.25);
                }
            });
        
            return { totalBundleDiscount, totalSelectiveDiscount, total: totalBundleDiscount + totalSelectiveDiscount };
        }
        
        function updateMobileLinesInputsLGU() {
            const count = parseInt(mobileLinesCountEl.value) || 0;
            const selectedDiscount = document.querySelector('input[name="discountType"]:checked').value;
            mobileLinesContainerEl.innerHTML = '';
            for (let i = 0; i < count; i++) {
                const div = document.createElement('div');
                div.className = 'mobile-line-item';
                const label = document.createElement('label');
                label.htmlFor = `mobilePlan${i}`;
                label.className = 'block text-sm font-medium text-slate-600 mb-1';
                label.textContent = `íšŒì„  ${i + 1} ìš”ê¸ˆì œ ì„ íƒ`;
                const select = document.createElement('select');
                select.id = `mobilePlan${i}`;
                select.className = 'select-field mobile-plan-selector';
                lguMobilePlans.forEach(plan => {
                    const option = document.createElement('option');
                    option.value = plan.price;
                    option.textContent = `${plan.plan_name} (${plan.price.toLocaleString()}ì›)`;
                    option.dataset.planName = plan.plan_name;
                    option.dataset.url = plan.url;
                    if (selectedDiscount === 'together_bundle' && plan.price < 85000) {
                        option.disabled = true;
                    }
                    select.appendChild(option);
                });
                if (selectedDiscount === 'cham_family') select.value = "33000";
                if (selectedDiscount === 'together_bundle') select.value = "85000";
                const checkboxLabel = document.createElement('label');
                checkboxLabel.className = 'flex items-center mt-2 text-sm text-slate-600';
                const checkbox = document.createElement('input');
                checkbox.type = 'checkbox';
                checkbox.id = `selectiveDiscount${i}`;
                checkbox.className = 'radio-input h-4 w-4 selective-discount-cb';
                checkboxLabel.appendChild(checkbox);
                checkboxLabel.append(' ì„ íƒì•½ì • 25% í• ì¸');
                div.appendChild(label);
                div.appendChild(select);
                div.appendChild(checkboxLabel);
                mobileLinesContainerEl.appendChild(div);
                select.addEventListener('change', updateAllDiscountDetails);
                checkbox.addEventListener('change', updateAllDiscountDetails);
            }
            updateAllDiscountDetails();
        }
        
        function updateAllDiscountDetails() {
            updateChamFamilyDetails();
            updateTogetherDetails();
            updateInternetFamilyDetails();
            updateMvnoLGUDetails();
        }
        
        function updateChamFamilyDetails() {
            const internetKey = internetPlanEl.value;
            const isBundle = document.querySelector('input[name="internetType"]:checked').value === 'bundle';
            const numMobileLines = parseInt(mobileLinesCountEl.value) || 0;
            let internetDiscount = 0;
            if (internetKey !== 'none' && numMobileLines > 0) {
                internetDiscount = getDiscountFromBundle(internetKey, "cham_family", isBundle, numMobileLines);
            }
            detailCfInternetDiscountEl.textContent = internetDiscount.toLocaleString();
            const planInputs = Array.from(document.querySelectorAll('.mobile-line-item')).map(item => ({
                price: parseInt(item.querySelector('.mobile-plan-selector').value),
                selectiveDiscountChecked: item.querySelector('.selective-discount-cb').checked
            }));
            const mobileDiscount = getMobileDiscount('cham_family', numMobileLines, planInputs);
            detailCfMobileDiscountEl.textContent = mobileDiscount.total.toLocaleString();
        }
        
        function updateTogetherDetails() {
            const internetKey = internetPlanEl.value;
            const isBundle = document.querySelector('input[name="internetType"]:checked').value === 'bundle';
            const numMobileLines = parseInt(mobileLinesCountEl.value) || 0;
            let internetDiscount = 0;
            if (internetKey !== 'none') {
                internetDiscount = getDiscountFromBundle(internetKey, "together_bundle", isBundle, numMobileLines);
            }
            detailTgInternetDiscountEl.textContent = internetDiscount.toLocaleString();
            const planInputs = Array.from(document.querySelectorAll('.mobile-line-item')).map(item => ({
                price: parseInt(item.querySelector('.mobile-plan-selector').value),
                selectiveDiscountChecked: item.querySelector('.selective-discount-cb').checked
            }));
            const mobileDiscount = getMobileDiscount('together_bundle', numMobileLines, planInputs);
            detailTgMobileDiscountEl.textContent = mobileDiscount.total.toLocaleString();
        }
        
        function updateInternetFamilyDetails() {
            const internetKey = internetPlanEl.value;
            let internetDiscount = 0;
            const isBundle = document.querySelector('input[name="internetType"]:checked').value === 'bundle';
            if (internetKey !== 'none') {
                 internetDiscount = getDiscountFromBundle(internetKey, "internet_family_all_together", isBundle, parseInt(mobileLinesCountEl.value) || 0);
            }
            detailIfInternetDiscountEl.textContent = internetDiscount.toLocaleString();
        }
        
        function updateMvnoLGUDetails() {
            const internetKey = internetPlanEl.value;
            let internetDiscount = 0;
            if (internetKey !== 'none' && (parseInt(mobileLinesCountEl.value) || 0) > 0) {
                const currentInternetDetails = getInternetPlanInfo(internetKey, document.querySelector('input[name="internetType"]:checked').value === 'bundle');
                const internetType = currentInternetDetails.type;
                if (internetType && mvnoBundleConfigFallback.internetDiscount[internetType]) {
                    internetDiscount = mvnoBundleConfigFallback.internetDiscount[internetType];
                }
            }
            detailMvnoLGUInternetDiscountEl.textContent = internetDiscount.toLocaleString();
        }
        
        function populateSelectWithOptionsGeneric(selectElement, dataObject, defaultKey = "none", nameKey = "name", priceKey = "price") {
            const currentValue = selectElement.value;
            selectElement.innerHTML = `<option value="none">ì„ íƒ ì•ˆí•¨</option>`;
            for (const key in dataObject) {
                const item = dataObject[key];
                const option = document.createElement('option');
                option.value = key;
                option.textContent = `${item[nameKey]} (ì›” ${item[priceKey].toLocaleString()}ì›)`;
                option.dataset.price = item[priceKey];
                if (item.speed_mbps) option.dataset.speed = item.speed_mbps;
                if (item.type) option.dataset.type = item.type;
                if (item.channels_info) option.dataset.channels = item.channels_info;
                if (item.category) option.dataset.category = item.category;
                selectElement.appendChild(option);
            }
            if (selectElement.querySelector(`option[value="${currentValue}"]`)) {
                selectElement.value = currentValue;
            } else if (defaultKey !== "none" && dataObject[defaultKey]) {
                selectElement.value = defaultKey;
            } else if (defaultKey === "none" && selectElement.options.length > 0) {
                selectElement.value = "none";
            }
        }
        
        function populateInternetPlans(isBundle) {
            internetPlanEl.innerHTML = `<option value="none">ì„ íƒ ì•ˆí•¨</option>`;
            const plansToShow = isBundle ? lguData.internet_plans.with_tv_base : lguData.internet_plans.standalone;
            const notesEl = document.getElementById('internetNotes');
            for (const key in plansToShow) {
                const item = plansToShow[key];
                const option = document.createElement('option');
                option.value = key;
                option.textContent = `${item.name} (ì›” ${item.price.toLocaleString()}ì›)`;
                option.dataset.price = item.price;
                option.dataset.speed = item.speed_mbps;
                option.dataset.type = item.type;
                internetPlanEl.appendChild(option);
            }
            internetPlanEl.value = "100M";
            if (notesEl) {
                notesEl.textContent = isBundle ? "ì°¸ê³ : WiFi ê³µìœ ê¸° í¬í•¨. TV ê²°í•© ì‹œ ê¸°ë³¸ í• ì¸ëœ ìš”ê¸ˆì…ë‹ˆë‹¤." : "ì°¸ê³ : WiFi ê³µìœ ê¸° í¬í•¨.";
            }
            updateInternetPlanDisability();
        }
        
        function handleInternetTypeChange() {
            const selectedType = document.querySelector('input[name="internetType"]:checked').value;
            const isBundle = selectedType === 'bundle';
            populateInternetPlans(isBundle);
            tvPlanEl.disabled = !isBundle;
            additionalTvPlanEl.disabled = !isBundle;
            if (!isBundle) {
                tvPlanEl.value = 'none';
                additionalTvPlanEl.value = 'none';
            } else {
                if (tvPlanEl.value === 'none' && lguData.tv_plans['basic_uhd4']) {
                     tvPlanEl.value = 'basic_uhd4';
                }
            }
            handleTvPlanChange();
        }
        
        function handleTvPlanChange() {
            const isFirstTvSelected = tvPlanEl.value !== 'none';
            const isBundleType = document.querySelector('input[name="internetType"]:checked').value === 'bundle';
            additionalTvPlanEl.disabled = !isFirstTvSelected || !isBundleType;
            if (!isFirstTvSelected || !isBundleType) {
                additionalTvPlanEl.value = 'none';
            }
        }
        
        function updateMobileLineControls() {
            const selectedDiscount = document.querySelector('input[name="discountType"]:checked').value;
            let mobileCount = 0;
            let isMobileDisabled = true;
            switch (selectedDiscount) {
                case 'none': mobileCount = 0; isMobileDisabled = true; break;
                case 'cham_family': mobileCount = 1; isMobileDisabled = false; break;
                case 'together_bundle': mobileCount = 1; isMobileDisabled = false; break;
                case 'internet_family_all_together': mobileCount = 0; isMobileDisabled = true; break;
                case 'mvno_bundle': mobileCount = 1; isMobileDisabled = false; break;
                default: mobileCount = 0; isMobileDisabled = true;
            }
            mobileLinesCountEl.value = mobileCount;
            mobileLinesCountEl.disabled = isMobileDisabled;
            updateMobileLinesInputsLGU();
        }

        function generateConsultationMessage() {
            const isBundleInternetType = document.querySelector('input[name="internetType"]:checked').value === 'bundle';
            const internetKey = internetPlanEl.value;
            const tvKey = isBundleInternetType ? tvPlanEl.value : 'none';
            
            const internetPlanInfo = getInternetPlanInfo(internetKey, isBundleInternetType);
            const tvPlanInfo = (tvKey !== 'none' && lguData.tv_plans[tvKey]) ? lguData.tv_plans[tvKey] : null;

            const finalCost = finalMonthlyCostEl.textContent;
            const giftAmount = giftAmountEl.textContent;

            let message = `[ë¯¸ì†Œ U+ ìƒë‹´ ìš”ì²­]\n\n`;
            message += `â–  ì„ íƒ ìƒí’ˆ\n`;
            message += ` - ì¸í„°ë„·: ${internetPlanInfo.name}\n`;
            if (tvPlanInfo) {
                message += ` - TV: ${tvPlanInfo.name}\n`;
            }
            message += `\n`;
            message += `â–  ì˜ˆìƒ ì›” ìš”ê¸ˆ: ${finalCost}ì›\n`;
            message += `â–  ì˜ˆìƒ ì‚¬ì€í’ˆ: ${giftAmount}ì›\n\n`;
            message += `ìœ„ ë‚´ìš©ìœ¼ë¡œ ìƒë‹´ì„ ì›í•©ë‹ˆë‹¤.`;
            return message;
        }
        
        function initializeCalculator() {
            populateSelectWithOptionsGeneric(tvPlanEl, lguData.tv_plans, "basic_uhd4");
            populateSelectWithOptionsGeneric(additionalTvPlanEl, lguData.additional_tv_options, "none", "name", "price");
            populateSelectWithOptionsGeneric(phonePlanEl, lguData.phone_plans, "none");
        
            internetTypeRadios.forEach(radio => radio.addEventListener('change', handleInternetTypeChange));
            tvPlanEl.addEventListener('change', handleTvPlanChange);
            internetPlanEl.addEventListener('change', updateAllDiscountDetails);
            mobileLinesCountEl.addEventListener('input', updateMobileLinesInputsLGU);
            calculateButton.addEventListener('click', calculateAndDisplayResultsLGU);
            resetButton.addEventListener('click', resetCalculator);
        
            discountTypeRadios.forEach(radio => {
                radio.addEventListener('change', function() {
                    if (this.value === 'together_bundle' && internetPlanEl.value === '100M') {
                        internetPlanEl.value = '500M';
                        internetPlanEl.dispatchEvent(new Event('change'));
                    }
                    updateInternetPlanDisability();
                    updateMobileLineControls();
                    allDetailSectionsLGU.forEach(section => {
                        if (section.radioValue !== this.value) {
                            section.containerEl.classList.add('hidden');
                            section.toggleEl.checked = false;
                        }
                    });
                    updateAllDiscountDetails();
                });
            });
        
            allDetailSectionsLGU.forEach(section => {
                section.toggleEl.addEventListener('change', function() {
                    const radio = document.querySelector(`input[name="discountType"][value="${section.radioValue}"]`);
                    if (radio.checked) {
                        section.containerEl.classList.toggle('hidden', !this.checked);
                        if (this.checked) updateAllDiscountDetails();
                    }
                });
            });
        
            detailsToggleButton.addEventListener('click', () => {
                const isHidden = detailsContainer.classList.toggle('hidden');
                detailsToggleButton.textContent = isHidden ? 'ìƒì„¸ ìš”ê¸ˆ ë‚´ì—­ ì „ì²´ ë³´ê¸° â–¼' : 'ìƒì„¸ ë‚´ì—­ ë‹«ê¸° â–²';
            });

            // ========== MODIFICATION START ==========
            sendSmsButton.addEventListener('click', () => {
                const message = generateConsultationMessage();
                // ë°›ëŠ” ì‚¬ëŒ ì „í™”ë²ˆí˜¸ë¥¼ '01042978846'ìœ¼ë¡œ ì„¤ì •í•©ë‹ˆë‹¤.
                const smsLink = `sms:01042978846?body=${encodeURIComponent(message)}`;
                window.location.href = smsLink;
            });
            // ========== MODIFICATION END ==========

            sendKakaoButton.addEventListener('click', () => {
                const message = generateConsultationMessage();
                if (navigator.clipboard) {
                    navigator.clipboard.writeText(message).then(() => {
                        alert('ìƒë‹´ ë‚´ìš©ì´ ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤. ì¹´ì¹´ì˜¤í†¡ì— ë¶™ì—¬ë„£ì–´ ë¬¸ì˜í•´ì£¼ì„¸ìš”.');
                    }).catch(err => {
                        alert('ë³µì‚¬ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤. ë‚´ìš©ì„ ì§ì ‘ ë³µì‚¬í•˜ì—¬ ë¬¸ì˜í•´ì£¼ì„¸ìš”.');
                    });
                } else {
                    const textArea = document.createElement("textarea");
                    textArea.value = message;
                    textArea.style.position = "fixed"; 
                    textArea.style.left = "-9999px";
                    document.body.appendChild(textArea);
                    textArea.focus();
                    textArea.select();
                    try {
                        document.execCommand('copy');
                        alert('ìƒë‹´ ë‚´ìš©ì´ ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤. ì¹´ì¹´ì˜¤í†¡ì— ë¶™ì—¬ë„£ì–´ ë¬¸ì˜í•´ì£¼ì„¸ìš”.');
                    } catch (err) {
                        alert('ë³µì‚¬ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤. ë‚´ìš©ì„ ì§ì ‘ ë³µì‚¬í•˜ì—¬ ë¬¸ì˜í•´ì£¼ì„¸ìš”.');
                    }
                    document.body.removeChild(textArea);
                }
            });
            
            resetCalculator();
        }
        
        function getInternetPlanInfo(internetKey, isBundleInternetType) {
            if (!internetKey || internetKey === "none") return { name: "ë¯¸ì„ íƒ", price: 0, speed_mbps: 0, type: "none" };
            const planDataSource = isBundleInternetType ? lguData.internet_plans.with_tv_base : lguData.internet_plans.standalone;
            const plan = planDataSource[internetKey] || lguData.internet_plans.standalone[internetKey];
            return plan ? { ...plan } : { name: "ì˜¤ë¥˜", price: 0, speed_mbps: 0, type: "none" };
        }
        
        function getDiscountFromBundle(internetTypeKey, discountTypeKeyFromJson, isBundleInternetType, numMobileLines) {
            if (discountTypeKeyFromJson === "none") return 0;
            const category = isBundleInternetType ? "with_tv" : "standalone_internet";
            const discountsForCategory = lguData.bundle_discounts_on_internet[category];
            if (discountsForCategory?.[internetTypeKey]?.[discountTypeKeyFromJson]) {
                if (discountTypeKeyFromJson === "together_bundle") {
                    const internetDetails = getInternetPlanInfo(internetTypeKey, isBundleInternetType);
                    const internetSpeedMbps = internetDetails.speed_mbps || 0;
                    const mobilePlanPrices = Array.from(document.querySelectorAll('.mobile-plan-selector')).map(s => parseInt(s.value));
                    const highTierMobileCount = mobilePlanPrices.filter(p => p >= 85000).length;
                    
                    if (internetSpeedMbps >= 500 && highTierMobileCount === numMobileLines && numMobileLines >= 1) {
                        return discountsForCategory[internetTypeKey][discountTypeKeyFromJson].discount;
                    }
                    return 0;
                } else if (discountTypeKeyFromJson === "cham_family") {
                    return numMobileLines > 0 ? discountsForCategory[internetTypeKey][discountTypeKeyFromJson].discount : 0;
                }
                return discountsForCategory[internetTypeKey][discountTypeKeyFromJson].discount;
            }
            return 0;
        }
        
        function calculateAndDisplayResultsLGU() {
            // --- 0. Validation ---
            const internetKey = internetPlanEl.value;
            if (internetKey === 'none') {
                alert('í•„ìˆ˜ í•­ëª©ì¸ ì¸í„°ë„· ìš”ê¸ˆì œë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”.');
                return;
            }

            // --- 1. Get User Inputs ---
            const selectedInternetTypeValue = document.querySelector('input[name="internetType"]:checked').value;
            const isBundleInternetType = selectedInternetTypeValue === 'bundle';
            const tvKey = isBundleInternetType ? tvPlanEl.value : 'none';
            const additionalTvKey = isBundleInternetType ? additionalTvPlanEl.value : 'none';
            const phoneKey = phonePlanEl.value;
            const numMobileLines = parseInt(mobileLinesCountEl.value) || 0;
            const selectedDiscountRadioValue = document.querySelector('input[name="discountType"]:checked').value;
            const installationTime = document.querySelector('input[name="installationTime"]:checked').value;
        
            // --- 2. Calculate Wired (Internet/TV/Phone) Costs and Discounts ---
            const currentInternetDetails = getInternetPlanInfo(internetKey, isBundleInternetType);
            const internetBasePrice = currentInternetDetails.price;
            let totalActualInternetDiscount = 0;
            if (internetKey !== 'none' && selectedDiscountRadioValue !== "none") {
                if (selectedDiscountRadioValue === "mvno_bundle") {
                    if (numMobileLines > 0 && currentInternetDetails.type && mvnoBundleConfigFallback.internetDiscount[currentInternetDetails.type]) {
                        totalActualInternetDiscount = mvnoBundleConfigFallback.internetDiscount[currentInternetDetails.type];
                    }
                } else {
                    totalActualInternetDiscount = getDiscountFromBundle(internetKey, selectedDiscountRadioValue, isBundleInternetType, numMobileLines);
                }
            }
            totalActualInternetDiscount = Math.min(totalActualInternetDiscount, internetBasePrice);
            
            const tvBase = (isBundleInternetType && tvKey !== 'none' && lguData.tv_plans[tvKey]) ? lguData.tv_plans[tvKey].price : 0;
            const finalAdditionalTvCost = (isBundleInternetType && additionalTvKey !== 'none' && lguData.additional_tv_options[additionalTvKey]) ? lguData.additional_tv_options[additionalTvKey].price : 0;
            const phoneBase = (phoneKey !== 'none' && lguData.phone_plans[phoneKey]) ? lguData.phone_plans[phoneKey].price : 0;
            
            const preDiscountWiredCost = internetBasePrice + tvBase + finalAdditionalTvCost + phoneBase;
            const finalWiredMonthlyCost = preDiscountWiredCost - totalActualInternetDiscount;
        
        
            // --- 3. Calculate Mobile Costs and Discounts ---
            let totalMobileFinalCost = 0;
            let totalMobileDiscount = 0;
            mobileDiscountResultListEl.innerHTML = '';
            if (numMobileLines > 0) {
                mobileDiscountDetailsContainerEl.classList.remove('hidden');
                const planInputs = Array.from(document.querySelectorAll('.mobile-line-item')).map(item => ({
                    selector: item.querySelector('.mobile-plan-selector'),
                    price: parseInt(item.querySelector('.mobile-plan-selector').value),
                    selectiveDiscountChecked: item.querySelector('.selective-discount-cb').checked
                }));
                
                const mobileDiscounts = getMobileDiscount(selectedDiscountRadioValue, numMobileLines, planInputs);
                const totalBundleMobileDiscount = mobileDiscounts.totalBundleDiscount;
                
                planInputs.forEach((input, i) => {
                    const selectedOption = input.selector.options[input.selector.selectedIndex];
                    const planName = selectedOption.dataset.planName;
                    const planPrice = input.price;
                    const planUrl = selectedOption.dataset.url;
                    
                    let lineBundleDiscount = 0;
                    if (numMobileLines >= 2) {
                        if (selectedDiscountRadioValue === 'cham_family') {
                            lineBundleDiscount = getMobileDiscount('cham_family', numMobileLines, [{price: planPrice}]).totalBundleDiscount;
                        } else if (selectedDiscountRadioValue === 'together_bundle' && totalBundleMobileDiscount > 0) {
                            lineBundleDiscount = totalBundleMobileDiscount / numMobileLines;
                        }
                    }
                    
                    const selectiveDiscount = input.selectiveDiscountChecked ? Math.floor(planPrice * 0.25) : 0;
                    const lineTotalDiscount = lineBundleDiscount + selectiveDiscount;
                    const lineFinalPrice = planPrice - lineTotalDiscount;
        
                    totalMobileFinalCost += lineFinalPrice;
                    totalMobileDiscount += lineTotalDiscount;
                    
                    let discountText = [];
                    if(lineBundleDiscount > 0) discountText.push(`ê²°í•©: ${lineBundleDiscount.toLocaleString()}ì›`);
                    if(selectiveDiscount > 0) discountText.push(`ì„ ì•½: ${selectiveDiscount.toLocaleString()}ì›`);
        
                    const resultHTML = `
                        <div class="grid grid-cols-3 gap-2 items-center py-1 border-b">
                            <div class="col-span-1">
                                <a href="${planUrl}" target="_blank" class="text-blue-600 hover:underline font-semibold">${planName}</a>
                                <span class="text-slate-500 text-xs">(${planPrice.toLocaleString()}ì›)</span>
                            </div>
                            <div class="col-span-1 text-red-500">
                                -${lineTotalDiscount.toLocaleString()}ì› <span class="text-xs text-slate-500">(${discountText.join(' + ') || 'í• ì¸ ì—†ìŒ'})</span>
                            </div>
                            <div class="col-span-1 text-right font-bold text-lg">
                                = ${lineFinalPrice.toLocaleString()}ì›
                            </div>
                        </div>`;
                    mobileDiscountResultListEl.innerHTML += resultHTML;
                });
            } else {
                mobileDiscountDetailsContainerEl.classList.add('hidden');
            }
        
            // --- 4. Calculate Other Benefits ---
            let giftCashAmount = 0;
            if (internetKey !== 'none') {
                const giftKeyForCalc = currentInternetDetails.type + (isBundleInternetType ? "ë²ˆë“¤" : "ë‹¨ë…");
                if (giftTableLGU[giftKeyForCalc]) {
                    giftCashAmount = giftTableLGU[giftKeyForCalc].cash;
                }
            }
            let calculatedInstallationFee = 0;
            const installKeyToLookup = determineInstallationKey(internetKey !== 'none', tvBase > 0, phoneBase > 0, finalAdditionalTvCost > 0);
            if(installKeyToLookup && lguData.installation_fees[installKeyToLookup]){
                calculatedInstallationFee = lguData.installation_fees[installKeyToLookup][installationTime] || 0;
            }
        
            // --- 5. Display Results ---
            // Update New Summary Card
            preDiscountWiredFeeEl.textContent = preDiscountWiredCost.toLocaleString();
            finalWiredFeeEl.textContent = finalWiredMonthlyCost.toLocaleString();
            internetDiscountEl.textContent = totalActualInternetDiscount.toLocaleString();
            giftAmountEl.textContent = giftCashAmount.toLocaleString();
            mobileDiscountEl.textContent = totalMobileDiscount.toLocaleString();
            
            // Display Reason for No Discount
            let reasonText = '';
            if (selectedDiscountRadioValue === 'together_bundle' && (totalActualInternetDiscount === 0 || totalMobileDiscount === 0)) {
                if (numMobileLines < 2) {
                    reasonText = "ğŸ’¡ 'íˆ¬ê²Œë” ê²°í•©'ì€ íœ´ëŒ€í° 2íšŒì„  ì´ìƒë¶€í„° í• ì¸ì´ ì ìš©ë©ë‹ˆë‹¤.";
                } else if (getInternetPlanInfo(internetKey, isBundleInternetType).speed_mbps < 500) {
                    reasonText = "ğŸ’¡ 'íˆ¬ê²Œë” ê²°í•©'ì€ 500M ì´ìƒ ì¸í„°ë„· ìš”ê¸ˆì œì—ì„œë§Œ ì ìš©ë©ë‹ˆë‹¤.";
                } else if (Array.from(document.querySelectorAll('.mobile-plan-selector')).some(s => parseInt(s.value) < 85000)) {
                    reasonText = "ğŸ’¡ 'íˆ¬ê²Œë” ê²°í•©'ì€ ëª¨ë“  íœ´ëŒ€í°ì´ ì›” 85,000ì› ì´ìƒ ìš”ê¸ˆì œì¼ ë•Œ ì ìš©ë©ë‹ˆë‹¤.";
                }
            } else if (selectedDiscountRadioValue === 'cham_family' && numMobileLines < 2 && totalMobileDiscount === 0) {
                 if (numMobileLines === 1) reasonText = "ğŸ’¡ 'ì°¸ì‰¬ìš´ ê°€ì¡±ê²°í•©'ì˜ íœ´ëŒ€í° ìš”ê¸ˆ í• ì¸ì€ 2íšŒì„ ë¶€í„° ì ìš©ë©ë‹ˆë‹¤. (ì¸í„°ë„· í• ì¸ì€ 1íšŒì„ ë¶€í„° ì •ìƒ ì ìš©ë©ë‹ˆë‹¤)";
            }
            
            if (reasonText) {
                discountReasonEl.textContent = reasonText;
                discountReasonEl.classList.remove('hidden');
            } else {
                discountReasonEl.classList.add('hidden');
            }
            
        
            // Update Detailed Section
            totalBaseInternetCostEl.textContent = internetBasePrice.toLocaleString();
            totalInternetDiscountAmountEl.textContent = totalActualInternetDiscount.toLocaleString();
            tvCostSummaryContainerEl.classList.toggle('hidden', tvBase === 0);
            tvBaseCostDisplayEl.textContent = tvBase.toLocaleString();
            additionalTvCostSummaryContainerEl.classList.toggle('hidden', finalAdditionalTvCost === 0);
            additionalTvCostDisplayEl.textContent = finalAdditionalTvCost.toLocaleString();
            phoneCostSummaryContainerEl.classList.toggle('hidden', phoneBase === 0);
            phoneBaseCostDisplayEl.textContent = phoneBase.toLocaleString();
            finalMonthlyCostEl.textContent = finalWiredMonthlyCost.toLocaleString();
        
            selectedInternetEl.textContent = currentInternetDetails.name;
            selectedTvEl.textContent = (tvBase > 0) ? lguData.tv_plans[tvKey].name : 'ë¯¸ì„ íƒ';
            selectedAdditionalTvEl.textContent = (finalAdditionalTvCost > 0) ? lguData.additional_tv_options[additionalTvKey].name : 'ë¯¸ì„ íƒ';
            selectedPhoneEl.textContent = (phoneBase > 0) ? lguData.phone_plans[phoneKey].name : 'ë¯¸ì„ íƒ';
            selectedMobileCountEl.textContent = numMobileLines;
            const discountTypeDisplayMap = { none: "ê²°í•©í• ì¸ ì—†ìŒ", cham_family: "ì°¸ì‰¬ìš´ ê°€ì¡±ê²°í•©", together_bundle: "íˆ¬ê²Œë” ê²°í•©", internet_family_all_together: "ì¸í„°ë„· ê°€ì¡±ë¼ë¦¬ ë‹¤ëª¨ì—¬ ê²°í•©", mvno_bundle: "ì•Œëœ°í° ê²°í•©" };
            selectedDiscountTypeEl.textContent = discountTypeDisplayMap[selectedDiscountRadioValue] || selectedDiscountRadioValue;
            
            installationCostResultEl.textContent = Math.round(calculatedInstallationFee).toLocaleString();
            giftCashEl.textContent = giftCashAmount.toLocaleString();
            
            // Show result section
            resultSection.classList.remove('hidden');
            resultSection.scrollIntoView({ behavior: 'smooth', block: 'start' });
        }
        
        function determineInstallationKey(hasInternet, hasFirstTv, hasPhone, hasAdditionalTv) {
            if (hasInternet) {
                if (hasFirstTv && hasAdditionalTv) return "internet_with_tv_and_additional_tv";
                if (hasFirstTv && hasPhone) return "internet_with_tv_and_phone";
                if (hasFirstTv) return "internet_with_tv";
                if (hasPhone) return "internet_with_voip";
                return "internet_only";
            }
            return null;
        }
        
        document.addEventListener('DOMContentLoaded', initializeCalculator);
    </script>
</body>
</html>