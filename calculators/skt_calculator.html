<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SKT ì¸í„°ë„· ëª¨ë°”ì¼ ê²°í•©í• ì¸ ê³„ì‚°ê¸°</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@400;500;700;900&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Noto Sans KR', sans-serif; background-color: #f8fafc; }
        .input-group { margin-bottom: 1.5rem; }
        .input-label { display: block; margin-bottom: 0.5rem; font-weight: 500; color: #334155; }
        .input-field, .select-field { width: 100%; padding: 0.75rem; border: 1px solid #cbd5e1; border-radius: 0.375rem; box-shadow: sm; transition: border-color 0.15s ease-in-out, box-shadow 0.15s ease-in-out; background-color: white; -webkit-appearance: none; -moz-appearance: none; appearance: none; background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 20 20'%3e%3cpath stroke='%236b7280' stroke-linecap='round' stroke-linejoin='round' stroke-width='1.5' d='M6 8l4 4 4-4'/%3e%3c/svg%3e"); background-position: right 0.5rem center; background-repeat: no-repeat; background-size: 1.5em 1.5em; padding-right: 2.5rem; }
        .input-field:focus, .select-field:focus { border-color: #ef4444; outline: none; box-shadow: 0 0 0 3px rgba(239, 68, 68, 0.2); }
        .select-field:disabled, .input-field:disabled { background-color: #e9e9e9; cursor: not-allowed; opacity: 0.7; }
        .btn-primary { background-color: #ef4444; color: white; padding: 0.875rem 1.5rem; border-radius: 0.5rem; font-weight: 700; transition: background-color 0.3s ease; width: 100%; }
        .btn-primary:hover { background-color: #dc2626; }
        .section-title { font-size: 1.5rem; font-weight: 700; color: #1e293b; margin-bottom: 1.5rem; padding-bottom: 0.5rem; border-bottom: 2px solid #ef4444; }
        .result-card { background-color: white; padding: 1.5rem; border-radius: 0.5rem; box-shadow: 0 4px 6px -1px rgba(0,0,0,0.05), 0 2px 4px -1px rgba(0,0,0,0.05); margin-bottom: 1.5rem; }
        .radio-label { margin-right: 1rem; margin-bottom: 0.5rem; display: inline-flex; align-items: center; cursor: pointer; padding: 0.75rem; border: 1px solid #d1d5db; border-radius: 0.5rem; width: 100%; transition: all 0.2s ease-in-out; }
        .radio-label:has(input:checked) { background-color: #fee2e2; border-color: #ef4444; font-weight: 600; color:#b91c1c }
        .radio-input { margin-right: 0.75rem; accent-color: #ef4444; width: 1.25em; height: 1.25em; }
        .toggle-switch { position: relative; display: inline-block; width: 40px; height: 20px; margin-left: 10px; vertical-align: middle;}
        .toggle-switch input { opacity: 0; width: 0; height: 0; }
        .slider { position: absolute; cursor: pointer; top: 0; left: 0; right: 0; bottom: 0; background-color: #ccc; transition: .4s; border-radius: 20px;}
        .slider:before { position: absolute; content: ""; height: 16px; width: 16px; left: 2px; bottom: 2px; background-color: white; transition: .4s; border-radius: 50%;}
        input:checked + .slider { background-color: #ef4444; }
        input:checked + .slider:before { transform: translateX(20px); }
        .discount-details { background-color: #fffbeb; border: 1px solid #fde68a; padding: 1rem; border-radius: 0.375rem; font-size:0.875rem; margin-top: 0.75rem; }
        .discount-details ul, .discount-details ol { list-style: disc; padding-left: 1.25rem; }
        .discount-details h4 { font-weight: bold; margin-top: 0.75rem; margin-bottom: 0.25rem; }
        .dongpan-details { background-color: #f0fdf4; border: 1px solid #bbf7d0; padding: 1rem; border-radius: 0.375rem; font-size:0.875rem; margin-top: 0.75rem; }
        .share-btn { display: flex; align-items: center; justify-content: center; text-align: center; padding: 0.75rem; border-radius: 0.5rem; font-weight: 700; text-decoration: none; transition: opacity 0.3s; }
        .kakao-btn { background-color: #FEE500; color: #191919;}
        .sms-btn { background-color: #3b4757; color: white;}
    </style>
</head>
<body class="text-slate-800">
    <header class="bg-white text-slate-800 p-6 shadow-md">
        <div class="container mx-auto max-w-4xl">
            <h1 class="text-3xl font-black text-center">SKT ê²°í•© í• ì¸ ê³„ì‚°ê¸°</h1>
        </div>
    </header>

    <main class="container mx-auto max-w-4xl p-4 sm:p-6 lg:p-8">
        <section id="inputSection" class="mb-8">
            <h2 class="section-title">1. ì„œë¹„ìŠ¤ ì„ íƒ</h2>
            
            <div class="input-group">
                <label class="input-label">ê°€ì… ìœ í˜•</label>
                <div class="grid sm:grid-cols-2 gap-2">
                    <label class="radio-label">
                        <input type="radio" name="internetType" value="bundle" class="radio-input" checked> ì¸í„°ë„· + TV
                    </label>
                    <label class="radio-label">
                        <input type="radio" name="internetType" value="standalone" class="radio-input"> ì¸í„°ë„· ë‹¨ë…
                    </label>
                </div>
            </div>

            <p class="mb-6 text-sm text-slate-600">3ë…„ ì•½ì •, VAT í¬í•¨ ê¸°ì¤€ì…ë‹ˆë‹¤.</p>

            <div class="grid md:grid-cols-2 gap-x-6 gap-y-4">
                <div class="input-group">
                    <label for="internetPlan" class="input-label">ì¸í„°ë„· ìš”ê¸ˆì œ</label>
                    <select id="internetPlan" class="select-field"></select>
                </div>
                
                <div class="input-group">
                    <label for="wifiRouter" class="input-label">ì™€ì´íŒŒì´ ê³µìœ ê¸° (ì„ íƒ)</label>
                    <select id="wifiRouter" class="select-field"></select>
                </div>

                <div class="input-group">
                    <label for="tvPlan" class="input-label">B tv ìš”ê¸ˆì œ (ì²«ë²ˆì§¸ TV)</label>
                    <select id="tvPlan" class="select-field"></select>
                </div>

                <div class="input-group">
                    <label for="tvStb" class="input-label">AI/íŠ¹ìˆ˜ ì…‹í†±ë°•ìŠ¤ (ì„ íƒ)</label>
                    <select id="tvStb" class="select-field">
                        <option value="none" data-price="0">ì„ íƒ ì•ˆí•¨ (ê¸°ë³¸ì…‹í†± ì‚¬ìš©)</option>
                    </select>
                     <p class="text-xs text-slate-500 mt-1">NUGU, Apple TV ë“± ìµœì‹  ì…‹í†±ìœ¼ë¡œ ë³€ê²½ ì‹œ ì„ íƒí•©ë‹ˆë‹¤.</p>
                </div>

                <div class="input-group">
                    <label for="additionalTvPlan" class="input-label">ì¶”ê°€ TV (ë‘ë²ˆì§¸ TV, ì„ íƒ)</label>
                    <select id="additionalTvPlan" class="select-field"></select>
                </div>
                
                <div class="input-group">
                    <label for="phonePlan" class="input-label">ì§‘ì „í™” (ì„ íƒ)</label>
                    <select id="phonePlan" class="select-field"></select>
                </div>
            </div>
        </section>

        <section id="discountTypeSection" class="mb-8">
            <h2 class="section-title">2. ê²°í•© í• ì¸ ìœ í˜• ì„ íƒ</h2>
            <div class="bg-white p-6 rounded-lg shadow space-y-6">
                 <div>
                    <label class="input-label">í• ì¸ ìœ í˜•</label>
                     <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-x-4 gap-y-2">
                         <label class="radio-label"><input type="radio" name="discountType" value="noBundleDiscount" class="radio-input" checked> ê²°í•© ì—†ìŒ</label>
                         <label class="radio-label"><input type="radio" name="discountType" value="ìš”ì¦˜ê°€ì¡±ê²°í•©" class="radio-input"> ìš”ì¦˜ê°€ì¡±ê²°í•©</label>
                         <label class="radio-label"><input type="radio" name="discountType" value="ì˜¨ê°€ì¡±í• ì¸" class="radio-input"> ì˜¨ê°€ì¡±í• ì¸</label>
                         <label class="radio-label"><input type="radio" name="discountType" value="íŒ¨ë°€ë¦¬ê²°í•©" class="radio-input"> íŒ¨ë°€ë¦¬ê²°í•©</label>
                         <label class="radio-label"><input type="radio" name="discountType" value="ì•Œëœ°í•œ ê²°í•©" class="radio-input"> ì•Œëœ°í•œ ê²°í•©</label>
                     </div>
                 </div>
                
                 <div id="onGajokYearsGroup" class="input-group hidden">
                    <label for="onGajokYears" class="input-label">SKT ì´ ì‚¬ìš© ì—°ìˆ˜ (ì˜¨ê°€ì¡± í• ì¸)</label>
                    <select id="onGajokYears" class="select-field">
                        <option value="0_9">10ë…„ ë¯¸ë§Œ</option>
                        <option value="10_19">10ë…„ ì´ìƒ ~ 20ë…„ ë¯¸ë§Œ</option>
                        <option value="20_29">20ë…„ ì´ìƒ ~ 30ë…„ ë¯¸ë§Œ</option>
                        <option value="30_plus">30ë…„ ì´ìƒ</option>
                    </select>
                 </div>

                 <div>
                    <label for="mobileLinesCount" class="input-label">ê²°í•©í•  SKT íœ´ëŒ€í° íšŒì„  ìˆ˜</label>
                    <input type="number" id="mobileLinesCount" min="0" max="5" value="0" class="input-field w-24 text-center">
                    <div id="mobileLinesContainer" class="space-y-3 mt-4"></div>
                 </div>

                 <div>
                     <label for="dongpanSalesCheck" class="flex items-center cursor-pointer">
                         <input type="checkbox" id="dongpanSalesCheck" class="h-5 w-5 mr-2 rounded text-red-500 focus:ring-red-400">
                         <span>ë™íŒ íŒë§¤ê°€ ì ìš© (ì¶”ê°€ ì‚¬ì€í’ˆ)</span>
                     </label>
                     <div id="dongpanUsimPolicyDetailsContainer" class="mt-3 hidden dongpan-details">
                         <h3 class="font-bold text-green-800 mb-2">ë™íŒ íŒë§¤ê°€ë€? (SKT ìœ ì‹¬ ë™ì‹œ ê°œí†µ)</h3>
                         <p>ì¸í„°ë„· ì„¤ì¹˜ ì‹œ SKT íœ´ëŒ€í° íšŒì„ (ìœ ì‹¬)ì„ í•¨ê»˜ ê°œí†µí•˜ëŠ” ì¡°ê±´ìœ¼ë¡œ, ì¶”ê°€ í˜„ê¸ˆ ì‚¬ì€í’ˆì´ ì§€ê¸‰ë˜ëŠ” íŠ¹ë³„ íŒë§¤ ì •ì±…ì…ë‹ˆë‹¤. ê°œí†µí•˜ëŠ” íœ´ëŒ€í° ìš”ê¸ˆì œì— ë”°ë¼ ì‚¬ì€í’ˆ ì•¡ìˆ˜ê°€ ë‹¬ë¼ì§‘ë‹ˆë‹¤.</p>
                     </div>
                 </div>

                 <div>
                    <label class="input-label">ê²°í•© ì ìš© ì‹œì  (ìš”ê¸ˆ í‘œì‹œ ë°©ì‹)</label>
                    <div class="grid sm:grid-cols-2 gap-2">
                         <label class="radio-label">
                             <input type="radio" name="bundleApplicationTime" value="pre" class="radio-input" checked> ì„ ê²°í•© (í• ì¸ ì¦‰ì‹œ ë°˜ì˜)
                         </label>
                         <label class="radio-label">
                             <input type="radio" name="bundleApplicationTime" value="post" class="radio-input"> í›„ê²°í•© (í• ì¸ì€ ë³„ë„ ì ìš©)
                         </label>
                    </div>
                    <p class="text-xs text-slate-500 mt-2">í›„ê²°í•© ì„ íƒ ì‹œ, ì›” ë‚©ë¶€ì•¡ì€ í• ì¸ ì „ ê¸ˆì•¡ìœ¼ë¡œ í‘œì‹œë˜ë©°, ì‹¤ì œ í• ì¸ì€ í†µì‹ ì‚¬ì—ì„œ ë³„ë„ë¡œ ì ìš©í•©ë‹ˆë‹¤.</p>
                 </div>

                 <div>
                     <label for="discountDetailsToggle" class="flex items-center justify-between cursor-pointer">
                         <span class="input-label !mb-0">í• ì¸ ìœ í˜•ë³„ ìƒì„¸ ì¡°ê±´ ë³´ê¸°</span>
                         <div class="toggle-switch">
                             <input type="checkbox" id="discountDetailsToggle">
                             <span class="slider"></span>
                         </div>
                     </label>
                     <div id="discountDetailsContainer" class="hidden space-y-4"></div>
                 </div>
            </div>
        </section>

        <div class="text-center mb-8">
            <button id="calculateButton" class="btn-primary text-lg shadow-lg hover:shadow-xl transition-shadow">ì˜ˆìƒ ìš”ê¸ˆ ê³„ì‚°í•˜ê¸°</button>
        </div>

        <section id="resultSection" class="hidden">
            <h2 class="section-title">ğŸ“Š ê³„ì‚° ê²°ê³¼</h2>
            
            <div class="bg-slate-50 p-6 rounded-lg mb-6 border border-slate-200">
                <h3 class="text-xl font-bold text-slate-800 mb-4 text-center">âœ… ìµœì¢… ìš”ê¸ˆ ë° í˜œíƒ ìš”ì•½</h3>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div class="text-center p-4 bg-white rounded-md shadow-sm">
                        <p class="text-base font-medium text-slate-600">ğŸ–¥ï¸ ì›” ìµœì¢… ë‚©ë¶€ì•¡</p>
                        <p id="summaryMonthlyCost" class="text-3xl font-extrabold text-red-500 my-1">0ì›</p>
                    </div>
                    <div class="text-center p-4 bg-green-50 rounded-md shadow-sm">
                        <p class="text-base font-medium text-green-800">ğŸ ì´ ì‚¬ì€í’ˆ í˜œíƒ</p>
                        <p id="summaryTotalGift" class="text-3xl font-extrabold text-green-600 my-1">0ì›</p>
                    </div>
                </div>
                <hr class="my-4">
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div class="text-center">
                        <p id="internetDiscountLabel" class="text-sm text-slate-500">ì¸í„°ë„·/TV ìš”ê¸ˆ í• ì¸</p>
                        <p id="summaryInternetDiscount" class="text-lg font-bold text-green-600">- 0ì›</p>
                    </div>
                    <div class="text-center">
                        <p class="text-sm text-slate-500">íœ´ëŒ€í° ìš”ê¸ˆ í• ì¸ (ì›”)</p>
                        <p id="summaryMobileDiscount" class="text-lg font-bold text-green-600">- 0ì›</p>
                        <p class="text-xs text-slate-400">(í†µì‹ ë¹„ ì²­êµ¬ì„œì—ì„œ ë³„ë„ ì°¨ê°)</p>
                    </div>
                </div>
            </div>
            
            <div id="selfRegistrationNotice" class="bg-blue-50 border-l-4 border-blue-500 text-blue-800 p-4 rounded-md mb-6 hidden" role="alert">
                <h4 class="font-bold">âœ¨ ì¤‘ìš” ì•ˆë‚´</h4>
                <p class="text-sm mt-1">
                    ê³„ì‚°ëœ ëª¨ë“  ê²°í•© í• ì¸ì€ ì¸í„°ë„· ì„¤ì¹˜ê°€ ì™„ë£Œëœ í›„, ê³ ê°ë‹˜ê»˜ì„œ ì§ì ‘ <strong>SKë¸Œë¡œë“œë°´ë“œ ê³ ê°ì„¼í„°(â˜ 106)</strong>ë¥¼ í†µí•´ ì‹ ì²­í•˜ì…”ì•¼ ìµœì¢…ì ìœ¼ë¡œ ì ìš©ë©ë‹ˆë‹¤.
                </p>
            </div>

            <div class="text-center mb-6">
                <button id="toggleDetailsButton" class="text-sm text-slate-500 hover:text-slate-700 bg-slate-100 hover:bg-slate-200 py-2 px-4 rounded-full transition-colors">
                    ìƒì„¸ ìš”ê¸ˆ ë‚´ì—­ í¼ì³ë³´ê¸° â–¼
                </button>
            </div>

            <div id="detailsContainer" class="hidden">
                <div class="result-card">
                    <h3 class="text-xl font-semibold text-orange-600 mb-3">ì„ íƒ ìƒí’ˆ ìƒì„¸</h3>
                    <div class="grid md:grid-cols-2 gap-4 text-sm">
                        <div>
                            <p class="summary-item"><span class="font-medium text-slate-500">ì¸í„°ë„·:</span> <span id="selectedInternet" class="result-value"></span></p>
                            <p class="summary-item"><span class="font-medium text-slate-500">TV (1):</span> <span id="selectedTv" class="result-value"></span></p>
                            <p class="summary-item"><span class="font-medium text-slate-500">ì…‹í†± (1):</span> <span id="selectedStb" class="result-value"></span></p>
                            <p class="summary-item"><span class="font-medium text-slate-500">TV (2):</span> <span id="selectedAdditionalTv" class="result-value"></span></p>
                        </div>
                        <div>
                             <p class="summary-item"><span class="font-medium text-slate-500">ì§‘ì „í™”:</span> <span id="selectedPhone" class="result-value"></span></p>
                             <p class="summary-item"><span class="font-medium text-slate-500">ì™€ì´íŒŒì´:</span> <span id="selectedWifi" class="result-value"></span></p>
                             <p class="summary-item"><span class="font-medium text-slate-500">í• ì¸ ìœ í˜•:</span> <span id="selectedDiscountType" class="result-value"></span></p>
                            <div id="onGajokYearsResultContainer" class="hidden summary-item">
                                <span class="font-medium text-slate-500">SKT ì‚¬ìš©ì—°ìˆ˜:</span> <span id="selectedOnGajokYears" class="result-value"></span>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="result-card">
                    <h3 class="text-xl font-semibold text-orange-600 mb-3">ìš”ê¸ˆ ê³„ì‚° ê³¼ì •</h3>
                    <div id="calculationDetails" class="space-y-1 text-sm"></div>
                    <hr class="my-3 border-slate-200">
                    <p class="mt-2 text-lg font-semibold">
                        ìµœì¢… ì˜ˆìƒ ì›” ë‚©ë¶€ì•¡: 
                        <span id="finalMonthlyCost" class="text-red-600 font-bold text-2xl">0</span> ì›
                        <span id="finalCostLabelQualifier" class="text-sm font-normal text-slate-600"></span>
                    </p>
                </div>
                
                 <div class="result-card">
                    <h3 class="text-xl font-semibold text-orange-600 mb-3">ğŸ ì‚¬ì€í’ˆ í˜œíƒ ìƒì„¸</h3>
                    <div class="text-sm space-y-1">
                        <p>ê¸°ë³¸ ì‚¬ì€í’ˆ (ì¸í„°ë„·/TV): <span id="giftBaseInternet" class="result-value">0</span> ì›</p>
                        <p id="additionalDongpanCashContainer" class="hidden">ë™íŒ ì¶”ê°€ ì‚¬ì€í’ˆ (íœ´ëŒ€í° ì—°ë™): <span id="giftAdditionalDongpanCash" class="result-value">0</span> ì›</p>
                    </div>
                    <hr class="my-3">
                    <p class="font-semibold">ì´ ì‚¬ì€í’ˆ ê°€ì¹˜ (ì˜ˆìƒ): <span id="giftTotal" class="result-value text-green-600 text-xl">0</span> ì›</p>
                    <p class="text-xs text-red-500 mt-1" id="giftEligibilityNote"></p>
                 </div>

                <div id="mobileDiscountDetailsContainer" class="result-card hidden">
                    <h3 class="text-xl font-semibold text-orange-600 mb-3">ğŸ“± íœ´ëŒ€í° ìš”ê¸ˆ í• ì¸ ìƒì„¸</h3>
                    <div id="mobileDiscountBreakdown" class="space-y-2 text-sm"></div>
                    <p id="mobileDiscountNote" class="text-xs text-slate-500 mt-2"></p>
                </div>
            </div>

            <div id="shareSection">
                <div class="text-left py-4">
                    <h3 class="text-lg font-bold text-slate-900 flex items-center">
                        <span class="text-xl mr-2">ğŸ’¬</span>
                        ì´ ê²°ê³¼ë¡œ ìƒë‹´í•˜ê¸°
                    </h3>
                    <p class="text-sm text-slate-500 mt-1">
                        ê³„ì‚° ê²°ê³¼ë¥¼ ì „ë¬¸ê°€ì—ê²Œ ë³´ë‚´ê³  ë°”ë¡œ ìƒë‹´ì„ ì‹œì‘í•˜ì„¸ìš”!
                    </p>
                </div>
                <div class="grid grid-cols-2 gap-4">
                     <a href="#" id="kakaoShareBtn" class="share-btn kakao-btn">
                         ì¹´ì¹´ì˜¤í†¡ìœ¼ë¡œ ë³´ë‚´ê¸°
                     </a>
                     <a href="#" id="smsShareBtn" class="share-btn sms-btn">
                         ë¬¸ì ë©”ì‹œì§€ë¡œ ë³´ë‚´ê¸°
                     </a>
                </div>
            </div>
        </section>
    </main>

    <footer class="text-center p-6 mt-12 bg-slate-800 text-slate-300 text-sm">
        <p>ë³¸ ê³„ì‚°ê¸°ëŠ” ì˜ˆìƒ ìš”ê¸ˆ ì•ˆë‚´ë¥¼ ìœ„í•œ ì°¸ê³  ìë£Œì…ë‹ˆë‹¤.</p>
        <p>&copy; 2024 SKT ê²°í•© í• ì¸ ê³„ì‚°ê¸°. All Rights Reserved.</p>
    </footer>

    <script>
    const mobilePlanTiers = { "80K": [ { "plan_name": "5GX í”„ë¼ì„í”ŒëŸ¬ìŠ¤", "price": "â‚©99,000" }, { "plan_name": "5GX í”„ë¼ì„", "price": "â‚©89,000" }, { "plan_name": "0 ì²­ë…„ 99", "price": "â‚©99,000" }, { "plan_name": "0 ì²­ë…„ 89", "price": "â‚©89,000" }, { "plan_name": "Tí”Œëœ ë§¥ìŠ¤", "price": "â‚©100,000" }, { "plan_name": "Tí”Œëœ ìŠ¤í˜ì…œ", "price": "â‚©79,000" } ], "69K": [ { "plan_name": "5GX ë ˆê·¤ëŸ¬", "price": "â‚©69,000" }, { "plan_name": "5GX ë ˆê·¤ëŸ¬í”ŒëŸ¬ìŠ¤", "price": "â‚©79,000" }, { "plan_name": "0 ì²­ë…„ 79", "price": "â‚©79,000" }, { "plan_name": "0 ì²­ë…„ 69", "price": "â‚©69,000" }, { "plan_name": "Tí”Œëœ ì—ì„¼ìŠ¤", "price": "â‚©69,000" } ], "33K": [ { "plan_name": "ë² ì´ì§", "price": "â‚©49,000" }, { "plan_name": "ë² ì´ì§í”ŒëŸ¬ìŠ¤", "price": "â‚©59,000" }, { "plan_name": "ìŠ¬ë¦¼", "price": "â‚©55,000" }, { "plan_name": "0ì²­ë…„ 59", "price": "â‚©59,000" }, { "plan_name": "0ì²­ë…„ 49", "price": "â‚©49,000" }, { "plan_name": "0í‹´ 5G", "price": "â‚©45,000" }, { "plan_name": "Tí”Œëœ ì•ˆì‹¬ 4G", "price": "â‚©50,000" }, { "plan_name": "Tí”Œëœ ì•ˆì‹¬ 2.5G", "price": "â‚©43,000" }, { "plan_name": "Tí”Œëœì„¸ì´ë¸Œ", "price": "â‚©33,000" } ] };
    let allMobilePlans = [];
    const jsonData = { "internetPlans_base": [{"id": "internet_100m_standalone","name": "100M ì¸í„°ë„·","price": 22000,"speed_mbps": 100}, {"id": "internet_500m_standalone","name": "500M ì¸í„°ë„·","price": 33000,"speed_mbps": 500}, {"id": "internet_1g_standalone","name": "1GB ì¸í„°ë„·","price": 38500,"speed_mbps": 1000}], "internetPlans_tv_bundle_prices": [{"id": "internet_100m_with_tv","name": "100M ì¸í„°ë„·","price": 19800,"speed_mbps": 100}, {"id": "internet_500m_with_tv","name": "500M ì¸í„°ë„·","price": 27500,"speed_mbps": 500}, {"id": "internet_1g_with_tv","name": "1GB ì¸í„°ë„·","price": 33000,"speed_mbps": 1000}], "tvPackages": [{"id": "tv_economy_smart3","name": "B tv ì´ì½”ë…¸ë¯¸ (183ì±„ë„)","price": 14300, "category": "Economy"}, {"id": "tv_standard_smart3","name": "B tv ìŠ¤íƒ ë‹¤ë“œ (234ì±„ë„)","price": 17600, "category": "Standard"}, {"id": "tv_all_smart3","name": "B tv ALL (257ì±„ë„)","price": 20900, "category": "All"}, {"id": "tv_standard_netflix_2p","name": "B tv ìŠ¤íƒ ë‹¤ë“œ ë„·í”Œë¦­ìŠ¤ (2ì¸)","price": 29900, "category": "Standard"}, {"id": "tv_standard_netflix_premium_4p","name": "B tv ìŠ¤íƒ ë‹¤ë“œ ë„·í”Œë¦­ìŠ¤ (4ì¸)","price": 32900, "category": "Standard"}, {"id": "tv_all_netflix_2p","name": "B tv ALL ë„·í”Œë¦­ìŠ¤ (2ì¸)","price": 32400, "category": "All"}, {"id": "tv_all_netflix_premium_4p","name": "B tv ALL ë„·í”Œë¦­ìŠ¤ í”„ë¦¬ë¯¸ì—„ (4ì¸)","price": 35400, "category": "All"}], "additionalTvPackages": [{"id": "addtv_economy","name": "ì¶”ê°€TV ì´ì½”ë…¸ë¯¸","price": 8250}, {"id": "addtv_standard","name": "ì¶”ê°€TV ìŠ¤íƒ ë‹¤ë“œ","price": 9900}, {"id": "addtv_all","name": "ì¶”ê°€TV ALL","price": 11550}], "phonePlans": [{"id": "phone_landline","name": "ì¼ë°˜ ì „í™”","price": 1100}, {"id": "phone_070_internet_only_no_device_rental","name": "070 ì „í™” (ì¸í„°ë„·+ì „í™”)","price": 4400}, {"id": "phone_070_internet_tv_no_device_rental","name": "070 ì „í™” (ì¸í„°ë„·+TV+ì „í™”)","price": 2200}], "addOnServices": [{"id": "wifi_router_default","name": "ì™€ì´íŒŒì´ ê³µìœ ê¸°","price": 1100}, {"id": "wifi_router_yozoom_100M_tv","name": "ìš”ì¦˜ìš°ë¦¬ì§‘ê²°í•© ê³µìœ ê¸°","price": 2200}, {"id": "wifi_router_not_selected","name": "ê³µìœ ê¸° ì„ íƒ ì•ˆí•¨","price": 0}, {"id": "nugu2_stb","name": "Nugu2 (AI)","price": 2200,"type": "AI STB"}, {"id": "ai_soundbar_max_stb","name": "AI ì‚¬ìš´ë“œë°” ë§¥ìŠ¤","price": 6600,"type": "AI STB"}, {"id": "apple_tv_stb_promo","name": "ì• í”Œtv 4K","price": 0,"type": "STB","note": "í”„ë¡œëª¨ì…˜ê°€"}, {"id": "ai4_vision_stb", "name": "AI4 Vision", "price": 4400, "type": "STB"}], "bundleInternetDiscounts": [{"bundle_name": "ìš”ì¦˜ê°€ì¡±ê²°í•©","condition": "100M + TV","discount_amount": 3300}, {"bundle_name": "íŒ¨ë°€ë¦¬ê²°í•©","condition": "100M + TV","discount_amount": 3300}, {"bundle_name": "ì•Œëœ°í•œ ê²°í•©","condition": "100M + TV","discount_amount": 3300}, {"bundle_name": "ìš”ì¦˜ê°€ì¡±ê²°í•©","condition": "500M + TV","discount_amount": 6600}, {"bundle_name": "íŒ¨ë°€ë¦¬ê²°í•©","condition": "500M + TV","discount_amount": 5500}, {"bundle_name": "ì•Œëœ°í•œ ê²°í•©","condition": "500M + TV","discount_amount": 6600}, {"bundle_name": "ìš”ì¦˜ê°€ì¡±ê²°í•©","condition": "1GB + TV","discount_amount": 8800}, {"bundle_name": "íŒ¨ë°€ë¦¬ê²°í•©","condition": "1GB + TV","discount_amount": 5500}, {"bundle_name": "ì•Œëœ°í•œ ê²°í•©","condition": "1GB + TV","discount_amount": 8800}, {"bundle_name": "ìš”ì¦˜ê°€ì¡±ê²°í•©","condition": "100M (ë‹¨ë…)","discount_amount": 4400}, {"bundle_name": "íŒ¨ë°€ë¦¬ê²°í•©","condition": "100M (ë‹¨ë…)","discount_amount": 5500}, {"bundle_name": "ì•Œëœ°í•œ ê²°í•©","condition": "100M (ë‹¨ë…)","discount_amount": 4400}, {"bundle_name": "ìš”ì¦˜ê°€ì¡±ê²°í•©","condition": "500M (ë‹¨ë…)","discount_amount": 11000}, {"bundle_name": "íŒ¨ë°€ë¦¬ê²°í•©","condition": "500M (ë‹¨ë…)","discount_amount": 11000}, {"bundle_name": "ì•Œëœ°í•œ ê²°í•©","condition": "500M (ë‹¨ë…)","discount_amount": 11000}, {"bundle_name": "ìš”ì¦˜ê°€ì¡±ê²°í•©","condition": "1GB (ë‹¨ë…)","discount_amount": 13200}, {"bundle_name": "íŒ¨ë°€ë¦¬ê²°í•©","condition": "1GB (ë‹¨ë…)","discount_amount": 11000}, {"bundle_name": "ì•Œëœ°í•œ ê²°í•©","condition": "1GB (ë‹¨ë…)","discount_amount": 13200}] };
    const onGajokConfig = { internetDiscountRate: {"0_9": 0.10, "10_19": 0.20, "20_29": 0.30, "30_plus": 0.50}, mobileDiscountRate: {"0_9": 0, "10_19": 0, "20_29": 0.10, "30_plus": 0.30} };
    const yozoomGajokMobileDiscountReference = { "100": [{ lines: 0, discount: 0 },{ lines: 1, discount: 3500 },{ lines: 2, discount: 7000 },{ lines: 3, discount: 18000 },{ lines: 4, discount: 18000 },{ lines: 5, discount: 18000 }], "500_1000": [{ lines: 0, discount: 0 },{ lines: 1, discount: 3500 },{ lines: 2, discount: 7000 },{ lines: 3, discount: 18000 },{ lines: 4, discount: 24000 },{ lines: 5, discount: 24000 }] };
    const giftTableSktBase = { "100": { "ë‹¨ë…": 110000, "ë²ˆë“¤": 430000 }, "500": { "ë‹¨ë…": 170000, "ë²ˆë“¤": 480000 }, "1000": { "ë‹¨ë…": 170000, "ë²ˆë“¤": 480000 } };
    const dongpanGiftTable = { "33K": {"100": {"Economy": 55000, "Standard": 60000, "All": 65000, "ë‹¨ë…": 0 }, "500": {"Economy": 60000, "Standard": 65000, "All": 70000, "ë‹¨ë…": 0 }, "1000": {"Economy": 60000, "Standard": 65000, "All": 70000, "ë‹¨ë…": 0 }}, "69K": {"100": {"ë‹¨ë…": 130000, "Economy": 159500, "Standard": 174000, "All": 188500 }, "500": {"ë‹¨ë…": 140000, "Economy": 174000, "Standard": 188500, "All": 203000 }, "1000": {"ë‹¨ë…": 140000, "Economy": 174000, "Standard": 188500, "All": 203000 }}, "80K": {"100": {"ë‹¨ë…": 162500, "Economy": 181500, "Standard": 198000, "All": 214500 }, "500": {"ë‹¨ë…": 175000, "Economy": 198000, "Standard": 214500, "All": 231000 }, "1000": {"ë‹¨ë…": 175000, "Economy": 198000, "Standard": 214500, "All": 231000 }} };
    
    const dom = { internetTypeRadios: document.querySelectorAll('input[name="internetType"]'), internetPlanEl: document.getElementById('internetPlan'), wifiRouterEl: document.getElementById('wifiRouter'), tvPlanEl: document.getElementById('tvPlan'), tvStbEl: document.getElementById('tvStb'), additionalTvPlanEl: document.getElementById('additionalTvPlan'), phonePlanEl: document.getElementById('phonePlan'), mobileLinesCountEl: document.getElementById('mobileLinesCount'), mobileLinesContainerEl: document.getElementById('mobileLinesContainer'), dongpanSalesCheckEl: document.getElementById('dongpanSalesCheck'), dongpanUsimPolicyDetailsContainerEl: document.getElementById('dongpanUsimPolicyDetailsContainer'), discountTypeRadios: document.querySelectorAll('input[name="discountType"]'), bundleApplicationTimeRadios: document.querySelectorAll('input[name="bundleApplicationTime"]'), discountDetailsToggleEl: document.getElementById('discountDetailsToggle'), discountDetailsContainerEl: document.getElementById('discountDetailsContainer'), onGajokYearsGroupEl: document.getElementById('onGajokYearsGroup'), onGajokYearsEl: document.getElementById('onGajokYears'), calculateButton: document.getElementById('calculateButton'), resultSection: document.getElementById('resultSection'), summaryMonthlyCostEl: document.getElementById('summaryMonthlyCost'), summaryTotalGiftEl: document.getElementById('summaryTotalGift'), internetDiscountLabel: document.getElementById('internetDiscountLabel'), summaryInternetDiscountEl: document.getElementById('summaryInternetDiscount'), summaryMobileDiscountEl: document.getElementById('summaryMobileDiscount'), selfRegistrationNoticeEl: document.getElementById('selfRegistrationNotice'), toggleDetailsButtonEl: document.getElementById('toggleDetailsButton'), detailsContainerEl: document.getElementById('detailsContainer'), selectedInternetEl: document.getElementById('selectedInternet'), selectedTvEl: document.getElementById('selectedTv'), selectedStbEl: document.getElementById('selectedStb'), selectedAdditionalTvEl: document.getElementById('selectedAdditionalTv'), selectedPhoneEl: document.getElementById('selectedPhone'), selectedWifiEl: document.getElementById('selectedWifi'), selectedDiscountTypeEl: document.getElementById('selectedDiscountType'), onGajokYearsResultContainerEl: document.getElementById('onGajokYearsResultContainer'), selectedOnGajokYearsEl: document.getElementById('selectedOnGajokYears'), calculationDetailsEl: document.getElementById('calculationDetails'), finalMonthlyCostEl: document.getElementById('finalMonthlyCost'), finalCostLabelQualifierEl: document.getElementById('finalCostLabelQualifier'), giftBaseInternetEl: document.getElementById('giftBaseInternet'), additionalDongpanCashContainerEl: document.getElementById('additionalDongpanCashContainer'), giftAdditionalDongpanCashEl: document.getElementById('giftAdditionalDongpanCash'), giftTotalEl: document.getElementById('giftTotal'), giftEligibilityNoteEl: document.getElementById('giftEligibilityNote'), mobileDiscountDetailsContainerEl: document.getElementById('mobileDiscountDetailsContainer'), mobileDiscountBreakdownEl: document.getElementById('mobileDiscountBreakdown'), mobileDiscountNoteEl: document.getElementById('mobileDiscountNote'), kakaoShareBtn: document.getElementById('kakaoShareBtn'), smsShareBtn: document.getElementById('smsShareBtn') };

    function findItemById(list, id) { return id && id !== 'none' ? list.find(item => item.id === id) || null : null; }
    function processMobilePlans() { allMobilePlans = []; for (const tier in mobilePlanTiers) { mobilePlanTiers[tier].forEach(p => { const price = parseInt(p.price.replace(/[^0-9]/g, '')); allMobilePlans.push({ id: `${p.plan_name.replace(/[\s()]/g, '_')}_${price}`, name: p.plan_name, price, tier }); }); } allMobilePlans.sort((a, b) => b.price - a.price); }
    function populateSelect(select, items, defaultText, vF = 'id', nF = 'name', pF = 'price') { select.innerHTML = ''; if (defaultText) { const opt = document.createElement('option'); opt.value = 'none'; opt.textContent = defaultText; select.appendChild(opt); } items.forEach(item => { const opt = document.createElement('option'); opt.value = item[vF]; let text = item[nF]; if (pF && item[pF] > 0) text += ` (+${item[pF].toLocaleString()}ì›)`; opt.textContent = text; select.appendChild(opt); }); }
    function initializeSelects() { processMobilePlans(); populateInternetPlans(); const wifiOpts = jsonData.addOnServices.filter(s => s.id.includes("wifi")); populateSelect(dom.wifiRouterEl, wifiOpts, "ê³µìœ ê¸° ì„ íƒ ì•ˆí•¨"); dom.wifiRouterEl.value = 'wifi_router_default'; const stbOpts = jsonData.addOnServices.filter(s => s.type === "AI STB" || s.type === "STB"); populateSelect(dom.tvStbEl, stbOpts, "ì„ íƒ ì•ˆí•¨ (ê¸°ë³¸ì…‹í†± ì‚¬ìš©)"); populateSelect(dom.tvPlanEl, jsonData.tvPackages, "ì„ íƒ ì•ˆí•¨"); populateSelect(dom.additionalTvPlanEl, jsonData.additionalTvPackages, "ì„ íƒ ì•ˆí•¨"); populateSelect(dom.phonePlanEl, jsonData.phonePlans, "ì„ íƒ ì•ˆí•¨"); }
    function populateInternetPlans() { const type = dom.internetTypeRadios[0].checked ? 'bundle' : 'standalone'; const plans = (type === 'bundle') ? jsonData.internetPlans_tv_bundle_prices : jsonData.internetPlans_base; const currentId = dom.internetPlanEl.value; populateSelect(dom.internetPlanEl, plans, "í•„ìˆ˜ ì„ íƒ"); if (findItemById(plans, currentId)) dom.internetPlanEl.value = currentId; }
    function manageWifiSelection() { const internetId = dom.internetPlanEl.value; if (internetId === 'none') return; const type = dom.internetTypeRadios[0].checked ? 'bundle' : 'standalone'; const discount = document.querySelector('input[name="discountType"]:checked').value; const planInfo = findItemById(type === 'bundle' ? jsonData.internetPlans_tv_bundle_prices : jsonData.internetPlans_base, internetId); const tvSelected = dom.tvPlanEl.value !== 'none'; const condition = planInfo && planInfo.speed_mbps === 100 && type === 'bundle' && tvSelected && discount === 'noBundleDiscount'; dom.wifiRouterEl.disabled = condition; dom.wifiRouterEl.value = condition ? "wifi_router_yozoom_100M_tv" : (dom.wifiRouterEl.value === 'wifi_router_yozoom_100M_tv' ? "wifi_router_default" : dom.wifiRouterEl.value); }
    function updateTvSubOptionsState() { const isStandalone = dom.internetTypeRadios[1].checked; [dom.tvPlanEl, dom.tvStbEl, dom.additionalTvPlanEl, dom.phonePlanEl].forEach(el => el.disabled = isStandalone); if (isStandalone) [dom.tvPlanEl, dom.tvStbEl, dom.additionalTvPlanEl, dom.phonePlanEl].forEach(el => el.value = 'none'); }
    function updateMobileLinesInputs() { const count = Math.max(0, Math.min(5, parseInt(dom.mobileLinesCountEl.value, 10) || 0)); dom.mobileLinesContainerEl.innerHTML = ''; if (count === 0) return; for (let i = 0; i < count; i++) { const div = document.createElement('div'); div.className = 'mobile-line-item border border-slate-200 p-4 rounded-lg'; const select = document.createElement('select'); select.id = `mobilePlan${i}`; select.className = 'select-field'; allMobilePlans.forEach(plan => { const opt = document.createElement('option'); opt.value = plan.id; opt.textContent = `${plan.name} (${plan.price.toLocaleString()}ì›)`; select.appendChild(opt); }); select.value = allMobilePlans.find(p => p.price === 33000)?.id || allMobilePlans[allMobilePlans.length - 1]?.id; const contractDiv = document.createElement('div'); contractDiv.className = 'mt-2'; const contractLabel = document.createElement('label'); contractLabel.className = 'radio-label !w-auto !border-none !p-1'; const contractCheckbox = document.createElement('input'); contractCheckbox.type = 'checkbox'; contractCheckbox.id = `selectiveContractCheck${i}`; contractCheckbox.className = 'radio-input'; contractLabel.appendChild(contractCheckbox); contractLabel.append(' ì„ íƒì•½ì • (25% ì¶”ê°€ í• ì¸)'); contractDiv.appendChild(contractLabel); div.innerHTML = `<label for="mobilePlan${i}" class="block text-sm font-medium text-slate-600 mb-2">íšŒì„  ${i + 1} ìš”ê¸ˆì œ</label>`; div.appendChild(select); div.appendChild(contractDiv); dom.mobileLinesContainerEl.appendChild(div); } }
    
    function updateDiscountDetailsContent() {
        if (dom.discountDetailsContainerEl.innerHTML.trim() !== '') return;
        const policies = {
            "ìš”ì¦˜ê°€ì¡±ê²°í•©": `<div class="discount-details"><p class="font-bold mb-1 text-red-700">ìš”ì¦˜ê°€ì¡±ê²°í•©</p><p>ì¸í„°ë„· ëª…ì˜ì ë³¸ì¸ ëª¨ë°”ì¼ 1íšŒì„  í•„ìˆ˜ í¬í•¨, ìµœëŒ€ 5ëŒ€ ê°€ì¡± ëª¨ë°”ì¼ ê²°í•©.</p></div>`,
            "ì˜¨ê°€ì¡±í• ì¸": `<div class="discount-details"><p class="font-bold mb-1 text-red-700">ì˜¨ê°€ì¡±í• ì¸</p><p>ê°€ì¡± êµ¬ì„±ì›ì˜ SKT ì´ ê°€ì… ì—°ìˆ˜ì— ë”°ë¼ í• ì¸ìœ¨ ì°¨ë“± ì ìš©.</p></div>`,
            "íŒ¨ë°€ë¦¬ê²°í•©": `<div class="discount-details"><p class="font-bold mb-1 text-red-700">íŒ¨ë°€ë¦¬ê²°í•©</p><p>ê¸°ì¡´ SKB ì¸í„°ë„· ì‚¬ìš© ê°€ì¡±ì´ ìˆì„ ê²½ìš°, ì¶”ê°€ ì¸í„°ë„· í• ì¸.</p></div>`,
            "ì•Œëœ°í•œ ê²°í•©": `<div class="discount-details">
                <p class="font-bold mb-1 text-red-700">ì•Œëœ°í•œ ê²°í•©</p>
                <p>SKB ì¸í„°ë„· + ë³¸ì¸ ëª…ì˜ ì•Œëœ°í° 1:1 ê²°í•©.</p>
                <h4>âœ… ê²°í•© ì¡°ê±´</h4>
                <ul>
                    <li>30ì¼ ì´ë‚´ SKB ì‹ ê·œ ê°€ì… ë˜ëŠ” ì•½ì • ì¢…ë£Œ ê³ ê°</li>
                    <li>SKB ì¸í„°ë„·(ë³¸ì¸) + ì•Œëœ°í°(ë³¸ì¸) 1:1 ê²°í•©ë§Œ ê°€ëŠ¥ (ê°€ì¡± ëª…ì˜ ë¶ˆê°€)</li>
                    <li>TV ë²ˆë“¤ í• ì¸ì•¡ì€ 'ìš”ì¦˜ê°€ì¡±ê²°í•©'ê³¼ ë™ì¼í•˜ê²Œ ì ìš©</li>
                    <li>SKT, ë²•ì¸ ê²°í•© ê³ ê°ì€ ì¤‘ë³µ ë¶ˆê°€</li>
                </ul>
                <h4>ğŸ¤ ê²°í•© ê°€ëŠ¥ í†µì‹  ì‚¬ì—…ì</h4>
                <ol style="list-style-type: decimal; padding-left: 1.25rem;">
                    <li>KB êµ­ë¯¼ì€í–‰(ë¦¬ë¸Œì— ëª¨ë°”ì¼)</li>
                    <li>í°ì‚¬ëŒì»¤ë„¥íŠ¸(ì´ì•¼ê¸°ëª¨ë°”ì¼)</li>
                    <li>ìœ ë‹ˆì»´ì¦ˆ(ëª¨ë¹™)</li>
                    <li>í† ìŠ¤(í† ìŠ¤ëª¨ë°”ì¼)</li>
                    <li>ì•„ì´ì¦ˆ ë¹„ì „(ì•„ì´ì¦ˆëª¨ë°”ì¼)</li>
                    <li>SKí…”ë§í¬(ì„¸ë¸ëª¨ë°”ì¼)</li>
                    <li>í‹°í”ŒëŸ¬ìŠ¤(KTC)</li>
                    <li>ìŠ¤ë§ˆí…”(SMT)</li>
                </ol>
                <h4>âŒ ê²°í•© ë¶ˆê°€ ì¡°ê±´</h4>
                <ul>
                    <li>ì„ ë¶ˆí°, IOT, ë°ì´í„° ì‰ì–´ë§, íƒœë¸”ë¦¿ ë“± ì§€ì •ë˜ì§€ ì•Šì€ ìš”ê¸ˆì œ</li>
                    <li>ê²°í•© ì¤‘ ì•Œëœ°í° í†µì‹ ì‚¬ ë³€ê²½ ì‹œ, ê²°í•© í•´ì§€ í›„ ì¬ê²°í•© ë¶ˆê°€</li>
                </ul>
            </div>`
        };
        dom.discountDetailsContainerEl.innerHTML = Object.values(policies).join('');
    }

    function calculateAndDisplayResults() {
        if (dom.internetPlanEl.value === 'none') { alert('ì¸í„°ë„· ìš”ê¸ˆì œë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”.'); return; }
        const isBundle = dom.internetTypeRadios[0].checked;
        if (isBundle && dom.tvPlanEl.value === 'none') { alert('ì¸í„°ë„·+TV ë²ˆë“¤ì„ ì„ íƒí•˜ì…¨ìŠµë‹ˆë‹¤. B tv ìš”ê¸ˆì œë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”.'); return; }

        const inputs = { internetId: dom.internetPlanEl.value, isBundle, wifiId: dom.wifiRouterEl.value, tvId: dom.tvPlanEl.value, stbId: dom.tvStbEl.value, addTvId: dom.additionalTvPlanEl.value, phoneId: dom.phonePlanEl.value, mobileLines: parseInt(dom.mobileLinesCountEl.value) || 0, discountType: document.querySelector('input[name="discountType"]:checked').value, onGajokYears: dom.onGajokYearsEl.value, isDongpan: dom.dongpanSalesCheckEl.checked, applicationTime: document.querySelector('input[name="bundleApplicationTime"]:checked').value };
        
        if (inputs.discountType !== 'noBundleDiscount') {
            dom.selfRegistrationNoticeEl.classList.remove('hidden');
        } else {
            dom.selfRegistrationNoticeEl.classList.add('hidden');
        }

        const finalInternetPlan = findItemById(inputs.isBundle ? jsonData.internetPlans_tv_bundle_prices : jsonData.internetPlans_base, inputs.internetId);
        const tvPackage = findItemById(jsonData.tvPackages, inputs.tvId);
        const wifiAddon = findItemById(jsonData.addOnServices, inputs.wifiId);
        const additionalStbAddon = tvPackage ? findItemById(jsonData.addOnServices, inputs.stbId) : null;
        const additionalTvPackage = tvPackage ? findItemById(jsonData.additionalTvPackages, inputs.addTvId) : null;
        const phonePlan = findItemById(jsonData.phonePlans, inputs.phoneId);

        let p = { internet: finalInternetPlan?.price || 0, tv: tvPackage?.price || 0, wifi: wifiAddon?.price || 0, stb: additionalStbAddon?.price || 0, addTv: additionalTvPackage?.price || 0, phone: phonePlan?.price || 0 };

        if (inputs.discountType === 'ì˜¨ê°€ì¡±í• ì¸' && finalInternetPlan) {
            const standalonePlan = jsonData.internetPlans_base.find(plan => plan.speed_mbps === finalInternetPlan.speed_mbps);
            if (standalonePlan) p.internet = standalonePlan.price;
        }
        
        let internetDiscount = 0, wifiDiscount = 0;
        if (inputs.discountType !== "noBundleDiscount" && finalInternetPlan) {
            if (inputs.discountType === "ì˜¨ê°€ì¡±í• ì¸") {
                const rate = onGajokConfig.internetDiscountRate[inputs.onGajokYears] || 0;
                internetDiscount = Math.floor(p.internet * rate);
                if (wifiAddon?.price > 0 && finalInternetPlan.speed_mbps < 1000) wifiDiscount = Math.floor(p.wifi * rate);
            } else {
                const speedName = finalInternetPlan.name.replace(" ì¸í„°ë„·", "");
                const condition = tvPackage ? `${speedName} + TV` : `${speedName} (ë‹¨ë…)`;
                internetDiscount = jsonData.bundleInternetDiscounts.find(d => d.bundle_name === inputs.discountType && d.condition === condition)?.discount_amount || 0;
            }
        }
        
        let totalMobileDiscount = 0;
        dom.mobileDiscountDetailsContainerEl.classList.add('hidden');
        if (inputs.mobileLines > 0 && ['ìš”ì¦˜ê°€ì¡±ê²°í•©', 'ì˜¨ê°€ì¡±í• ì¸'].includes(inputs.discountType)) {
            let yozoomTotalDiscount = 0;
            if (inputs.discountType === 'ìš”ì¦˜ê°€ì¡±ê²°í•©' && finalInternetPlan) { const key = finalInternetPlan.speed_mbps === 100 ? "100" : "500_1000"; yozoomTotalDiscount = yozoomGajokMobileDiscountReference[key].find(t => t.lines === inputs.mobileLines)?.discount || 0; }
            
            dom.mobileDiscountBreakdownEl.innerHTML = '';
            dom.mobileDiscountDetailsContainerEl.classList.remove('hidden');

            for (let i = 0; i < inputs.mobileLines; i++) {
                const planSelect = document.getElementById(`mobilePlan${i}`);
                const contractCheck = document.getElementById(`selectiveContractCheck${i}`);
                const selectedPlan = allMobilePlans.find(pl => pl.id === planSelect.value);
                if (!selectedPlan) continue;
                
                let bundleDiscount = 0;
                if (inputs.discountType === 'ìš”ì¦˜ê°€ì¡±ê²°í•©') {
                    bundleDiscount = (inputs.mobileLines > 0) ? Math.floor(yozoomTotalDiscount / inputs.mobileLines) : 0;
                } else if (inputs.discountType === 'ì˜¨ê°€ì¡±í• ì¸') {
                    bundleDiscount = Math.floor(selectedPlan.price * (onGajokConfig.mobileDiscountRate[inputs.onGajokYears] || 0));
                }
                const contractDiscount = contractCheck.checked ? Math.floor(selectedPlan.price * 0.25) : 0;
                const lineDiscount = bundleDiscount + contractDiscount;
                totalMobileDiscount += lineDiscount;
                
                const pEl = document.createElement('p');
                const finalMobilePrice = selectedPlan.price - lineDiscount;
                pEl.innerHTML = `<span class="font-semibold">${selectedPlan.name}</span>: ${selectedPlan.price.toLocaleString()}ì› - ${lineDiscount.toLocaleString()}ì› = <strong>${finalMobilePrice.toLocaleString()}ì›</strong>`;
                dom.mobileDiscountBreakdownEl.appendChild(pEl);
            }
            if(inputs.discountType === 'ìš”ì¦˜ê°€ì¡±ê²°í•©') {
                dom.mobileDiscountNoteEl.textContent = `* ì´ ê²°í•©í• ì¸ì•¡ ${yozoomTotalDiscount.toLocaleString()}ì›ì„ ${inputs.mobileLines}ê°œ íšŒì„ ì— ë¶„í•  ì ìš©í•œ ì˜ˆìƒì¹˜ì…ë‹ˆë‹¤.`;
            } else {
                dom.mobileDiscountNoteEl.textContent = ``;
            }
        }

        const totalBaseCost = p.internet + p.tv + p.wifi + p.stb + p.addTv + p.phone;
        const totalDiscount = internetDiscount + wifiDiscount;
        const finalMonthlyCost = totalBaseCost - totalDiscount;
        let displayCost = (inputs.applicationTime === 'post') ? totalBaseCost : finalMonthlyCost;
        
        let baseGift = 0;
        const giftKeyType = tvPackage ? "ë²ˆë“¤" : "ë‹¨ë…";
        const giftKeySpeed = String(finalInternetPlan?.speed_mbps || 0);
        if (giftTableSktBase[giftKeySpeed]?.[giftKeyType]) baseGift = giftTableSktBase[giftKeySpeed][giftKeyType];
        
        let dongpanGift = 0;
        dom.additionalDongpanCashContainerEl.classList.toggle('hidden', !inputs.isDongpan);
        dom.giftEligibilityNoteEl.textContent = '';
        if (inputs.isDongpan) {
            if (inputs.mobileLines === 0) dom.giftEligibilityNoteEl.textContent = "ë™íŒ ì‚¬ì€í’ˆì€ íœ´ëŒ€í° íšŒì„  ê°œí†µ ì‹œì—ë§Œ ì ìš©ë©ë‹ˆë‹¤.";
            else { for (let i = 0; i < inputs.mobileLines; i++) { const planSelect = document.getElementById(`mobilePlan${i}`); const selectedPlan = allMobilePlans.find(pl => pl.id === planSelect.value); if(!selectedPlan) continue; const tier = selectedPlan.tier; const tvCategory = tvPackage?.category || "ë‹¨ë…"; if(dongpanGiftTable[tier]?.[giftKeySpeed]?.[tvCategory]) dongpanGift += dongpanGiftTable[tier][giftKeySpeed][tvCategory]; } if (dongpanGift === 0) dom.giftEligibilityNoteEl.textContent = "ì„ íƒí•˜ì‹  ìš”ê¸ˆì œëŠ” ë™íŒ ì‚¬ì€í’ˆ ì§€ê¸‰ ê¸°ì¤€ì— í•´ë‹¹í•˜ì§€ ì•Šì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤."; }
        }
        const totalGift = baseGift + dongpanGift;

        dom.resultSection.classList.remove('hidden');
        dom.summaryMonthlyCostEl.textContent = `${displayCost.toLocaleString()}ì›`;
        const originalCostEl = dom.summaryMonthlyCostEl.parentElement.querySelector('.original-cost-display');
        if(originalCostEl) originalCostEl.remove();
        if(inputs.applicationTime === 'pre' && totalDiscount > 0) { const newEl = document.createElement('p'); newEl.className = 'text-sm text-slate-500 line-through -mt-1 original-cost-display'; newEl.textContent = `í• ì¸ ì „ ${totalBaseCost.toLocaleString()}ì›`; dom.summaryMonthlyCostEl.insertAdjacentElement('afterend', newEl); }
        
        dom.internetDiscountLabel.textContent = wifiDiscount > 0 ? 'ì¸í„°ë„·/TV/WiFi í• ì¸' : 'ì¸í„°ë„·/TV ìš”ê¸ˆ í• ì¸';
        dom.summaryInternetDiscountEl.textContent = `- ${totalDiscount.toLocaleString()}ì›`;
        dom.summaryMobileDiscountEl.textContent = `- ${totalMobileDiscount.toLocaleString()}ì›`;
        dom.summaryTotalGiftEl.textContent = `${totalGift.toLocaleString()}ì›`;
        
        dom.selectedInternetEl.textContent = finalInternetPlan?.name || 'ë¯¸ì„ íƒ';
        dom.selectedTvEl.textContent = tvPackage?.name || 'ë¯¸ì„ íƒ';
        dom.selectedStbEl.textContent = additionalStbAddon?.name || (tvPackage ? "ê¸°ë³¸ ì…‹í†±" : "ë¯¸ì„ íƒ");
        dom.selectedAdditionalTvEl.textContent = additionalTvPackage?.name || 'ë¯¸ì„ íƒ';
        dom.selectedPhoneEl.textContent = phonePlan?.name || 'ë¯¸ì„ íƒ';
        dom.selectedWifiEl.textContent = wifiAddon?.name || 'ë¯¸ì„ íƒ';
        dom.selectedDiscountTypeEl.textContent = document.querySelector(`label > input[name="discountType"][value="${inputs.discountType}"]`).parentElement.textContent.trim();
        dom.onGajokYearsResultContainerEl.classList.toggle('hidden', inputs.discountType !== 'ì˜¨ê°€ì¡±í• ì¸');
        if (inputs.discountType === 'ì˜¨ê°€ì¡±í• ì¸') dom.selectedOnGajokYearsEl.textContent = dom.onGajokYearsEl.options[dom.onGajokYearsEl.selectedIndex].text;
        
        dom.calculationDetailsEl.innerHTML = `${p.internet > 0 ? `<p>ì¸í„°ë„· ê¸°ë³¸ë£Œ: ${p.internet.toLocaleString()} ì›</p>`: ''} ${p.wifi > 0 ? `<p>ì™€ì´íŒŒì´: ${p.wifi.toLocaleString()} ì›</p>` : ''} ${p.tv > 0 ? `<p>TV ê¸°ë³¸ë£Œ: ${p.tv.toLocaleString()} ì›</p>` : ''} ${p.stb > 0 ? `<p>ì¶”ê°€ ì…‹í†±: ${p.stb.toLocaleString()} ì›</p>` : ''} ${p.addTv > 0 ? `<p>ì¶”ê°€ TV: ${p.addTv.toLocaleString()} ì›</p>` : ''} ${p.phone > 0 ? `<p>ì§‘ì „í™”: ${p.phone.toLocaleString()} ì›</p>` : ''} <p class="text-green-600 font-semibold">ê²°í•© í• ì¸ (ì¸í„°ë„·/WiFi): - ${totalDiscount.toLocaleString()} ì›</p>`;
        dom.finalMonthlyCostEl.textContent = displayCost.toLocaleString();
        dom.finalCostLabelQualifierEl.textContent = (inputs.applicationTime === 'post') ? `(í• ì¸ ì „)` : (totalDiscount > 0 ? `(í• ì¸ ì ìš©)` : ``);
        
        dom.giftBaseInternetEl.textContent = baseGift.toLocaleString();
        dom.giftAdditionalDongpanCashEl.textContent = dongpanGift.toLocaleString();
        dom.giftTotalEl.textContent = totalGift.toLocaleString();

        const shareMessage = `[SKT ìš”ê¸ˆê³„ì‚° ê²°ê³¼]\n\nâ–  ì„ íƒ ìƒí’ˆ\n- ì¸í„°ë„·: ${finalInternetPlan.name}\n${tvPackage ? `- TV: ${tvPackage.name}\n` : ''}\nâ–  ì˜ˆìƒ ìš”ê¸ˆ\n- ì›” ë‚©ë¶€ì•¡: ${displayCost.toLocaleString()}ì›\n${totalMobileDiscount > 0 ? `- (ì°¸ê³ ) íœ´ëŒ€í° ì›” ${totalMobileDiscount.toLocaleString()}ì› ì¶”ê°€ í• ì¸\n` : ''}\nâ–  ì˜ˆìƒ í˜œíƒ\n- ì‚¬ì€í’ˆ: ${totalGift.toLocaleString()}ì› ìƒë‹¹\n\nìƒë‹´ ì›í•˜ì‹œë©´ ë©”ì‹œì§€ë¥¼ ì „ì†¡í•´ì£¼ì„¸ìš”.`;
        dom.kakaoShareBtn.onclick = e => { e.preventDefault(); location.href = `kakaolink://send?text=${encodeURIComponent(shareMessage)}`; };
        
        // [ìˆ˜ì •] sms ë§í¬ì— ìˆ˜ì‹ ì ì „í™”ë²ˆí˜¸ ì¶”ê°€
        const targetPhoneNumber = '01042978846';
        dom.smsShareBtn.href = `sms:${targetPhoneNumber}?body=${encodeURIComponent(shareMessage)}`;
        
        dom.resultSection.scrollIntoView({ behavior: 'smooth', block: 'start' });
    }

    document.addEventListener('DOMContentLoaded', () => {
        initializeSelects();
        const triggerChange = () => { updateTvSubOptionsState(); manageWifiSelection(); };
        dom.internetTypeRadios.forEach(r => r.addEventListener('change', () => { populateInternetPlans(); triggerChange(); }));
        dom.internetPlanEl.addEventListener('change', triggerChange);
        dom.tvPlanEl.addEventListener('change', triggerChange);
        dom.discountTypeRadios.forEach(r => r.addEventListener('change', (e) => {
            dom.onGajokYearsGroupEl.classList.toggle('hidden', e.target.value !== 'ì˜¨ê°€ì¡±í• ì¸');
            const isSktBundle = ['ìš”ì¦˜ê°€ì¡±ê²°í•©', 'ì˜¨ê°€ì¡±í• ì¸'].includes(e.target.value);
            dom.mobileLinesCountEl.disabled = !isSktBundle;
            if(!isSktBundle) { dom.mobileLinesCountEl.value = 0; updateMobileLinesInputs(); }
            manageWifiSelection();
        }));
        dom.dongpanSalesCheckEl.addEventListener('change', () => dom.dongpanUsimPolicyDetailsContainerEl.classList.toggle('hidden', !dom.dongpanSalesCheckEl.checked));
        dom.mobileLinesCountEl.addEventListener('input', updateMobileLinesInputs);
        
        dom.discountDetailsToggleEl.addEventListener('change', () => {
            const isChecked = dom.discountDetailsToggleEl.checked;
            if (isChecked) updateDiscountDetailsContent();
            dom.discountDetailsContainerEl.classList.toggle('hidden', !isChecked);
        });

        dom.calculateButton.addEventListener('click', calculateAndDisplayResults);
        dom.toggleDetailsButtonEl.addEventListener('click', () => { const isHidden = dom.detailsContainerEl.classList.toggle('hidden'); dom.toggleDetailsButtonEl.innerHTML = isHidden ? 'ìƒì„¸ ìš”ê¸ˆ ë‚´ì—­ í¼ì³ë³´ê¸° â–¼' : 'ìƒì„¸ ìš”ê¸ˆ ë‚´ì—­ ì ‘ê¸° â–²'; });
        triggerChange();
    });
    </script>
</body>
</html>