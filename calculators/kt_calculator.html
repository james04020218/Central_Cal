<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>KT ê²°í•© í• ì¸ ê³„ì‚°ê¸° (ìƒë‹´ ê¸°ëŠ¥ ì¶”ê°€)</title>
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Noto Sans KR í°íŠ¸ ë¶ˆëŸ¬ì˜¤ê¸° -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@400;700&display=swap" rel="stylesheet">
    
    <style>
        body {
            font-family: 'Noto Sans KR', sans-serif;
            background-color: #f8fafc; 
        }
        .input-group { margin-bottom: 1.5rem; }
        .input-label { display: block; margin-bottom: 0.5rem; font-weight: 500; color: #334155; }
        .input-field, .select-field { width: 100%; padding: 0.5rem 0.75rem; border: 1px solid #cbd5e1; border-radius: 0.375rem; box-shadow: sm; transition: border-color 0.15s ease-in-out, box-shadow 0.15s ease-in-out; }
        .input-field:focus, .select-field:focus { border-color: #0ea5e9; outline: none; box-shadow: 0 0 0 0.2rem rgba(14, 165, 233, 0.25); }
        .input-field:disabled, .select-field:disabled { background-color: #e2e8f0; cursor: not-allowed; }
        .btn-primary { background-color: #0ea5e9; color: white; padding: 0.75rem 1.5rem; border-radius: 0.375rem; font-weight: 600; transition: background-color 0.3s ease; }
        .btn-primary:hover { background-color: #0284c7; }
        .btn-secondary { background-color: #64748b; color: white; padding: 0.75rem 1.5rem; border-radius: 0.375rem; font-weight: 600; transition: background-color 0.3s ease; }
        .btn-secondary:hover { background-color: #475569; }
        .section-title { font-size: 1.5rem; font-weight: 700; color: #0369a1; margin-bottom: 1rem; padding-bottom: 0.5rem; border-bottom: 2px solid #38bdf8;}
        .result-card { background-color: white; padding: 1.5rem; border-radius: 0.5rem; box-shadow: 0 4px 6px -1px rgba(0,0,0,0.1), 0 2px 4px -1px rgba(0,0,0,0.06); margin-bottom: 1.5rem; }
        .radio-label { margin-right: 1rem; margin-bottom: 0.5rem; display: inline-flex; align-items: center; cursor: pointer;}
        .radio-input { margin-right: 0.5rem; accent-color: #0ea5e9; }
        .info-box { background-color: #eff6ff; border-left: 4px solid #3b82f6; padding: 1rem; margin-top:0.5rem; margin-bottom:1rem; font-size: 0.875rem; color: #1e40af; }
        .info-box ul { padding-left: 1.25rem; list-style-type: disc; }
        .info-box ul ul { padding-left: 1rem; list-style-type: circle;}
        .toggle-switch { position: relative; display: inline-block; width: 40px; height: 20px; margin-left: 10px; vertical-align: middle;}
        .toggle-switch input { opacity: 0; width: 0; height: 0; }
        .slider { position: absolute; cursor: pointer; top: 0; left: 0; right: 0; bottom: 0; background-color: #ccc; transition: .4s; border-radius: 20px;}
        .slider:before { position: absolute; content: ""; height: 16px; width: 16px; left: 2px; bottom: 2px; background-color: white; transition: .4s; border-radius: 50%;}
        input:checked + .slider { background-color: #2196F3; }
        input:checked + .slider:before { transform: translateX(20px); }
        .discount-details { background-color: #e0f2fe; border: 1px solid #7dd3fc; padding: 1rem; border-radius: 0.375rem; font-size:0.875rem; }
        .discount-details ul { padding-left: 1.25rem; }
        .discount-details ul ul { padding-left: 1rem; }
    </style>
</head>
<body class="text-slate-800">
    <header class="bg-sky-700 text-white p-6 shadow-md">
        <div class="container mx-auto max-w-4xl">
            <h1 class="text-3xl font-bold text-center">KT ê²°í•© í• ì¸ ê³„ì‚°ê¸°</h1>
            <p class="text-center text-sky-200 mt-1">ì„ íƒí•˜ì‹  ì„œë¹„ìŠ¤ì™€ í• ì¸ ìœ í˜•ì— ë”°ë¥¸ ì˜ˆìƒ ìš”ê¸ˆì„ ê³„ì‚°í•´ ë³´ì„¸ìš”.</p>
        </div>
    </header>

    <main class="container mx-auto max-w-4xl p-4 sm:p-6 lg:p-8">
        <section id="inputSection" class="mb-8">
            <h2 class="section-title">1. ì„œë¹„ìŠ¤ ì„ íƒ (3ë…„ ì•½ì • ê¸°ì¤€, VAT í¬í•¨)</h2>
            <p class="mb-4 text-sm text-slate-600">ì•„ë˜ í•­ëª©ë“¤ì„ ì„ íƒí•´ì£¼ì„¸ìš”. ëª¨ë“  ìš”ê¸ˆì€ KT í‘œì¤€ 3ë…„ ì•½ì •, ë¶€ê°€ì„¸ í¬í•¨ ê¸ˆì•¡ì„ ê¸°ì¤€ìœ¼ë¡œ í•©ë‹ˆë‹¤.</p>
            
            <div class="mb-4 text-sm">
                <span class="font-semibold text-sky-700">KT ì¸í„°ë„· ìƒí’ˆì²­ì•½ ë³¸ì¸ì¸ì¦ ë§í¬:</span>
                <a href="https://online.kt.com/smart/simple/simpleCustomerInfoPop.do?prdcId=0F0BA335-ACD6-459E-BDB3-95CE61EEFE35" target="_blank" class="text-blue-600 hover:text-blue-700 underline font-medium">ë°”ë¡œê°€ê¸° (PASS ë˜ëŠ” ì‹ ìš©ì¹´ë“œ ì¸ì¦)</a>
            </div>

            <div class="input-group">
                <label class="input-label">ì¸í„°ë„· ìœ í˜• ì„ íƒ</label>
                <div class="flex items-center space-x-4">
                    <label class="radio-label">
                        <input type="radio" name="internetType" value="bundle" class="radio-input">
                        ì¸í„°ë„· + TV ë²ˆë“¤
                    </label>
                    <label class="radio-label">
                        <input type="radio" name="internetType" value="standalone" class="radio-input" checked>
                        ì¸í„°ë„· ë‹¨ë…
                    </label>
                </div>
            </div>

            <div class="grid md:grid-cols-2 gap-6">
                <div class="input-group">
                    <label for="internetPlan" class="input-label">ì¸í„°ë„· ìš”ê¸ˆì œ</label>
                    <select id="internetPlan" class="select-field">
                    </select>
                </div>
                
                <div class="input-group">
                    <label for="wifiRouterRental" class="input-label block mb-1">ì™€ì´íŒŒì´ ê³µìœ ê¸°</label>
                    <select id="wifiRouterRental" class="select-field">
                        <option value="1100" data-name="KTê³µìœ ê¸°">KTê³µìœ ê¸° (ì›” 1,100ì›)</option>
                        <option value="0" data-name="GiGA WiFi home ax">GiGA WiFi home ax (í”„ë¡œëª¨ì…˜ ë¬´ë£Œ)</option>
                        <option value="0" data-name="KT WiFi 7D">KT WiFi 7D (í”„ë¡œëª¨ì…˜ ë¬´ë£Œ)</option>
                        <option value="0" data-name="KTê³µìœ ê¸° X">KTê³µìœ ê¸° X (ë¯¸ì‚¬ìš©)</option>
                    </select>
                </div>

                <div class="input-group">
                    <label for="tvPlan" class="input-label">TV ìš”ê¸ˆì œ (1ë²ˆì§¸ TV, ê¸°ê°€ì§€ë‹ˆA í¬í•¨ê°€)</label>
                    <select id="tvPlan" class="select-field">
                        <option value="none" data-category="ì—†ìŒ" data-stb-included-price="0">ì„ íƒ ì•ˆí•¨</option>
                        <option value="KTTVë² ì´ì§" data-price="15400" data-category="ë² ì´ì§" data-stb-included-price="15400">KTTVë² ì´ì§ (236ì±„ë„) + ê¸°ê°€ì§€ë‹ˆA (ì›” 15,400ì›)</option>
                        <option value="KTTVë¼ì´íŠ¸" data-price="16500" data-category="ë¼ì´íŠ¸" data-stb-included-price="16500">KTTVë¼ì´íŠ¸ (240ì±„ë„) + ê¸°ê°€ì§€ë‹ˆA (ì›” 16,500ì›)</option>
                        <option value="KTTVì—ì„¼ìŠ¤" data-price="19800" data-category="ì—ì„¼ìŠ¤" data-stb-included-price="19800">KTTVì—ì„¼ìŠ¤ (266ì±„ë„) + ê¸°ê°€ì§€ë‹ˆA (ì›” 19,800ì›)</option>
                        <option value="KTTVì—ì„¼ìŠ¤ í”ŒëŸ¬ìŠ¤" data-price="24200" data-category="ì—ì„¼ìŠ¤ í”ŒëŸ¬ìŠ¤" data-stb-included-price="24200">KTTVì—ì„¼ìŠ¤ í”ŒëŸ¬ìŠ¤ (266+ì±„ë„) (ì›” 24,200ì›)</option>
                        <option value="KTTVë„·í”Œë¦­ìŠ¤ HD" data-price="31100" data-category="ë„·í”Œë¦­ìŠ¤ HD" data-stb-included-price="31100">KTTVë„·í”Œë¦­ìŠ¤ HD (267ì±„ë„) (ì›” 31,100ì›)</option>
                        <option value="KTTVë„·í”Œë¦­ìŠ¤ UHD" data-price="34600" data-category="ë„·í”Œë¦­ìŠ¤ UHD" data-stb-included-price="34600">KTTVë„·í”Œë¦­ìŠ¤ UHD (267ì±„ë„) (ì›” 34,600ì›)</option>
                        <option value="KTTVí‚¤ì¦ˆëœë“œíŒ©ì´ˆì´ìŠ¤" data-price="20900" data-category="í‚¤ì¦ˆëœë“œ" data-stb-included-price="20900">KTTVí‚¤ì¦ˆëœë“œíŒ©ì´ˆì´ìŠ¤ (ì›” 20,900ì›)</option>
                    </select>
                </div>

                <div class="input-group">
                    <label for="additionalTvPlan" class="input-label">ì¶”ê°€ TV ì„ íƒ (2ë²ˆì§¸ TV)</label>
                    <select id="additionalTvPlan" class="select-field">
                        <option value="none" data-price="0" data-name="ì„ íƒ ì•ˆí•¨">ì„ íƒ ì•ˆí•¨</option>
                        <option value="KTTV ì¶”ê°€ë² ì´ì§" data-price="10670" data-name="ë² ì´ì§ (236ì±„ë„) + ê¸°ê°€ì§€ë‹ˆA">KTTV ì¶”ê°€ë² ì´ì§ (236ì±„ë„) + ê¸°ê°€ì§€ë‹ˆA (ì›” 10,670ì›)</option>
                        <option value="KTTV ì¶”ê°€ë¼ì´íŠ¸" data-price="11220" data-name="ë¼ì´íŠ¸ (240ì±„ë„) + ê¸°ê°€ì§€ë‹ˆA">KTTV ì¶”ê°€ë¼ì´íŠ¸ (240ì±„ë„) + ê¸°ê°€ì§€ë‹ˆA (ì›” 11,220ì›)</option>
                        <option value="KTTV ì¶”ê°€ì—ì„¼ìŠ¤" data-price="13420" data-name="ì—ì„¼ìŠ¤ (266ì±„ë„) + ê¸°ê°€ì§€ë‹ˆA">KTTV ì¶”ê°€ì—ì„¼ìŠ¤ (266ì±„ë„) + ê¸°ê°€ì§€ë‹ˆA (ì›” 13,420ì›)</option>
                    </select>
                </div>
                
                <div class="input-group">
                    <label for="phonePlan" class="input-label">ì§‘ì „í™” ìš”ê¸ˆì œ</label>
                    <select id="phonePlan" class="select-field">
                        <option value="none">ì„ íƒ ì•ˆí•¨</option>
                        <option value="KTì¼ë°˜ ì „í™”ì¼ë°˜ ì „í™”" data-price="6050">KTì¼ë°˜ ì „í™”ì¼ë°˜ ì „í™” (ì›” 6,050ì›)</option>
                        <option value="KTì¼ë°˜ ì „í™”ì¸í„°ë„· ì „í™” (ëª¨ì„ìŠ¤í†¤)" data-price="5940">KTì¼ë°˜ ì „í™”ì¸í„°ë„· ì „í™” (ëª¨ì„ìŠ¤í†¤) (ì›” 5,940ì›)</option>
                        <option value="KTì¼ë°˜ ì „í™”ì¸í„°ë„· (ë‹¨ë…) 500mb ì´ìƒ + ì¸í„°ë„· ì „í™”" data-price="3850">KTì¼ë°˜ ì „í™”ì¸í„°ë„· (ë‹¨ë…) 500mb ì´ìƒ + ì¸í„°ë„· ì „í™” (ì›” 3,850ì›, íŒ¨ë°€ë¦¬ ì¤‘ë³µë¶ˆê°€)</option>
                    </select>
                </div>
            </div>
            
            <div class="input-group">
                <label class="input-label">KT ë¶€ê°€ì„œë¹„ìŠ¤ (ì„ íƒ)</label>
                <div id="addonServicesContainer" class="grid grid-cols-1 sm:grid-cols-2 gap-2">
                    <label class="flex items-center"><input type="checkbox" name="addonService" value="ê¸°ê°€ì§€ë‹ˆ3A" data-price="1100" class="radio-input mr-2">ê¸°ê°€ì§€ë‹ˆ3A (AI ì…‹í†±ë°•ìŠ¤) (ì›” 1,100ì›)</label>
                    <label class="flex items-center"><input type="checkbox" name="addonService" value="AI ì§€ë‹ˆ TV ì˜¬ì¸ì› ì‚¬ìš´ë“œë°”" data-price="5500" class="radio-input mr-2">AI ì§€ë‹ˆ TV ì˜¬ì¸ì› ì‚¬ìš´ë“œë°” (ì›” 5,500ì›)</label>
                    <label class="flex items-center"><input type="checkbox" name="addonService" value="ë²„ë””ì¦í­ê¸°" data-price="1650" class="radio-input mr-2">ë²„ë””ì¦í­ê¸° (ì›” 1,650ì›)</label>
                    <label class="flex items-center"><input type="checkbox" name="addonService" value="ê¸°ê°€ì§€ë‹ˆ 4A" data-price="3300" class="radio-input mr-2">ê¸°ê°€ì§€ë‹ˆ 4A (ì›” 3,300ì›)</label>
                </div>
            </div>
        </section>

        <section class="mb-8">
             <div class="bg-yellow-50 border-l-4 border-yellow-400 text-yellow-800 p-4 rounded-r-lg shadow">
                <h3 class="font-bold">âœ¨ ì¤‘ìš” ì•ˆë‚´: ê²°í•© í• ì¸ ì‹ ì²­ ë°©ë²•</h3>
                <p class="mt-2 text-sm">
                    ëª¨ë“  ê²°í•© í• ì¸ì€ ì¸í„°ë„· ì„¤ì¹˜ê°€ ì™„ë£Œëœ í›„, <strong class="underline">ê³ ê°ë‹˜ê»˜ì„œ ì§ì ‘ ì´ìš© ì¤‘ì¸ í†µì‹ ì‚¬ ê³ ê°ì„¼í„°(ëª¨ë°”ì¼ 114)ë¡œ ì „í™”</strong>í•˜ì‹œì–´ "ì¸í„°ë„·ê³¼ ëª¨ë°”ì¼(ë˜ëŠ” TV) ê²°í•©í•´ì£¼ì„¸ìš”"ë¼ê³  ìš”ì²­í•˜ì…”ì•¼ ìµœì¢…ì ìœ¼ë¡œ ì ìš©ë©ë‹ˆë‹¤.
                </p>
            </div>
        </section>

        <section id="discountTypeSection" class="mb-8">
            <h2 class="section-title">2. ê²°í•© í• ì¸ ìœ í˜• ì„ íƒ</h2>
            <div class="bg-white p-6 rounded-lg shadow">
                <p class="mb-4 text-sm text-slate-600">ê°€ì¥ ìœ ë¦¬í•œ í• ì¸ ìœ í˜•ì„ ì„ íƒí•˜ê±°ë‚˜, ê° ìœ í˜•ë³„ ì˜ˆìƒ ìš”ê¸ˆì„ ë¹„êµí•´ë³´ì„¸ìš”.</p>
                <div class="grid grid-cols-1 sm:grid-cols-2 gap-x-4 gap-y-2">
                    <label class="radio-label"><input type="radio" name="discountType" value="none" class="radio-input"> ê²°í•© í• ì¸ ì—†ìŒ</label>
                    <div class="flex items-center">
                        <label class="radio-label"><input type="radio" name="discountType" value="totalAmountBundle" class="radio-input" checked> ì´ì•¡ ê²°í•©í• ì¸</label>
                        <label class="toggle-switch">
                            <input type="checkbox" id="totalAmountDetailsToggle">
                            <span class="slider"></span>
                        </label>
                        <span class="ml-1 text-xs text-slate-500">(ìƒì„¸ë³´ê¸°)</span>
                    </div>
                    <div class="flex items-center">
                        <label class="radio-label"><input type="radio" name="discountType" value="premiumFamilyBundle" class="radio-input"> í”„ë¦¬ë¯¸ì—„ ê°€ì¡±ê²°í•©</label>
                        <label class="toggle-switch">
                            <input type="checkbox" id="premiumFamilyDetailsToggle">
                            <span class="slider"></span>
                        </label>
                        <span class="ml-1 text-xs text-slate-500">(ìƒì„¸ë³´ê¸°)</span>
                    </div>
                    <div class="flex items-center">
                        <label class="radio-label"><input type="radio" name="discountType" value="premiumSingleBundle" class="radio-input"> í”„ë¦¬ë¯¸ì—„ ì‹±ê¸€ê²°í•©</label>
                        <label class="toggle-switch">
                            <input type="checkbox" id="premiumSingleDetailsToggle">
                            <span class="slider"></span>
                        </label>
                        <span class="ml-1 text-xs text-slate-500">(ìƒì„¸ë³´ê¸°)</span>
                    </div>
                    <div class="flex items-center">
                        <label class="radio-label"><input type="radio" name="discountType" value="mvnoBundle" class="radio-input"> ì•Œëœ°í° ê²°í•©</label>
                        <label class="toggle-switch">
                            <input type="checkbox" id="mvnoDetailsToggle">
                            <span class="slider"></span>
                        </label>
                        <span class="ml-1 text-xs text-slate-500">(ìƒì„¸ë³´ê¸°)</span>
                    </div>
                    <div class="flex items-center">
                        <label class="radio-label"><input type="radio" name="discountType" value="familyBundle" class="radio-input"> íŒ¨ë°€ë¦¬ ê²°í•© (ì¸í„°ë„· ì¶”ê°€íšŒì„ )</label>
                        <label class="toggle-switch">
                            <input type="checkbox" id="familyBundleDetailsToggle">
                            <span class="slider"></span>
                        </label>
                        <span class="ml-1 text-xs text-slate-500">(ìƒì„¸ë³´ê¸°)</span>
                    </div>
                    <div class="flex items-center">
                        <label class="radio-label"><input type="radio" name="discountType" value="separateFamilyBundle" class="radio-input"> ë”°ë¡œ ì‚´ì•„ë„ ê°€ì¡±ê²°í•©</label>
                        <label class="toggle-switch">
                            <input type="checkbox" id="separateFamilyDetailsToggle">
                            <span class="slider"></span>
                        </label>
                        <span class="ml-1 text-xs text-slate-500">(ìƒì„¸ë³´ê¸°)</span>
                    </div>
                </div>

                <div id="totalAmountDetailsContainer" class="mt-4 hidden discount-details"></div>
                <div id="premiumFamilyDetailsContainer" class="mt-4 hidden discount-details"></div>
                <div id="premiumSingleDetailsContainer" class="mt-4 hidden discount-details"></div>
                <div id="familyBundleDetailsContainer" class="mt-4 hidden discount-details"></div>
                <div id="separateFamilyDetailsContainer" class="mt-4 hidden discount-details"></div>
                <div id="mvnoDetailsContainer" class="mt-4 hidden discount-details"></div>

                <div class="input-group mt-6">
                    <label class="input-label">ëª¨ë°”ì¼ íšŒì„  ì •ë³´ (ìµœëŒ€ 5íšŒì„ )</label>
                    <div class="flex items-center mb-2">
                        <label for="mobileLinesCount" class="mr-2 text-sm text-slate-700">ê²°í•©í•  ëª¨ë°”ì¼ íšŒì„  ìˆ˜:</label>
                        <input type="number" id="mobileLinesCount" min="0" max="5" value="0" class="input-field w-20 text-center">
                    </div>
                    <div id="mobileLinesContainer" class="space-y-3"></div>
                </div>
                <div class="input-group mt-6">
                    <label for="dongpanSalesCheckKt" class="input-label flex items-center cursor-pointer">
                        <input type="checkbox" id="dongpanSalesCheckKt" class="radio-input h-5 w-5 mr-2">
                        KT ë™íŒìœ ì‹¬ íŒë§¤ ì‹œ ì¶”ê°€ ì‚¬ì€í’ˆ ì ìš© ë° ì•ˆë‚´ ë³´ê¸°
                    </label>
                    <div id="dongpanPolicyDetailsContainerKt" class="mt-3 hidden info-box">
                        <h4 class="font-semibold text-sm mb-2">KT ì¸í„°ë„· ìœ ì‹¬ ê°œí†µ ì ˆì°¨ ì•ˆë‚´ (ìƒë‹´ì› ì°¸ê³ ìš©)</h4>
                        <p class="text-xs mb-1"><strong>ì‹ ì²­ ë° ì¸ì¦:</strong></p>
                        <ul class="list-disc list-inside text-xs space-y-0.5 mb-2">
                            <li>KT ì¸í„°ë„· ìœ ì‹¬ ê°œí†µ ì‹ ì²­ì„œ ë§í¬: <a href="http://online.kt.com/index.jsp?prdcID=6C463388-3BDF-4E68-BE73-975E05BDA182" target="_blank" class="text-blue-700 font-bold hover:text-blue-800 underline text-lg">ë°”ë¡œê°€ê¸°</a> (PASS ë˜ëŠ” ì‹ ìš©ì¹´ë“œ ì¸ì¦ í•„ìš”)</li>
                            <li>KT ë™íŒ ê²°í•© ë³¸ì¸ì¸ì¦ ë§í¬ (ê²°í•©ë§Œ ì²´í¬): <a href="https://online.kt.com/smart/simple/simpleCustomerInfoPop.do?prdcId=65278B4C-20F1-47FA-9EEF-56E9B574D346" target="_blank" class="text-blue-600 hover:underline font-semibold">ë°”ë¡œê°€ê¸°</a></li>
                        </ul>
                        <p class="text-xs mb-1"><strong>ê²°í•© ê°€ëŠ¥ íšŒì„ :</strong> ì¸í„°ë„· + ìœ ì‹¬ ë™íŒ + ê°€ì¡± ìœ ì‹¬ 2íšŒì„  (ì´ 3íšŒì„ ê¹Œì§€ ê°€ëŠ¥)</p>
                        <p class="text-xs mb-1"><strong>ì ‘ìˆ˜ ê³¼ì •:</strong> ë°±ë©”ê°€ ì ‘ìˆ˜ì›¹(speedonline.kr) KT(ì¼ë°˜) > ëª¨ë°”ì¼ íƒ­ìœ¼ë¡œ ì ‘ìˆ˜</p>
                        <p class="text-xs mb-1"><strong>ì ‘ìˆ˜ ì‹œ í•„ìˆ˜ ê¸°ì¬ ì‚¬í•­ (ê¸°íƒ€ë©”ëª¨ ì–‘ì‹):</strong></p>
                        <ul class="list-disc list-inside text-xs space-y-0.5 mb-2">
                            <li>ì¸í„°ë„· ê°œí†µ ì™„ë£Œ ì‹œ: "[ê°œí†µ ì™„ë£Œ / ìœ ì‹¬ ë°œì†¡ ìš”ì²­]"</li>
                            <li>ì´ë¯¸ ê°œí†µëœ ê³ ê° 30ì¼ ì´ë‚´ ë™íŒ ì‹œ: "[ê°œí†µì™„ë£Œ ì¼ì, ê°œí†µë²ˆí˜¸ ê¸°ì¬ / ìœ ì‹¬ ë°œì†¡ ìš”ì²­]"</li>
                            <li>ê³ ê° ìœ ì‹¬ ìˆ˜ë ¹ í›„ ê°œí†µ ìš”ì²­ ì‹œ: "[ê³ ê° ìœ ì‹¬ ìˆ˜ë ¹ ì™„ë£Œ / ê°œí†µ ì§„í–‰ ìš”ì²­]"</li>
                        </ul>
                        <p class="text-xs mb-1"><strong>ê°œí†µ ì§„í–‰ ë° ìœ ì˜ì‚¬í•­:</strong></p>
                        <ul class="list-disc list-inside text-xs space-y-0.5 mb-2">
                            <li>ê³ ê°ì—ê²Œ ìœ„ì•½ê¸ˆ í™•ì¸ ë° ë™ì˜ ë¬¸ì ë°œì†¡ í›„ ì²˜ë¦¬. ë¯¸ë™ì˜ ì‹œ 10ë¶„ í›„ ê°•ì œ ë™ì˜ ì²˜ë¦¬ ê°€ëŠ¥.</li>
                            <li>USIM êµì²´ ë° ì „ì› ON ì„±ê³µ í›„ ì„ íƒì•½ì • ë° ìœ ë¬´ì„  ê²°í•© í•„ìˆ˜ (ì™„ë£Œ ì‹œ ê°œí†µ ì™„ë£Œ ì²˜ë¦¬).</li>
                            <li>ìœ ì‹¬ ê°œí†µ ìµœëŒ€ 4ì‹œê°„ ì†Œìš” ê°€ëŠ¥. ì‚¬ì „ ë™ì˜ ë¬¸ì ì²˜ë¦¬ ì‹œ ë¹ ë¥¸ ê°œí†µ.</li>
                            <li>KT USIM ê°œí†µ ì „ê¹Œì§€ ê¸°ì¡´ USIM ì‚¬ìš©, ì‹ í˜¸ ëŠê¸°ë©´ êµì²´. ê¸°ê¸° ìˆ˜íšŒ ì¬ì‹œë™ í•„ìš”.</li>
                        </ul>
                        <p class="text-xs mb-1"><strong>ë¹„ìš© ë° ìˆ˜ìˆ˜ë£Œ ì£¼ì˜ì‚¬í•­:</strong></p>
                        <ul class="list-disc list-inside text-xs space-y-0.5">
                            <li>ìœ ì‹¬ ë‹¹ì¼ ë°œì†¡ ë§ˆê° 15ì‹œ.</li>
                            <li>ìœ ì‹¬ ë¹„ìš© 7,700ì› / ë²ˆí˜¸ì´ë™ ìˆ˜ìˆ˜ë£Œ 800ì› ì²« ë‹¬ ì²­êµ¬.</li>
                            <li>ì¸í„°ë„·/ìœ ì‹¬ ì¤‘ í•˜ë‚˜ë¼ë„ ì„¤ì¹˜/ê°œí†µ ë¶ˆê°€ ì‹œ ìˆ˜ìˆ˜ë£Œ ì§€ê¸‰ ë¶ˆê°€.</li>
                            <li>ì¸í„°ë„· ê°œí†µì›” ê¸°ì¤€ ìµì›” ë§ê¹Œì§€ ìœ ì‹¬ ê°œí†µ ì‹œ ìˆ˜ìˆ˜ë£Œ ì¸ì •.</li>
                            <li>ì„ íƒì•½ì • ë¯¸ì ìš© ì‹œ ìˆ˜ìˆ˜ë£Œ ì§€ê¸‰ ë¶ˆê°€.</li>
                            <li>ì¸í„°ë„·/ìœ ì‹¬ ëª…ì˜ì ìƒì´í•´ë„ ìœ ì‹¬ ìˆ˜ìˆ˜ë£Œ ì§€ê¸‰ ê°€ëŠ¥.</li>
                        </ul>
                    </div>
                </div>
            </div>
        </section>
        
        <section id="displayModeSectionKt" class="mb-8">
            <h2 class="section-title">ê²°ì œê¸ˆì•¡ í‘œì‹œ ë°©ì‹ ì„ íƒ</h2>
            <div class="bg-white p-6 rounded-lg shadow">
                <label class="radio-label">
                    <input type="radio" name="displayModeKt" value="preApplied" class="radio-input" checked>
                    ì„ ê²°í•© ê¸°ì¤€ (í• ì¸ì´ ì ìš©ëœ ìµœì¢… ì›” ë‚©ë¶€ì•¡)
                </label>
                <label class="radio-label">
                    <input type="radio" name="displayModeKt" value="postApplied" class="radio-input">
                    í›„ê²°í•© ê¸°ì¤€ (í• ì¸ì´ ì ìš©ë˜ê¸° ì „ ì´ ì„œë¹„ìŠ¤ ì›” ê¸°ë³¸ë£Œ)
                </label>
            </div>
        </section>

        <section id="installationSection" class="mb-8">
            <h2 class="section-title">3. ì„¤ì¹˜ ì˜µì…˜</h2>
            <div class="input-group bg-white p-6 rounded-lg shadow">
                <label class="input-label">ì„¤ì¹˜ í¬ë§ ì‹œì  (ì„¤ì¹˜ë¹„ ë³€ë™)</label>
                <div class="space-y-2">
                    <label class="radio-label"><input type="radio" name="installationTime" value="weekday" class="radio-input" checked> í‰ì¼ ì£¼ê°„</label>
                    <label class="radio-label"><input type="radio" name="installationTime" value="weekend" class="radio-input"> ì£¼ë§/ì•¼ê°„ (í• ì¦ ì ìš©)</label>
                </div>
            </div>
        </section>

        <div class="text-center mb-8 flex justify-center items-center">
            <button id="calculateButton" class="btn-primary text-lg">ì˜ˆìƒ ìš”ê¸ˆ ê³„ì‚°í•˜ê¸°</button>
            <button id="resetButton" class="btn-secondary text-lg ml-4">ì´ˆê¸°í™”</button>
        </div>

        <section id="resultSection" class="hidden">
            <h2 class="section-title">ğŸ“Š ê³„ì‚° ê²°ê³¼</h2>
            
            <div class="result-card">
                <h3 class="text-xl font-semibold text-sky-600 mb-4">âœ… ìµœì¢… ìš”ê¸ˆ ë° í˜œíƒ ìš”ì•½</h3>
                <div class="grid grid-cols-2 gap-6 text-center">
                    <div class="bg-slate-50 p-4 rounded-lg">
                        <p class="text-sm text-slate-600">ğŸ–¥ï¸ ì¸í„°ë„·/TV ì›” ìµœì¢… ìš”ê¸ˆ</p>
                        <p id="summaryPreDiscountCost" class="text-sm text-slate-500" style="display: none;"></p>
                        <p id="summaryFinalCost" class="text-3xl font-bold text-red-600 my-2">0 ì›</p>
                    </div>
                    <div class="bg-green-50 p-4 rounded-lg">
                        <p class="text-sm text-slate-600">ğŸ ì´ ì‚¬ì€í’ˆ í˜œíƒ</p>
                        <p id="summaryGiftTotal" class="text-3xl font-bold text-green-700 my-2">0 ì›</p>
                    </div>
                    <div class="bg-slate-50 p-4 rounded-lg">
                        <p class="text-sm text-slate-600">ğŸ“‰ ì¸í„°ë„· ìš”ê¸ˆ í• ì¸</p>
                        <p id="summaryInternetDiscount" class="text-xl font-bold text-sky-600 my-2">0 ì›</p>
                    </div>
                    <div class="bg-green-50 p-4 rounded-lg">
                        <p class="text-sm text-slate-600">ğŸ“± íœ´ëŒ€í° ìš”ê¸ˆ í• ì¸</p>
                        <p id="summaryMobileDiscount" class="text-xl font-bold text-green-700 my-2">0 ì›</p>
                    </div>
                </div>
            </div>

            <!-- ê³ ê°ìš© ìƒë‹´ ë²„íŠ¼ ì„¹ì…˜ -->
            <div id="customerConsultSection" class="result-card hidden">
                <h3 class="text-xl font-semibold text-sky-600 mb-4">ğŸ’¬ ì´ ê²°ê³¼ë¡œ ìƒë‹´í•˜ê¸°</h3>
                <p class="text-sm text-slate-600 mb-4">ê³„ì‚° ê²°ê³¼ë¥¼ ì „ë¬¸ê°€ì—ê²Œ ë³´ë‚´ê³  ë°”ë¡œ ìƒë‹´ì„ ì‹œì‘í•˜ì„¸ìš”!</p>
                <div class="flex flex-col sm:flex-row gap-4">
                    <a id="kakaoBtn" href="#" target="_blank" class="flex-1 text-center font-bold py-3 px-4 rounded-lg bg-[#FEE500] text-[#191919] hover:opacity-90 transition-opacity">
                        ì¹´ì¹´ì˜¤í†¡ìœ¼ë¡œ ë³´ë‚´ê¸°
                    </a>
                    <a id="smsBtn" href="#" class="flex-1 text-center font-bold py-3 px-4 rounded-lg bg-slate-700 text-white hover:bg-slate-800 transition-colors">
                        ë¬¸ì ë©”ì‹œì§€ë¡œ ë³´ë‚´ê¸°
                    </a>
                </div>
            </div>
            
            <div class="text-center mt-6">
                <button id="toggleDetailsButton" class="text-sm text-slate-500 hover:text-sky-600 bg-slate-100 px-4 py-2 rounded-full">
                    ìƒì„¸ ìš”ê¸ˆ ë‚´ì—­ í¼ì³ë³´ê¸° â–¼
                </button>
            </div>


            <div id="expandedDetailsContainer" class="hidden mt-6">
                <div class="result-card">
                    <h3 class="text-2xl font-bold text-blue-700 mb-4">ğŸ“‹ ìƒì„¸ ìš”ê¸ˆ ë‚´ì—­</h3>
                    <div class="grid grid-cols-2 gap-x-4 gap-y-1 text-sm">
                        <p><strong>ì„ íƒ ì¸í„°ë„·:</strong> <span id="selectedInternet"></span></p>
                        <p><strong>ëª¨ë°”ì¼ íšŒì„  ìˆ˜:</strong> <span id="selectedMobileCount"></span></p>
                        <p><strong>ì„ íƒ TV (1ë²ˆì§¸):</strong> <span id="selectedTv"></span></p>
                        <p><strong>ì ìš© í• ì¸ ìœ í˜•:</strong> <span id="selectedDiscountType"></span></p>
                        <p><strong>ì„ íƒ ì¶”ê°€ TV (2ë²ˆì§¸):</strong> <span id="selectedAdditionalTv"></span></p>
                        <p><strong>ì„ íƒ ì§‘ì „í™”:</strong> <span id="selectedPhone"></span></p>
                        <p><strong>ì„ íƒ ì™€ì´íŒŒì´:</strong> <span id="selectedWifi"></span></p>
                        <div></div> <div class="col-span-2" id="selectedWifiDetails"></div> 
                    </div>
                </div>

                <div class="result-card">
                    <h3 class="text-lg font-semibold text-blue-700 mb-3">ğŸ–¥ï¸ ì¸í„°ë„·/TV ìš”ê¸ˆ ê³„ì‚° ê³¼ì •</h3>
                    <div class="space-y-2 text-sm">
                        <div class="flex justify-between"><span>ì›” ì¸í„°ë„· ê¸°ë³¸ë£Œ (ë‹¨ë…/TVê²°í•© ê¸°ì¤€)</span><span id="detailInternetBase">0 ì›</span></div>
                        <div class="flex justify-between"><span>ì›” ì™€ì´íŒŒì´ ê³µìœ ê¸° ì„ëŒ€ë£Œ</span><span id="detailWifiFee">0 ì›</span></div>
                        <div class="flex justify-between text-green-600"><span>ì›” ì´ ì¸í„°ë„· ê²°í•© í• ì¸ì•¡ (ì˜ˆìƒ)</span><span id="detailInternetDiscountTotal">0 ì›</span></div>
                        <hr class="my-2">
                        <div class="flex justify-between font-bold text-base"><span>ìµœì¢… ì˜ˆìƒ ì›” ë‚©ë¶€ì•¡ (í• ì¸ ì ìš©)</span><span id="detailFinalCost" class="text-red-600">0 ì›</span></div>
                    </div>
                </div>

                <div class="result-card">
                    <h3 class="text-lg font-semibold text-blue-700 mb-3">ğŸ“± ëª¨ë°”ì¼ ìš”ê¸ˆ í• ì¸ ìƒì„¸</h3>
                    <div id="mobileDiscountDetailContainer" class="p-3 bg-blue-50 rounded-md text-sm">
                        <p>ê²°í•© ìœ í˜•ì— ë”°ë¥¸ ëª¨ë°”ì¼ í• ì¸ ë‚´ì—­ì´ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤.</p>
                    </div>
                </div>

                <div class="result-card">
                    <h3 class="text-lg font-semibold text-blue-700 mb-3">ğŸ ì‚¬ì€í’ˆ í˜œíƒ ìƒì„¸</h3>
                    <div class="space-y-2 text-sm">
                        <div class="flex justify-between"><span>ê¸°ë³¸ ì‚¬ì€í’ˆ (í˜„ê¸ˆ)</span><span id="giftCash">0 ì›</span></div>
                        <div class="flex justify-between"><span>ê¸°ë³¸ ì‚¬ì€í’ˆ (ìƒí’ˆê¶Œ)</span><span id="giftVoucher">0 ì›</span></div>
                        <div class="flex justify-between"><span>ì¼ë°˜ì „í™” ì¶”ê°€ ìƒí’ˆê¶Œ</span><span id="giftPhoneVoucher">0 ì›</span></div>
                        <div class="flex justify-between"><span>ì¶”ê°€ TV ì‚¬ì€í’ˆ (í˜„ê¸ˆ)</span><span id="giftAdditionalTv">0 ì›</span></div>
                        <div id="dongpanCashContainerKt" class="flex justify-between hidden"><span>ë™íŒ ì¶”ê°€ í˜„ê¸ˆ ì‚¬ì€í’ˆ (KT)</span><span id="giftDongpanAdditionalCashKt">0 ì›</span></div>
                        <hr class="my-2">
                        <div class="flex justify-between font-bold text-base"><span>ì´ ì‚¬ì€í’ˆ ê°€ì¹˜ (ì˜ˆìƒ)</span><span id="giftTotal" class="text-green-700">0 ì›</span></div>
                    </div>
                </div>
            </div>
            
            <section id="installationFeeSection" class="hidden">
                 <div class="result-card">
                    <h3 class="text-lg font-semibold text-blue-700 mb-3">âš™ï¸ ì„¤ì¹˜ë¹„ (ì²« ë‹¬ 1íšŒ ì²­êµ¬)</h3>
                    <div class="text-center">
                        <p id="installationFeeResult" class="text-2xl font-bold text-slate-800 my-2">0 ì›</p>
                        <p id="installationFeeDescription" class="text-sm text-slate-500"></p>
                    </div>
                </div>
            </section>
        </section>
    </main>

    <footer class="text-center p-6 mt-12 bg-sky-800 text-sky-200 text-sm">
        <p>ë³¸ ê³„ì‚°ê¸°ëŠ” KT ë¯¸ì†Œì—ì„œ ì œê³µí•©ë‹ˆë‹¤.</p>
        <p>&copy; 2024 KT ê²°í•© í• ì¸ ê³„ì‚°ê¸°. ëª¨ë“  ì •ë³´ëŠ” ì°¸ê³ ìš©ì…ë‹ˆë‹¤.</p>
    </footer>

    <script>
    // --- âš™ï¸ ì‚¬ì¥ë‹˜ ì •ë³´ ë° ë°ì´í„° ---
    const myPhoneNumber = '01042978846'; // ìƒë‹´ì› ì „í™”ë²ˆí˜¸
    const kakaoChannelId = '_xkxnjxG';   // ì¹´ì¹´ì˜¤í†¡ ì±„ë„ ID (_ë¶€í„° ì‹œì‘í•˜ëŠ” ì˜ë¬¸)

    // --- ë‚˜ë¨¸ì§€ ë°ì´í„°(ìš”ê¸ˆí‘œ ë“±)ëŠ” ê·¸ëŒ€ë¡œ ìœ ì§€ ---
    const internetPlans_KT = {
        "KTì¸í„°ë„·(ë‹¨ë…) 100mb": { basePrice: 22000, speed: 100, type: "100M" },
        "KTì¸í„°ë„·(ë‹¨ë…) 500mb": { basePrice: 33000, speed: 500, type: "500M" },
        "KTì¸í„°ë„·(ë‹¨ë…) 1GB": { basePrice: 38500, speed: 1000, type: "1G" },
        "KTì¸í„°ë„·ë²ˆë“¤100mb": { basePrice: 22000, speed: 100, type: "100M" },
        "KTì¸í„°ë„·ë²ˆë“¤500mb": { basePrice: 27500, speed: 500, type: "500M" },
        "KTì¸í„°ë„·ë²ˆë“¤1GB": { basePrice: 33000, speed: 1000, type: "1G" }
    };
    const tvPlans_KT = {
        "KTTVë² ì´ì§": { basePrice: 15400, category: "ë² ì´ì§", stbIncluded: "ê¸°ê°€ì§€ë‹ˆA" },
        "KTTVë¼ì´íŠ¸": { basePrice: 16500, category: "ë¼ì´íŠ¸", stbIncluded: "ê¸°ê°€ì§€ë‹ˆA" },
        "KTTVì—ì„¼ìŠ¤": { basePrice: 19800, category: "ì—ì„¼ìŠ¤", stbIncluded: "ê¸°ê°€ì§€ë‹ˆA" },
        "KTTVì—ì„¼ìŠ¤ í”ŒëŸ¬ìŠ¤": { basePrice: 24200, category: "ì—ì„¼ìŠ¤ í”ŒëŸ¬ìŠ¤", stbIncluded: "ê¸°ê°€ì§€ë‹ˆA" },
        "KTTVë„·í”Œë¦­ìŠ¤ HD": { basePrice: 31100, category: "ë„·í”Œë¦­ìŠ¤ HD", stbIncluded: "ê¸°ê°€ì§€ë‹ˆA" },
        "KTTVë„·í”Œë¦­ìŠ¤ UHD": { basePrice: 34600, category: "ë„·í”Œë¦­ìŠ¤ UHD", stbIncluded: "ê¸°ê°€ì§€ë‹ˆA" },
        "KTTVí‚¤ì¦ˆëœë“œíŒ©ì´ˆì´ìŠ¤": { basePrice: 20900, category: "í‚¤ì¦ˆëœë“œ", stbIncluded: "ê¸°ê°€ì§€ë‹ˆA" }
    };
    const additionalTvPlans_KT = {
        "none": { basePrice: 0, name: "ì„ íƒ ì•ˆí•¨" },
        "KTTV ì¶”ê°€ë² ì´ì§": { basePrice: 10670, name: "ë² ì´ì§ (236ì±„ë„) + ê¸°ê°€ì§€ë‹ˆA" },
        "KTTV ì¶”ê°€ë¼ì´íŠ¸": { basePrice: 11220, name: "ë¼ì´íŠ¸ (240ì±„ë„) + ê¸°ê°€ì§€ë‹ˆA" },
        "KTTV ì¶”ê°€ì—ì„¼ìŠ¤": { basePrice: 13420, name: "ì—ì„¼ìŠ¤ (266ì±„ë„) + ê¸°ê°€ì§€ë‹ˆA" }
    };
    const phonePlans_KT = {
        "KTì¼ë°˜ ì „í™”ì¼ë°˜ ì „í™”": { basePrice: 6050 },
        "KTì¼ë°˜ ì „í™”ì¸í„°ë„· ì „í™” (ëª¨ì„ìŠ¤í†¤)": { basePrice: 5940 },
        "KTì¼ë°˜ ì „í™”ì¸í„°ë„· (ë‹¨ë…) 500mb ì´ìƒ + ì¸í„°ë„· ì „í™”": { basePrice: 3850 }
    };
    const wifiOptions_KT = {
        "KTê³µìœ ê¸°": { fee: 1100, name: "KTê³µìœ ê¸°", url: null, promotion: null },
        "GiGA WiFi home ax": { fee: 0, name: "GiGA WiFi home ax (í”„ë¡œëª¨ì…˜)", url: "https://product.kt.com/wDic/productDetail.do?ItemCode=1401", promotion: "'ë² ì´ì§(500Mbps)' ìš”ê¸ˆì œ ì‹ ê·œ ê°€ì… ì‹œ ë¬´ë£Œ ì œê³µ" },
        "KT WiFi 7D": { fee: 0, name: "KT WiFi 7D (í”„ë¡œëª¨ì…˜)", url: "https://product.kt.com/wDic/productDetail.do?ItemCode=1633", promotion: "'ì—ì„¼ìŠ¤(1Gbps)' ì´ìƒ ìš”ê¸ˆì œ ì‹ ê·œ ê°€ì… ì‹œ ë¬´ë£Œ ì œê³µ (25ë…„ 8/31ê¹Œì§€, ì„ ì°©ìˆœ 5ë§Œëª…)" },
        "KTê³µìœ ê¸° X": { fee: 0, name: "KTê³µìœ ê¸° X (ë¯¸ì‚¬ìš©)", url: null, promotion: null }
    };
    const ktAddonServices = {
        "ê¸°ê°€ì§€ë‹ˆ3A": { price: 1100, name: "ê¸°ê°€ì§€ë‹ˆ3A (AI ì…‹í†±ë°•ìŠ¤)"},
        "AI ì§€ë‹ˆ TV ì˜¬ì¸ì› ì‚¬ìš´ë“œë°”": { price: 5500, name: "AI ì§€ë‹ˆ TV ì˜¬ì¸ì› ì‚¬ìš´ë“œë°”"},
        "ë²„ë””ì¦í­ê¸°": { price: 1650, name: "ë²„ë””ì¦í­ê¸°"},
        "ê¸°ê°€ì§€ë‹ˆ 4A": { price: 3300, name: "ê¸°ê°€ì§€ë‹ˆ 4A"}
    };
    const mobilePlans_KT = [
        { "category": "90K", "name": "ë””ì¦ˆë‹ˆ+ ì´ˆì´ìŠ¤ ìŠ¤í˜ì…œ", "network": "5G", "price": 110000, "url": "https://product.kt.com/wDic/productDetail.do?ItemCode=1470" },
        { "category": "90K", "name": "(ìœ íŠœë¸Œ í”„ë¦¬ë¯¸ì—„) ì´ˆì´ìŠ¤ ìŠ¤í˜ì…œ", "network": "5G", "price": 110000, "url": "https://product.kt.com/wDic/productDetail.do?ItemCode=1499" },
        { "category": "90K", "name": "ë„·í”Œë¦­ìŠ¤ ì´ˆì´ìŠ¤ ìŠ¤í˜ì…œ", "network": "5G", "price": 110000, "url": "https://product.kt.com/wDic/simple/mNetflixMain.do" },
        { "category": "90K", "name": "í‹°ë¹™/ì§€ë‹ˆ/ë°€ë¦¬ ì´ˆì´ìŠ¤ ìŠ¤í˜ì…œ", "network": "5G", "price": 110000, "url": "https://product.kt.com/wDic/productDetail.do?ItemCode=1601" },
        { "category": "90K", "name": "ë„·í”Œë¦­ìŠ¤ ì´ˆì´ìŠ¤ ë² ì´ì§", "network": "5G", "price": 90000, "url": "https://product.kt.com/wDic/simple/mNetflixMain.do" },
        { "category": "90K", "name": "í‹°ë¹™/ì§€ë‹ˆ/ë°€ë¦¬ ì´ˆì´ìŠ¤ ë² ì´ì§", "network": "5G", "price": 90000, "url": "https://product.kt.com/wDic/productDetail.do?ItemCode=1601" },
        { "category": "90K", "name": "ë””ì¦ˆë‹ˆ+ ì´ˆì´ìŠ¤ ë² ì´ì§", "network": "5G", "price": 90000, "url": "https://product.kt.com/wDic/productDetail.do?ItemCode=1470" },
        { "category": "90K", "name": "(ìœ íŠœë¸Œ í”„ë¦¬ë¯¸ì—„) ì´ˆì´ìŠ¤ ë² ì´ì§", "network": "5G", "price": 90000, "url": "https://product.kt.com/wDic/productDetail.do?ItemCode=1499" },
        { "category": "61K", "name": "ë°ì´í„°ON í”„ë¦¬ë¯¸ì—„", "network": "LTE", "price": 89000, "url": "https://product.kt.com/wDic/productDetail.do?ItemCode=1248" },
        { "category": "61K", "name": "ë² ì´ì§", "network": "5G", "price": 80000, "url": "https://product.kt.com/wDic/productDetail.do?ItemCode=1283" },
        { "category": "61K", "name": "5G ì‹¬í”Œ 110GB", "network": "5G", "price": 69000, "url": "https://product.kt.com/wDic/productDetail.do?ItemCode=1406&CateCode=6002&filter_code=81&option_code=109&pageSize=10" },
        { "category": "61K", "name": "ë°ì´í„°ON ë¹„ë””ì˜¤ í”ŒëŸ¬ìŠ¤", "network": "LTE", "price": 69000, "url": "https://product.kt.com/wDic/productDetail.do?ItemCode=1248" },
        { "category": "61K", "name": "5G ì‹¬í”Œ 90GB", "network": "5G", "price": 67000, "url": "https://product.kt.com/wDic/productDetail.do?ItemCode=1406&CateCode=6002&filter_code=81&option_code=109&pageSize=10" },
        { "category": "61K", "name": "5G ì‹¬í”Œ 70GB", "network": "5G", "price": 65000, "url": "https://product.kt.com/wDic/productDetail.do?ItemCode=1406&CateCode=6002&filter_code=81&option_code=109&pageSize=10" },
        { "category": "61K", "name": "5G ì‹¬í”Œ 50GB", "network": "5G", "price": 63000, "url": "https://product.kt.com/wDic/productDetail.do?ItemCode=1406&CateCode=6002&filter_code=81&option_code=109&pageSize=10" },
        { "category": "61K", "name": "5G ì‹¬í”Œ 30GB", "network": "5G", "price": 61000, "url": "https://product.kt.com/wDic/productDetail.do?ItemCode=1406&CateCode=6002&filter_code=81&option_code=109&pageSize=10" },
        { "category": "37K", "name": "5G ìŠ¬ë¦¼ 21GB", "network": "5G", "price": 58000, "url": "https://product.kt.com/wDic/productDetail.do?ItemCode=1284&CateCode=6002&filter_code=81&option_code=109&pageSize=10" },
        { "category": "37K", "name": "5G ìŠ¬ë¦¼ 21GB (ì´ì›”)", "network": "5G", "price": 58000, "url": "https://product.kt.com/wDic/productDetail.do?ItemCode=1284&CateCode=6002&filter_code=81&option_code=109&pageSize=10" },
        { "category": "37K", "name": "5G ìŠ¬ë¦¼ 14GB", "network": "5G", "price": 55000, "url": "https://product.kt.com/wDic/productDetail.do?ItemCode=1284&CateCode=6002&filter_code=81&option_code=109&pageSize=10" },
        { "category": "37K", "name": "5G ìŠ¬ë¦¼ 14GB (ì´ì›”)", "network": "5G", "price": 55000, "url": "https://product.kt.com/wDic/productDetail.do?ItemCode=1284&CateCode=6002&filter_code=81&option_code=109&pageSize=10" },
        { "category": "37K", "name": "5G ìŠ¬ë¦¼ 10GB", "network": "5G", "price": 50000, "url": "https://product.kt.com/wDic/productDetail.do?ItemCode=1284&CateCode=6002&filter_code=81&option_code=109&pageSize=10" },
        { "category": "37K", "name": "5G ìŠ¬ë¦¼ 10GB (ì´ì›”)", "network": "5G", "price": 50000, "url": "https://product.kt.com/wDic/productDetail.do?ItemCode=1284&CateCode=6002&filter_code=81&option_code=109&pageSize=10" },
        { "category": "37K", "name": "5G ì‹œë‹ˆì–´ ë² ì´ì§", "network": "5G", "price": 49000, "url": "https://product.kt.com/wDic/productDetail.do?ItemCode=1558&CateCode=6002&filter_code=81&option_code=109&pageSize=10" },
        { "category": "37K", "name": "5G ìŠ¬ë¦¼ 7GB", "network": "5G", "price": 45000, "url": "https://product.kt.com/wDic/productDetail.do?ItemCode=1284&CateCode=6002&filter_code=81&option_code=109&pageSize=10" },
        { "category": "37K", "name": "5G ìŠ¬ë¦¼ 7GB (ì´ì›”)", "network": "5G", "price": 45000, "url": "https://product.kt.com/wDic/productDetail.do?ItemCode=1284&CateCode=6002&filter_code=81&option_code=109&pageSize=10" },
        { "category": "37K", "name": "5G ì‹œë‹ˆì–´ Aí˜•", "network": "5G", "price": 44000, "url": "https://product.kt.com/wDic/productDetail.do?ItemCode=1558&CateCode=6002&filter_code=81&option_code=109&pageSize=10" },
        { "category": "37K", "name": "5G ì‹œë‹ˆì–´ Bí˜•", "network": "5G", "price": 42000, "url": "https://product.kt.com/wDic/productDetail.do?ItemCode=1558&CateCode=6002&filter_code=81&option_code=109&pageSize=10" },
        { "category": "37K", "name": "5G ì‹œë‹ˆì–´ Cí˜•", "network": "5G", "price": 41000, "url": "https://product.kt.com/wDic/productDetail.do?ItemCode=1558&CateCode=6002&filter_code=81&option_code=109&pageSize=10" },
        { "category": "37K", "name": "5G ìŠ¬ë¦¼ 5GB", "network": "5G", "price": 37000, "url": "https://product.kt.com/wDic/productDetail.do?ItemCode=1284&CateCode=6002&filter_code=81&option_code=109&pageSize=10" },
        { "category": "37K", "name": "5G ìŠ¬ë¦¼ 4GB (ì´ì›”)", "network": "5G", "price": 37000, "url": "https://product.kt.com/wDic/productDetail.do?ItemCode=1284&CateCode=6002&filter_code=81&option_code=109&pageSize=10" }
    ].sort((a, b) => b.price - a.price);
    const newKtDiscountRules = {
        "ì´ì•¡ê²°í•©í• ì¸": {
            "100M": {
                "ë‹¨ë…": {"ëª¨ë°”ì¼_22000ë¯¸ë§Œ": 1650, "ëª¨ë°”ì¼_64900ë¯¸ë§Œ": 3300, "ëª¨ë°”ì¼_64900ì´ìƒ": 5500},
                "TV":   {"ëª¨ë°”ì¼_22000ë¯¸ë§Œ": 1650, "ëª¨ë°”ì¼_64900ë¯¸ë§Œ": 3300, "ëª¨ë°”ì¼_64900ì´ìƒ": 5500}
            },
            "500M": {
                "ë‹¨ë…": {"ëª¨ë°”ì¼_22000ë¯¸ë§Œ": 7700, "ëª¨ë°”ì¼_22000ì´ìƒ": 11000},
                "TV":   {"ëª¨ë°”ì¼_22000ë¯¸ë§Œ": 2200, "ëª¨ë°”ì¼_22000ì´ìƒ": 5500}
            },
            "1G": {
                "ë‹¨ë…": {"ëª¨ë°”ì¼_22000ë¯¸ë§Œ": 7700, "ëª¨ë°”ì¼_22000ì´ìƒ": 11000},
                "TV":   {"ëª¨ë°”ì¼_ê²°í•©ì‹œ": 5500}
            }
        },
        "í”„ë¦¬ë¯¸ì—„ê°€ì¡±ê²°í•©": { "500M_TV": 5500, "1G_TV": 5500, "500M_ë‹¨ë…": 5500, "1G_ë‹¨ë…": 11000 },
        "í”„ë¦¬ë¯¸ì—„ì‹±ê¸€ê²°í•©": { "500M_ë‹¨ë…": 5500, "1G_ë‹¨ë…": 5500 },
        "íŒ¨ë°€ë¦¬ê²°í•©": { "100M_TV": 5500, "100M_ë‹¨ë…": 5500, "500M_TV": 5500, "500M_ë‹¨ë…": 11000, "1G_TV": 5500, "1G_ë‹¨ë…": 11000 },
        "ì•Œëœ°í°ê²°í•©": { "100M_TV": 3300, "100M_ë‹¨ë…": 3300, "500M_TV": 5500, "500M_ë‹¨ë…": 11000, "1G_TV": 5500, "1G_ë‹¨ë…": 11000 },
        "ë”°ë¡œì‚´ì•„ë„ ê°€ì¡±ê²°í•©": {
            "500M_TV": { "ëª¨ë°”ì¼_22000ë¯¸ë§Œ": 9900, "ëª¨ë°”ì¼_22000ì´ìƒ": 13200, "tvDiscount": 2200 },
            "1G_TV": { "ëª¨ë°”ì¼_22000ë¯¸ë§Œ": 11000, "ëª¨ë°”ì¼_22000ì´ìƒ": 14300, "tvDiscount": 3300 }
        }
    };
    const dongpanAdditionalGiftTable_KT = {
        "37K": { "100M_ë‹¨ë…": 150000, "500M_ë‹¨ë…": 160000, "1G_ë‹¨ë…": 170000, "100M_TVë²ˆë“¤": 200000, "500M_TVë²ˆë“¤": 220000, "1G_TVë²ˆë“¤": 240000 },
        "61K": { "100M_ë‹¨ë…": 270000, "500M_ë‹¨ë…": 280000, "1G_ë‹¨ë…": 290000, "100M_TVë²ˆë“¤": 320000, "500M_TVë²ˆë“¤": 340000, "1G_TVë²ˆë“¤": 360000 },
        "90K": { "100M_ë‹¨ë…": 310000, "500M_ë‹¨ë…": 320000, "1G_ë‹¨ë…": 330000, "100M_TVë²ˆë“¤": 360000, "500M_TVë²ˆë“¤": 380000, "1G_TVë²ˆë“¤": 400000 }
    };
    const ktInstallationFees_new = {
        "í‰ì¼": { "ì¸í„°ë„·": 36000, "ì¸í„°ë„·+TV": 56200, "ì¸í„°ë„·+ì¼ë°˜ì „í™”": 68000, "ì¸í„°ë„·+070ì „í™”": 60000, "ì¸í„°ë„·+TV+ì¼ë°˜ì „í™”": 88200, "ì¸í„°ë„·+TV+070ì „í™”": 80200, "ì¸í„°ë„·+TV+TVì¶”ê°€": 71600 },
        "ì£¼ë§": { "ìœ íš¨ê¸°ê°„": "25.06.29ê¹Œì§€ í• ì¦ ì—†ìŒ", "ì¸í„°ë„·": 45000, "ì¸í„°ë„·+ì¼ë°˜ì „í™”": 86000, "ì¸í„°ë„·+070ì „í™”": 78000, "ì¸í„°ë„·+TV": 71250, "ì¸í„°ë„·+TV+ì¼ë°˜ì „í™”": 112250, "ì¸í„°ë„·+TV+070ì „í™”": 104250, "ì¸í„°ë„·+TV+TVì¶”ê°€": 90500 }
    };
    const giftTable = {
        "ë² ì´ì§": { "100ë‹¨ë…":{cash:5e4,voucher:4e4},"500ë‹¨ë…":{cash:1e5,voucher:4e4},"1Gë‹¨ë…":{cash:9e4,voucher:5e4},"100ë²ˆë“¤":{cash:31e4,voucher:6e4},"500ë²ˆë“¤":{cash:39e4,voucher:6e4},"ê¸°ê°€ë²ˆë“¤":{cash:36e4,voucher:9e4}},
        "ë¼ì´íŠ¸": { "100ë‹¨ë…":{cash:5e4,voucher:4e4},"500ë‹¨ë…":{cash:1e5,voucher:4e4},"1Gë‹¨ë…":{cash:9e4,voucher:5e4},"100ë²ˆë“¤":{cash:31e4,voucher:6e4},"500ë²ˆë“¤":{cash:38e4,voucher:7e4},"ê¸°ê°€ë²ˆë“¤":{cash:35e4,voucher:1e5}},
        "ì—ì„¼ìŠ¤": { "100ë‹¨ë…":{cash:5e4,voucher:4e4},"500ë‹¨ë…":{cash:1e5,voucher:4e4},"1Gë‹¨ë…":{cash:9e4,voucher:5e4},"100ë²ˆë“¤":{cash:31e4,voucher:6e4},"500ë²ˆë“¤":{cash:42e4,voucher:3e4},"ê¸°ê°€ë²ˆë“¤":{cash:32e4,voucher:3e4}},
        "ì—ì„¼ìŠ¤ í”ŒëŸ¬ìŠ¤": { "100ë‹¨ë…":{cash:5e4,voucher:4e4},"500ë‹¨ë…":{cash:1e5,voucher:4e4},"1Gë‹¨ë…":{cash:9e4,voucher:5e4},"100ë²ˆë“¤":{cash:31e4,voucher:6e4},"500ë²ˆë“¤":{cash:42e4,voucher:3e4},"ê¸°ê°€ë²ˆë“¤":{cash:32e4,voucher:3e4}},
        "ë„·í”Œë¦­ìŠ¤ HD": { "100ë‹¨ë…":{cash:5e4,voucher:4e4},"500ë‹¨ë…":{cash:1e5,voucher:4e4},"1Gë‹¨ë…":{cash:9e4,voucher:5e4},"100ë²ˆë“¤":{cash:31e4,voucher:6e4},"500ë²ˆë“¤":{cash:39e4,voucher:6e4},"ê¸°ê°€ë²ˆë“¤":{cash:36e4,voucher:9e4}},
        "ë„·í”Œë¦­ìŠ¤ UHD": { "100ë‹¨ë…":{cash:5e4,voucher:4e4},"500ë‹¨ë…":{cash:1e5,voucher:4e4},"1Gë‹¨ë…":{cash:9e4,voucher:5e4},"100ë²ˆë“¤":{cash:31e4,voucher:6e4},"500ë²ˆë“¤":{cash:39e4,voucher:6e4},"ê¸°ê°€ë²ˆë“¤":{cash:36e4,voucher:9e4}},
        "í‚¤ì¦ˆëœë“œ": { "100ë‹¨ë…":{cash:5e4,voucher:4e4},"500ë‹¨ë…":{cash:1e5,voucher:4e4},"1Gë‹¨ë…":{cash:9e4,voucher:5e4},"100ë²ˆë“¤":{cash:31e4,voucher:6e4},"500ë²ˆë“¤":{cash:39e4,voucher:6e4},"ê¸°ê°€ë²ˆë“¤":{cash:36e4,voucher:9e4}}
    };
    const kt_total_mobile_fee_discounts = {
        "100M": { "tier1_under_22000":{internet_discount:1650,mobile_discount:0,total_discount:1650},"tier2_22000_to_64899":{internet_discount:3300,mobile_discount:0,total_discount:3300},"tier3_64900_to_108899":{internet_discount:5500,mobile_discount:3300,total_discount:8800},"tier4_108900_to_141899":{internet_discount:5500,mobile_discount:14300,total_discount:19800},"tier5_141900_to_174899":{internet_discount:5500,mobile_discount:18700,total_discount:24200},"tier6_over_174900":{internet_discount:5500,mobile_discount:23100,total_discount:28600}},
        "500M_1G": { "tier1_under_22000":{internet_discount:2200,mobile_discount:0,total_discount:2200},"tier2_22000_to_64899":{internet_discount:5500,mobile_discount:0,total_discount:5500},"tier3_64900_to_108899":{internet_discount:5500,mobile_discount:5500,total_discount:11e3},"tier4_108900_to_141899":{internet_discount:5500,mobile_discount:16610,total_discount:22110},"tier5_141900_to_174899":{internet_discount:5500,mobile_discount:22100,total_discount:27610},"tier6_over_174900":{internet_discount:5500,mobile_discount:27610,total_discount:33110}}
    };

    // --- ë‚˜ë¨¸ì§€ DOM ìš”ì†Œ ì„ íƒì ë° í•¨ìˆ˜ëŠ” ê·¸ëŒ€ë¡œ ìœ ì§€ ---
    const internetPlanEl = document.getElementById('internetPlan');
    const wifiRouterRentalEl = document.getElementById('wifiRouterRental');
    const tvPlanEl = document.getElementById('tvPlan');
    const additionalTvPlanEl = document.getElementById('additionalTvPlan');
    const phonePlanEl = document.getElementById('phonePlan');
    const addonServicesContainerEl = document.getElementById('addonServicesContainer');
    const mobileLinesCountEl = document.getElementById('mobileLinesCount');
    const mobileLinesContainerEl = document.getElementById('mobileLinesContainer');
    const dongpanSalesCheckKtEl = document.getElementById('dongpanSalesCheckKt');
    const dongpanPolicyDetailsContainerKtEl = document.getElementById('dongpanPolicyDetailsContainerKt');
    const discountTypeRadios = document.querySelectorAll('input[name="discountType"]');
    const displayModeKtRadios = document.querySelectorAll('input[name="displayModeKt"]');
    const totalAmountDetailsToggleEl = document.getElementById('totalAmountDetailsToggle');
    const totalAmountDetailsContainerEl = document.getElementById('totalAmountDetailsContainer');
    const premiumFamilyDetailsToggleEl = document.getElementById('premiumFamilyDetailsToggle');
    const premiumFamilyDetailsContainerEl = document.getElementById('premiumFamilyDetailsContainer');
    const premiumSingleDetailsToggleEl = document.getElementById('premiumSingleDetailsToggle');
    const premiumSingleDetailsContainerEl = document.getElementById('premiumSingleDetailsContainer');
    const familyBundleDetailsToggleEl = document.getElementById('familyBundleDetailsToggle');
    const familyBundleDetailsContainerEl = document.getElementById('familyBundleDetailsContainer');
    const separateFamilyDetailsToggleEl = document.getElementById('separateFamilyDetailsToggle');
    const separateFamilyDetailsContainerEl = document.getElementById('separateFamilyDetailsContainer');
    const mvnoDetailsToggleEl = document.getElementById('mvnoDetailsToggle');
    const mvnoDetailsContainerEl = document.getElementById('mvnoDetailsContainer');
    const calculateButton = document.getElementById('calculateButton');
    const resetButton = document.getElementById('resetButton');
    const resultSection = document.getElementById('resultSection');
    const toggleDetailsButton = document.getElementById('toggleDetailsButton');
    const expandedDetailsContainer = document.getElementById('expandedDetailsContainer');
    const summaryPreDiscountCostEl = document.getElementById('summaryPreDiscountCost');
    const summaryFinalCostEl = document.getElementById('summaryFinalCost');
    const summaryInternetDiscountEl = document.getElementById('summaryInternetDiscount');
    const summaryGiftTotalEl = document.getElementById('summaryGiftTotal');
    const summaryMobileDiscountEl = document.getElementById('summaryMobileDiscount');
    const selectedInternetEl = document.getElementById('selectedInternet');
    const selectedTvEl = document.getElementById('selectedTv');
    const selectedAdditionalTvEl = document.getElementById('selectedAdditionalTv');
    const selectedPhoneEl = document.getElementById('selectedPhone');
    const selectedWifiEl = document.getElementById('selectedWifi');
    const selectedMobileCountEl = document.getElementById('selectedMobileCount');
    const selectedDiscountTypeEl = document.getElementById('selectedDiscountType');
    const selectedWifiDetailsEl = document.getElementById('selectedWifiDetails');
    const detailInternetBaseEl = document.getElementById('detailInternetBase');
    const detailWifiFeeEl = document.getElementById('detailWifiFee');
    const detailInternetDiscountTotalEl = document.getElementById('detailInternetDiscountTotal');
    const detailFinalCostEl = document.getElementById('detailFinalCost');
    const giftCashEl = document.getElementById('giftCash');
    const giftVoucherEl = document.getElementById('giftVoucher');
    const giftPhoneVoucherEl = document.getElementById('giftPhoneVoucher');
    const giftAdditionalTvEl = document.getElementById('giftAdditionalTv');
    const dongpanCashContainerKtEl = document.getElementById('dongpanCashContainerKt');
    const giftDongpanAdditionalCashKtEl = document.getElementById('giftDongpanAdditionalCashKt');
    const giftTotalEl = document.getElementById('giftTotal');
    const mobileDiscountDetailContainerEl = document.getElementById('mobileDiscountDetailContainer');
    const installationFeeSectionEl = document.getElementById('installationFeeSection');
    const installationFeeResultEl = document.getElementById('installationFeeResult');
    const installationFeeDescriptionEl = document.getElementById('installationFeeDescription');
    const customerConsultSection = document.getElementById('customerConsultSection');
    const kakaoBtn = document.getElementById('kakaoBtn');
    const smsBtn = document.getElementById('smsBtn');
    
    // --- ë‚˜ë¨¸ì§€ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ë° í•¨ìˆ˜ëŠ” ê·¸ëŒ€ë¡œ ìœ ì§€ ---
    mobileLinesCountEl.addEventListener('input', updateMobileLinesInputs);
    calculateButton.addEventListener('click', calculateAndDisplayResults);
    resetButton.addEventListener('click', resetCalculator); 
    toggleDetailsButton.addEventListener('click', () => {
        expandedDetailsContainer.classList.toggle('hidden');
        const isHidden = expandedDetailsContainer.classList.contains('hidden');
        toggleDetailsButton.innerHTML = isHidden ? 'ìƒì„¸ ìš”ê¸ˆ ë‚´ì—­ í¼ì³ë³´ê¸° â–¼' : 'ìƒì„¸ ìš”ê¸ˆ ë‚´ì—­ ì ‘ê¸° â–²';
    });
    if(dongpanSalesCheckKtEl) {
        dongpanSalesCheckKtEl.addEventListener('change', function() {
            if (dongpanPolicyDetailsContainerKtEl) {
                dongpanPolicyDetailsContainerKtEl.classList.toggle('hidden', !this.checked);
            }
            if (!resultSection.classList.contains('hidden')) {
                calculateAndDisplayResults();
            }
        });
    }
    const allDetailSections = [
        { radioValue: 'totalAmountBundle', toggleEl: totalAmountDetailsToggleEl, containerEl: totalAmountDetailsContainerEl, updateFn: updateTotalAmountDetails },
        { radioValue: 'premiumFamilyBundle', toggleEl: premiumFamilyDetailsToggleEl, containerEl: premiumFamilyDetailsContainerEl, updateFn: updatePremiumFamilyDetails },
        { radioValue: 'premiumSingleBundle', toggleEl: premiumSingleDetailsToggleEl, containerEl: premiumSingleDetailsContainerEl, updateFn: updatePremiumSingleDetails },
        { radioValue: 'familyBundle', toggleEl: familyBundleDetailsToggleEl, containerEl: familyBundleDetailsContainerEl, updateFn: updateFamilyBundleDetails },
        { radioValue: 'separateFamilyBundle', toggleEl: separateFamilyDetailsToggleEl, containerEl: separateFamilyDetailsContainerEl, updateFn: updateSeparateFamilyDetails },
        { radioValue: 'mvnoBundle', toggleEl: mvnoDetailsToggleEl, containerEl: mvnoDetailsContainerEl, updateFn: updateMvnoDetails }
    ];

    // âœ¨ [ìˆ˜ì •ë¨] í”„ë¦¬ë¯¸ì—„ ê²°í•© ì‹œ ìš”ê¸ˆì œ ë¹„í™œì„±í™” ë° ê¸°ë³¸ê°’ ì„¤ì • ë¡œì§ ë³€ê²½
    function updateMobilePlanOptions() {
        const selectedDiscountType = document.querySelector('input[name="discountType"]:checked').value;
        document.querySelectorAll('.mobile-plan-select').forEach((select, index) => {
            let isPremiumLine = false;
            // í”„ë¦¬ë¯¸ì—„ ì‹±ê¸€ê²°í•©ì´ê±°ë‚˜, í”„ë¦¬ë¯¸ì—„ ê°€ì¡±ê²°í•©ì˜ ì²« 2íšŒì„ ì¼ ê²½ìš° 'í”„ë¦¬ë¯¸ì—„ íšŒì„ 'ìœ¼ë¡œ ê°„ì£¼
            if (selectedDiscountType === 'premiumSingleBundle' || (selectedDiscountType === 'premiumFamilyBundle' && index < 2)) {
                isPremiumLine = true;
            }

            let needsReset = false;
            for (const option of select.options) {
                const price = parseInt(option.value);
                if (price > 0) {
                    // í”„ë¦¬ë¯¸ì—„ íšŒì„ ì€ 80,000ì› ë¯¸ë§Œ ìš”ê¸ˆì œ ë¹„í™œì„±í™”
                    if (isPremiumLine && price < 80000) {
                        option.disabled = true;
                        if (option.selected) needsReset = true;
                    } else {
                        option.disabled = false;
                    }
                }
            }
            // ë¹„í™œì„±í™”ëœ ìš”ê¸ˆì œê°€ ì„ íƒë˜ì–´ ìˆì—ˆë‹¤ë©´, ê¸°ë³¸ê°’(80,000ì›)ìœ¼ë¡œ ì¬ì„¤ì •
            if (needsReset) {
                select.value = "80000"; 
                select.dispatchEvent(new Event('change'));
            }
        });
    }

    function updateInternetPlanOptions() {
        const selectedDiscountType = document.querySelector('input[name="discountType"]:checked').value;
        const restrictedTypes = ['separateFamilyBundle', 'premiumFamilyBundle', 'premiumSingleBundle'];
        const isRestricted = restrictedTypes.includes(selectedDiscountType);
        let wasChanged = false;
        for (const option of internetPlanEl.options) {
            if (!option.dataset.speed) continue;
            const speed = parseInt(option.dataset.speed);
            if (speed === 100) {
                if (isRestricted) {
                    option.disabled = true;
                    if (option.selected) {
                        internetPlanEl.value = 'none';
                        wasChanged = true;
                    }
                } else {
                    option.disabled = false;
                }
            }
        }
        if (wasChanged) {
            // Use custom modal or inline message instead of alert
            console.warn('ì„ íƒí•˜ì‹  ê²°í•© ìœ í˜•ì€ 100M ì¸í„°ë„·ì„ ì§€ì›í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤. 500M ì´ìƒ ì¸í„°ë„· ìš”ê¸ˆì œë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”.');
            const first500M = Array.from(internetPlanEl.options).find(opt => parseInt(opt.dataset.speed) === 500 && !opt.disabled);
            if (first500M) internetPlanEl.value = first500M.value;
            internetPlanEl.dispatchEvent(new Event('change'));
        }
    }
    discountTypeRadios.forEach(radio => {
        radio.addEventListener('change', function() {
            const newlySelectedRadioValue = this.value;
            allDetailSections.forEach(section => {
                if (section.containerEl && section.toggleEl) {
                    let isVisible = false;
                    if (newlySelectedRadioValue === section.radioValue) {
                        isVisible = section.toggleEl.checked;
                        if (isVisible && section.updateFn) section.updateFn();
                    } else {
                        section.toggleEl.checked = false;
                        isVisible = false;
                    }
                    section.containerEl.classList.toggle('hidden', !isVisible);
                }
            });
            if (newlySelectedRadioValue === 'premiumSingleBundle') {
                mobileLinesCountEl.value = 1;
                mobileLinesCountEl.disabled = true;
            } else if (newlySelectedRadioValue === "none" || newlySelectedRadioValue === "familyBundle" || newlySelectedRadioValue === "mvnoBundle") {
                mobileLinesCountEl.value = 0;
                mobileLinesCountEl.disabled = true;
            } else {
                mobileLinesCountEl.disabled = false;
                if (parseInt(mobileLinesCountEl.value) === 0 && !mobileLinesCountEl.disabled) mobileLinesCountEl.value = 1;
            }
            updateMobileLinesInputs();
            updateMobilePlanOptions();
            updateInternetPlanOptions();
        });
    });
    allDetailSections.forEach(section => {
        if (section.toggleEl && section.containerEl && section.updateFn) {
            section.toggleEl.addEventListener('change', function() {
                const radioForThisToggle = document.querySelector(`input[name="discountType"][value="${section.radioValue}"]`);
                if (radioForThisToggle && radioForThisToggle.checked) {
                    section.containerEl.classList.toggle('hidden', !this.checked);
                    if (this.checked) section.updateFn();
                } else {
                    section.containerEl.classList.add('hidden');
                    this.checked = false;
                }
            });
        }
    });
    const internetTypeRadios = document.querySelectorAll('input[name="internetType"]');
    internetTypeRadios.forEach(radio => {
        radio.addEventListener('change', function() {
            populateInternetPlans();
            handleInternetTypeChange();
        });
    });
    function populateInternetPlans() {
        const selectedInternetType = document.querySelector('input[name="internetType"]:checked').value;
        const currentInternetPlan = internetPlanEl.value;
        internetPlanEl.innerHTML = '<option value="none">ì„ íƒ ì•ˆí•¨</option>';
        for (const planKey in internetPlans_KT) {
            const plan = internetPlans_KT[planKey];
            let displayText = "";
            let matchesType = false;
            const speedText = plan.speed >= 1000 ? `${plan.speed / 1000}G` : `${plan.speed}M`;
            if (selectedInternetType === "bundle") {
                if (planKey.includes("ë²ˆë“¤")) {
                    displayText = `ì¸í„°ë„· ${speedText} (TV ê²°í•© ì‹œ) (ì›” ${plan.basePrice.toLocaleString()}ì›)`;
                    matchesType = true;
                }
            } else {
                if (planKey.includes("(ë‹¨ë…)")) {
                    displayText = `ì¸í„°ë„·(ë‹¨ë…) ${speedText} (ì›” ${plan.basePrice.toLocaleString()}ì›)`;
                    matchesType = true;
                }
            }
            if (matchesType) {
                const option = document.createElement('option');
                option.value = planKey;
                option.textContent = displayText;
                option.dataset.price = plan.basePrice;
                option.dataset.speed = plan.speed;
                option.dataset.type = plan.type;
                internetPlanEl.appendChild(option);
            }
        }
        if (Array.from(internetPlanEl.options).some(opt => opt.value === currentInternetPlan)) internetPlanEl.value = currentInternetPlan;
        updateInternetPlanOptions();
        internetPlanEl.dispatchEvent(new Event('change'));
    }
    function handleInternetTypeChange() {
        const selectedInternetType = document.querySelector('input[name="internetType"]:checked').value;
        const isStandalone = selectedInternetType === 'standalone';
        tvPlanEl.disabled = isStandalone;
        additionalTvPlanEl.disabled = isStandalone;
        if (isStandalone) {
            tvPlanEl.value = "none";
            additionalTvPlanEl.value = "none";
            internetPlanEl.value = "KTì¸í„°ë„·(ë‹¨ë…) 100mb";
        } else {
            internetPlanEl.value = "KTì¸í„°ë„·ë²ˆë“¤100mb";
            if (tvPlanEl.value === "none") tvPlanEl.value = "KTTVë² ì´ì§";
        }
        tvPlanEl.dispatchEvent(new Event('change'));
        internetPlanEl.dispatchEvent(new Event('change'));
    }
    internetPlanEl.addEventListener('change', function() {
        const selectedOption = this.options[this.selectedIndex];
        wifiRouterRentalEl.disabled = false;
        const currentWifi = wifiRouterRentalEl.options[wifiRouterRentalEl.selectedIndex];
        if (currentWifi && currentWifi.text.includes('í”„ë¡œëª¨ì…˜')) wifiRouterRentalEl.value = "1100";
        if (!selectedOption || selectedOption.value === 'none') return;
        const internetSpeed = parseInt(selectedOption.dataset.speed);
        if (internetSpeed >= 1000) {
            const promoOption = Array.from(wifiRouterRentalEl.options).find(opt => opt.dataset.name === "KT WiFi 7D");
            if (promoOption) {
                promoOption.selected = true;
                wifiRouterRentalEl.disabled = true;
            }
        } else if (internetSpeed === 500) {
            const promoOption = Array.from(wifiRouterRentalEl.options).find(opt => opt.dataset.name === "GiGA WiFi home ax");
            if (promoOption) {
                promoOption.selected = true;
                wifiRouterRentalEl.disabled = true;
            }
        }
    });
    tvPlanEl.addEventListener('change', () => { const isTvSelected = tvPlanEl.value !== 'none'; });
    additionalTvPlanEl.addEventListener('change', () => { if (tvPlanEl.value === 'none' && additionalTvPlanEl.value !== 'none') { console.warn('ì²« ë²ˆì§¸ TVë¥¼ ë¨¼ì € ì„ íƒí•´ì£¼ì„¸ìš”.'); additionalTvPlanEl.value = 'none'; } });
    
    // âœ¨ [ìˆ˜ì •ë¨] í”„ë¦¬ë¯¸ì—„ ê²°í•© ì‹œ ìš”ê¸ˆì œ ê¸°ë³¸ê°’ ì„¤ì • ë¡œì§ ë³€ê²½
    function updateMobileLinesInputs() {
        const count = parseInt(mobileLinesCountEl.value) || 0;
        mobileLinesContainerEl.innerHTML = '';
        const selectedDiscountType = document.querySelector('input[name="discountType"]:checked').value;
        for (let i = 0; i < count; i++) {
            const div = document.createElement('div');
            div.className = 'mobile-line-item py-2 space-y-2';
            div.innerHTML = `<div><label for="mobilePlan${i}" class="block text-sm font-medium text-slate-600 mb-1">íšŒì„  ${i + 1} ìš”ê¸ˆì œ ì„ íƒ</label><div class="flex items-center space-x-2"><label for="selectiveContract${i}" class="flex items-center text-sm font-medium text-slate-600 cursor-pointer hover:text-sky-600 p-2 rounded-md bg-slate-50 border border-slate-200"><input type="checkbox" id="selectiveContract${i}" class="selective-contract-checkbox radio-input h-4 w-4 mr-2">ì„ íƒì•½ì •</label><select id="mobilePlan${i}" class="input-field mobile-plan-select flex-grow"><option value="0" data-name="ë¯¸ì„ íƒ" data-url="">ìš”ê¸ˆì œ ì„ íƒ</option>${mobilePlans_KT.map(plan => `<option value="${plan.price}" data-name="${plan.name}" data-url="${plan.url}">${plan.name} (${plan.price.toLocaleString()}ì›)</option>`).join('')}</select></div></div>`;
            mobileLinesContainerEl.appendChild(div);
            
            const newSelect = document.getElementById(`mobilePlan${i}`);
            // í• ì¸ ìœ í˜•ë³„ ê¸°ë³¸ ìš”ê¸ˆì œ ì„¤ì •
            if (selectedDiscountType === 'premiumFamilyBundle') {
                if (i < 2) {
                    newSelect.value = "80000"; // 1~2íšŒì„ : ë² ì´ì§(80,000ì›)
                } else {
                    newSelect.value = "69000"; // 3íšŒì„ ë¶€í„°: 5G ì‹¬í”Œ 110GB(69,000ì›)
                }
            } else if (selectedDiscountType === 'premiumSingleBundle') {
                 newSelect.value = "80000"; // ë² ì´ì§(80,000ì›)
            } else if (selectedDiscountType === 'totalAmountBundle' || selectedDiscountType === 'separateFamilyBundle') {
                 if (i === 0) newSelect.value = "37000"; // ì²« íšŒì„ ë§Œ ê¸°ë³¸ê°’ ì„¤ì •
            }
        }
        document.querySelectorAll('.mobile-plan-select, .selective-contract-checkbox').forEach(el => {
            el.addEventListener('change', () => {
                const currentDiscountType = document.querySelector('input[name="discountType"]:checked').value;
                const section = allDetailSections.find(s => s.radioValue === currentDiscountType);
                if (section && section.toggleEl.checked && section.updateFn) section.updateFn();
            });
        });
        updateMobilePlanOptions();
    }
    function getSelectedInternetInfo(planName) {
        if (!planName || planName === 'none' || !internetPlans_KT[planName]) return { basePrice: 0, modemFee: 0, type: "none", speed: 0 };
        let basePrice = internetPlans_KT[planName].basePrice;
        const selectedOption = internetPlanEl.options[internetPlanEl.selectedIndex];
        if (selectedOption && selectedOption.value !== 'none' && selectedOption.text.includes("KTì¸í„°ë„·ë²ˆë“¤")) basePrice = internetPlans_KT[planName].basePrice;
        return { ...internetPlans_KT[planName], basePrice: basePrice };
    }
    function getMobileTierKey(totalMobileBaseCost, numMobileLines, internetSpeedType) {
        if (numMobileLines === 0 || totalMobileBaseCost === 0) return null;
        if (internetSpeedType === "100M") {
            if (totalMobileBaseCost < 22000) return "ëª¨ë°”ì¼_22000ë¯¸ë§Œ";
            if (totalMobileBaseCost < 64900) return "ëª¨ë°”ì¼_64900ë¯¸ë§Œ";
            return "ëª¨ë°”ì¼_64900ì´ìƒ";
        } else {
            if (totalMobileBaseCost < 22000) return "ëª¨ë°”ì¼_22000ë¯¸ë§Œ";
            return "ëª¨ë°”ì¼_22000ì´ìƒ";
        }
    }
    function getMobileTierKeyFor500MUp(totalMobileBaseCost, numMobileLines){ if (numMobileLines === 0 || totalMobileBaseCost === 0) return null; if (totalMobileBaseCost < 22000) return "ëª¨ë°”ì¼_22000ë¯¸ë§Œ"; return "ëª¨ë°”ì¼_22000ì´ìƒ"; }
    function getMobileTierKeyForSeparateFamily(totalMobileBaseCost, numMobileLines){ if (numMobileLines === 0 || totalMobileBaseCost === 0) return null; if (totalMobileBaseCost < 22000) return "ëª¨ë°”ì¼_22000ë¯¸ë§Œ"; return "ëª¨ë°”ì¼_22000ì´ìƒ"; }
    
    function updateMvnoDetails() {
        mvnoDetailsContainerEl.innerHTML = `
            <h4 class="font-semibold text-sm mb-2 text-slate-700">ì•Œëœ°í° ê²°í•© ìƒì„¸ ì •ë³´</h4>
            <ul class="list-disc list-inside text-xs space-y-2">
                <li>
                    <strong>ì¸í„°ë„· í• ì¸ì•¡ (ëª¨ë°”ì¼ í• ì¸ ì—†ìŒ):</strong>
                    <ul class="list-circle list-inside ml-4 mt-1">
                        <li>100M ì¸í„°ë„·: 3,300ì› í• ì¸</li>
                        <li>500M/1G ì¸í„°ë„· (ë‹¨ë…): 11,000ì› í• ì¸</li>
                        <li>500M/1G ì¸í„°ë„· (TV ê²°í•©): 5,500ì› í• ì¸</li>
                    </ul>
                </li>
                <li><strong>ê²°í•© ê°€ëŠ¥ ì•Œëœ°í° í†µì‹ ì‚¬:</strong>
                    <p class="text-slate-500 mt-1 pl-2">
                        ì— ëª¨ë°”ì¼, ë¯¸ë‹ˆê²Œì´íŠ¸(ì‰ì´í¬ëª¨ë°”ì¼), ìœ ë‹ˆì»´ì¦ˆ(ëª¨ë¹™), í† ìŠ¤ëª¨ë°”ì¼, êµ­ë¯¼ì€í–‰(ë¦¬ë¸Œëª¨ë°”ì¼), ë”í”¼ì—”ì—˜(í¼ìŠ¤íŠ¸ëª¨ë°”ì¼), ì—ë¥´ì—˜(ì˜¤íŒŒìŠ¤ë„·ëª¨ë°”ì¼), ê³ ê³ íŒ©í† ë¦¬, ìŠ¤ë§ˆí…”, ìŠ¤ì¹´ì´ë¼ì´í”„(ì¼ë¶€ ìš”ê¸ˆì œ ì œì™¸), ì½”ë“œëª¨ë°”ì¼, í”„ë¦¬í‹°, ë‹ˆì˜¤ë¼ì½”ë¦¬ì•„, ìŠ¤í”¼ì¸ ëª¨ë°”ì¼, ì•„ì´ì¦ˆë¹„ì „
                    </p>
                </li>
                <li><strong class="text-red-600">ìœ ì˜ì‚¬í•­:</strong>
                    <ul class="list-circle list-inside ml-4 mt-1">
                        <li>ê°œì¸/ë²•ì¸ ì‚¬ì—…ì ëª…ì˜ëŠ” ê²°í•©ì´ ë¶ˆê°€í•©ë‹ˆë‹¤.</li>
                        <li>ì¸í„°ë„· ì„¤ì¹˜ ì™„ë£Œ í›„, ê³ ê°ë‹˜ê»˜ì„œ ì§ì ‘ ì•Œëœ°í° í†µì‹ ì‚¬ ê³ ê°ì„¼í„°ë¡œ ê²°í•©ì„ ìš”ì²­í•˜ì…”ì•¼ í•©ë‹ˆë‹¤.</li>
                        <li>ê²°í•© í›„ ì•Œëœ°í° í†µì‹ ì‚¬ë¥¼ ë³€ê²½í•˜ì‹¤ ê²½ìš°, ê¸°ì¡´ ê²°í•©ì€ í•´ì§€ë˜ë©° ì¬ê²°í•©ì´ ë¶ˆê°€í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</li>
                    </ul>
                </li>
            </ul>
        `;
    }

    function updateTotalAmountDetails() { totalAmountDetailsContainerEl.innerHTML = `<h4 class="font-semibold text-sm mb-2 text-slate-700">ì´ì•¡ ê²°í•©í• ì¸ ìƒì„¸ ì •ë³´</h4><p class="text-xs text-slate-600 mb-2">ëª¨ë°”ì¼ ì´ì•¡ì— ë”°ë¼ ì¸í„°ë„· ìš”ê¸ˆì„ í• ì¸ë°›ëŠ” ë°©ì‹ì…ë‹ˆë‹¤. 5G/LTE êµ¬ë¶„ ì—†ì´ ê²°í•© ê°€ëŠ¥í•©ë‹ˆë‹¤.</p><ul class="list-disc list-inside text-xs space-y-1"><li><strong>100M ì¸í„°ë„·:</strong><ul class="list-circle list-inside ml-4"><li>ëª¨ë°”ì¼ ì´ì•¡ 22,000ì› ë¯¸ë§Œ: 1,650ì› í• ì¸</li><li>ëª¨ë°”ì¼ ì´ì•¡ 64,900ì› ë¯¸ë§Œ: 3,300ì› í• ì¸</li><li>ëª¨ë°”ì¼ ì´ì•¡ 64,900ì› ì´ìƒ: 5,500ì› í• ì¸ + ëª¨ë°”ì¼ ì¶”ê°€í• ì¸</li></ul></li><li><strong>500M/1G ì¸í„°ë„· (TV/ì „í™” ê²°í•© ì‹œ):</strong><ul class="list-circle list-inside ml-4"><li>ëª¨ë°”ì¼ ì´ì•¡ 22,000ì› ë¯¸ë§Œ: 2,200ì› í• ì¸</li><li>ëª¨ë°”ì¼ ì´ì•¡ 22,000ì› ì´ìƒ: 5,500ì› í• ì¸ + ëª¨ë°”ì¼ ì¶”ê°€í• ì¸</li></ul></li><li><strong>500M/1G ì¸í„°ë„· (ë‹¨ë…):</strong><ul class="list-circle list-inside ml-4"><li>ëª¨ë°”ì¼ ì´ì•¡ 22,000ì› ë¯¸ë§Œ: 7,700ì› í• ì¸</li><li>ëª¨ë°”ì¼ ì´ì•¡ 22,000ì› ì´ìƒ: 11,000ì› í• ì¸ + ëª¨ë°”ì¼ ì¶”ê°€í• ì¸</li></ul></li></ul>`; }
    function updatePremiumFamilyDetails() { premiumFamilyDetailsContainerEl.innerHTML = `<h4 class="font-semibold text-sm mb-2 text-slate-700">í”„ë¦¬ë¯¸ì—„ ê°€ì¡±ê²°í•© ìƒì„¸ ì •ë³´</h4><p class="text-xs text-slate-600 mb-2">5G/LTE 8ë§Œì› ì´ìƒ ìš”ê¸ˆì œë¥¼ ì‚¬ìš©í•˜ëŠ” ê°€ì¡± êµ¬ì„±ì›ì´ ìˆì„ ë•Œ ìœ ë¦¬í•œ ê²°í•©ì…ë‹ˆë‹¤.</p><ul class="list-disc list-inside text-xs space-y-1"><li><strong>ì¡°ê±´:</strong> 500M ì´ìƒ ì¸í„°ë„· + 1ë²ˆì§¸ íšŒì„ ë¶€í„° 5G/LTE 8ë§Œì› ì´ìƒ ìš”ê¸ˆì œ ì‚¬ìš©</li><li><strong>ì¸í„°ë„· í• ì¸:</strong> 5,500ì› ~ 11,000ì› í• ì¸</li><li><strong>ëª¨ë°”ì¼ í• ì¸:</strong><ul class="list-circle list-inside ml-4"><li>1ë²ˆì§¸ íšŒì„ : 5,500ì› í• ì¸ + (ì¡°ê±´ ì¶©ì¡± ì‹œ ì´ì•¡ê²°í•© ì¶”ê°€ í• ì¸)</li><li>2ë²ˆì§¸ íšŒì„  ì´ìƒ (8ë§Œì›+ ìš”ê¸ˆì œ): ì›”ì •ì•¡ì˜ 25% í• ì¸</li><li>3ë²ˆì§¸ íšŒì„  ì´ìƒ (8ë§Œì› ë¯¸ë§Œ ìš”ê¸ˆì œ): ì¡°ê±´ ì¶©ì¡± ì‹œ ì´ì•¡ê²°í•© í• ì¸ ì ìš©</li></ul></li><li><strong>ì°¸ê³ :</strong> 100M ì¸í„°ë„·ì€ ê²°í•© ë¶ˆê°€. 3íšŒì„  ì´ìƒì´ 77,000ì› ì´í•˜ ìš”ê¸ˆì œì¼ ê²½ìš°, 1íšŒì„  ìš”ê¸ˆê³¼ í•©ì‚°í•˜ì—¬ ì´ì•¡ê²°í•©í• ì¸ì´ ê³„ì‚°ë˜ì–´ 1íšŒì„ ê³¼ 3íšŒì„  ì´ìƒì— ë¶„ë°°ë©ë‹ˆë‹¤.</li></ul>`; }
    function updatePremiumSingleDetails() { premiumSingleDetailsContainerEl.innerHTML = `<h4 class="font-semibold text-sm mb-2 text-slate-700">í”„ë¦¬ë¯¸ì—„ ì‹±ê¸€ê²°í•© ìƒì„¸ ì •ë³´</h4><p class="text-xs text-slate-600 mb-2">5G/LTE 8ë§Œì› ì´ìƒ ìš”ê¸ˆì œë¥¼ í˜¼ì ì‚¬ìš©í•˜ê³  ì¸í„°ë„· ë‹¨ë…ìœ¼ë¡œ ì‚¬ìš©í•  ë•Œ ìœ ë¦¬í•©ë‹ˆë‹¤.</p><ul class="list-disc list-inside text-xs space-y-1"><li><strong>ì¡°ê±´:</strong> 500M ì´ìƒ ì¸í„°ë„· ë‹¨ë… + 5G/LTE 8ë§Œì› ì´ìƒ ìš”ê¸ˆì œ 1íšŒì„ </li><li><strong>ì¸í„°ë„· í• ì¸:</strong> 5,500ì› í• ì¸</li><li><strong>ëª¨ë°”ì¼ í• ì¸:</strong> ì›”ì •ì•¡ì˜ 25% í• ì¸</li><li><strong>ì°¸ê³ :</strong> 100M ì¸í„°ë„· ë° TV/ì „í™” ê²°í•© ì‹œì—ëŠ” ê°€ì… ë¶ˆê°€</li></ul>`; }
    function updateFamilyBundleDetails() { familyBundleDetailsContainerEl.innerHTML = `<h4 class="font-semibold text-sm mb-2 text-slate-700">íŒ¨ë°€ë¦¬ ê²°í•© ìƒì„¸ ì •ë³´</h4><p class="text-xs text-slate-600 mb-2">ê¸°ì¡´ KT ì¸í„°ë„·ì„ ì‚¬ìš©í•˜ëŠ” ê°€ì¡±ì´ ì¶”ê°€ë¡œ ì¸í„°ë„·ì„ ì„¤ì¹˜í•  ë•Œ ì ìš©ë©ë‹ˆë‹¤. (ëª¨ë°”ì¼ ê²°í•© ë¶ˆí•„ìš”)</p><ul class="list-disc list-inside text-xs space-y-1"><li><strong>100M ì¸í„°ë„·:</strong> 5,500ì› í• ì¸</li><li><strong>500M/1G ì¸í„°ë„· (ë‹¨ë…):</strong> 11,000ì› í• ì¸</li><li><strong>500M/1G ì¸í„°ë„· (TV ê²°í•©):</strong> 5,500ì› í• ì¸</li></ul>`; }
    function updateSeparateFamilyDetails() { separateFamilyDetailsContainerEl.innerHTML = `<h4 class="font-semibold text-sm mb-2 text-slate-700">ë”°ë¡œ ì‚´ì•„ë„ ê°€ì¡±ê²°í•© ìƒì„¸ ì •ë³´</h4><p class="text-xs text-slate-600 mb-2">ê°€ì¡±ê´€ê³„ì¦ëª…ì„œë¡œ ì¦ë¹™ ê°€ëŠ¥í•œ ê°€ì¡±ì´ ë”°ë¡œ ì‚´ë©´ì„œ ì¸í„°ë„·+TVì™€ ëª¨ë°”ì¼ì„ ê²°í•©í•  ë•Œ ì ìš©ë©ë‹ˆë‹¤.</p><ul class="list-disc list-inside text-xs space-y-1"><li><strong>ì¡°ê±´:</strong> 500M ì´ìƒ ì¸í„°ë„· + TV + ëª¨ë°”ì¼ 1íšŒì„  ì´ìƒ</li><li><strong>ì¸í„°ë„·+TV í• ì¸:</strong><ul class="list-circle list-inside ml-4"><li><strong>500M:</strong> 9,900ì›(ì¸í„°ë„·) + 2,200ì›(TV) = ì´ 12,100ì› í• ì¸</li><li><strong>1G:</strong> 11,000ì›(ì¸í„°ë„·) + 3,300ì›(TV) = ì´ 14,300ì› í• ì¸</li></ul></li><li><strong>ëª¨ë°”ì¼ í• ì¸:</strong> ì—†ìŒ</li><li><strong>ì°¸ê³ :</strong> 100M ì¸í„°ë„· ë˜ëŠ” ì¸í„°ë„· ë‹¨ë…ì€ ê²°í•© ë¶ˆê°€</li></ul>`; }
    function calculateInstallationFee(internetSelected, tvSelected, phonePlanName, additionalTvSelected, installTime) {
        const timeKey = installTime === 'weekday' ? 'í‰ì¼' : 'ì£¼ë§';
        const feeTable = ktInstallationFees_new[timeKey];
        if (!feeTable) return { fee: 0, desc: "ì„¤ì¹˜ ì‹œê°„ëŒ€ë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”." };
        let fee = 0;
        let desc = "ì‚°ì • ë¶ˆê°€";
        let combinationKey = "";
        const phoneSelected = phonePlanName !== 'none';
        const isGeneralPhone = phoneSelected && phonePlanName.includes("ì¼ë°˜ ì „í™”");
        const is070Phone = phoneSelected && phonePlanName.includes("ì¸í„°ë„· ì „í™”");
        if (internetSelected && tvSelected && additionalTvSelected) { combinationKey = "ì¸í„°ë„·+TV+TVì¶”ê°€"; desc = "ì¸í„°ë„· + TV + ì¶”ê°€ TV"; }
        else if (internetSelected && tvSelected && isGeneralPhone) { combinationKey = "ì¸í„°ë„·+TV+ì¼ë°˜ì „í™”"; desc = "ì¸í„°ë„· + TV + ì¼ë°˜ì „í™”"; }
        else if (internetSelected && tvSelected && is070Phone) { combinationKey = "ì¸í„°ë„·+TV+070ì „í™”"; desc = "ì¸í„°ë„· + TV + 070ì „í™”"; }
        else if (internetSelected && tvSelected) { combinationKey = "ì¸í„°ë„·+TV"; desc = "ì¸í„°ë„· + TV"; }
        else if (internetSelected && isGeneralPhone) { combinationKey = "ì¸í„°ë„·+ì¼ë°˜ì „í™”"; desc = "ì¸í„°ë„· + ì¼ë°˜ì „í™”"; }
        else if (internetSelected && is070Phone) { combinationKey = "ì¸í„°ë„·+070ì „í™”"; desc = "ì¸í„°ë„· + 070ì „í™”"; }
        else if (internetSelected) { combinationKey = "ì¸í„°ë„·"; desc = "ì¸í„°ë„· ë‹¨ë…"; }
        else { if (tvSelected) { fee = 0; desc = "TV ë‹¨ë… (ë¹„ìš© ë³„ë„ ë¬¸ì˜)"; } else if (phoneSelected) { fee = 0; desc = "ì „í™” ë‹¨ë… (ë¹„ìš© ë³„ë„ ë¬¸ì˜)"; } return { fee, desc }; }
        fee = feeTable[combinationKey] || 0;
        if (timeKey === 'ì£¼ë§' && fee > 0 && feeTable["ìœ íš¨ê¸°ê°„"]) desc += ` (${feeTable["ìœ íš¨ê¸°ê°„"]})`;
        return { fee, desc };
    }
    
    function calculateAndDisplayResults() {
        try {
            const internetPlanName = internetPlanEl.value;
            const selectedWifiOptionEl = wifiRouterRentalEl.options[wifiRouterRentalEl.selectedIndex];
            const selectedWifiName = selectedWifiOptionEl ? selectedWifiOptionEl.dataset.name : "KTê³µìœ ê¸° X";
            const tvPlanName = tvPlanEl.value;
            const additionalTvPlanKey = additionalTvPlanEl.value;
            const phonePlanName = phonePlanEl.value;
            const discountType = document.querySelector('input[name="discountType"]:checked').value;
            const displayMode = document.querySelector('input[name="displayModeKt"]:checked').value;
            const installationTime = document.querySelector('input[name="installationTime"]:checked').value;
            const selectedAddonCheckboxes = document.querySelectorAll('#addonServicesContainer input[type="checkbox"]:checked');
            const isDongpanChecked = dongpanSalesCheckKtEl ? dongpanSalesCheckKtEl.checked : false;
            let totalMobileBaseCost = 0;
            let mobileLinesData = [];
            document.querySelectorAll('.mobile-line-item').forEach((item, i) => {
                const select = item.querySelector(`#mobilePlan${i}`);
                const checkbox = item.querySelector(`#selectiveContract${i}`);
                const option = select.options[select.selectedIndex];
                mobileLinesData.push({ cost: parseInt(option.value) || 0, name: option.dataset.name, url: option.dataset.url, applySelectiveContract: checkbox.checked });
                totalMobileBaseCost += parseInt(option.value) || 0;
            });
            const numMobileLines = mobileLinesData.length;
            let tvBase = (tvPlanName !== 'none' && tvPlans_KT[tvPlanName]) ? tvPlans_KT[tvPlanName].basePrice : 0;
            let additionalTvCost = (additionalTvPlanKey !== 'none' && additionalTvPlans_KT[additionalTvPlanKey]) ? additionalTvPlans_KT[additionalTvPlanKey].basePrice : 0;
            let phoneBase = (phonePlanName !== 'none' && phonePlans_KT[phonePlanName]) ? phonePlans_KT[phonePlanName].basePrice : 0;
            let currentInternet = getSelectedInternetInfo(internetPlanName);
            let internetBase = internetPlanName !== 'none' ? (parseFloat(currentInternet.basePrice) || 0) : 0;
            const selectedWifiData = wifiOptions_KT[selectedWifiName];
            let actualWifiRouterFee = selectedWifiData ? selectedWifiData.fee : 0;
            let addonServicesTotalCost = 0;
            selectedAddonCheckboxes.forEach(checkbox => { addonServicesTotalCost += (parseFloat(checkbox.dataset.price) || 0); });
            let internetDiscount = 0;
            let currentTvDiscount = 0;
            let totalMobileDiscount = 0;
            let mobileDiscountDescription = 'ê²°í•©ì— ë”°ë¥¸ ëª¨ë°”ì¼ í• ì¸ ì—†ìŒ.';
            const isTvOrPhoneBundled = tvPlanName !== 'none' || phonePlanEl.value !== 'none';
            if (discountType !== 'none' && internetPlanName !== 'none') {
                const internetSpeedType = currentInternet.type;
                const bundleTypeForDiscountRule = isTvOrPhoneBundled ? "TV" : "ë‹¨ë…";
                if (discountType === 'totalAmountBundle') {
                    let mobileTierKey = getMobileTierKey(totalMobileBaseCost, numMobileLines, internetSpeedType);
                    if (mobileTierKey && newKtDiscountRules.ì´ì•¡ê²°í•©í• ì¸?.[internetSpeedType]?.[bundleTypeForDiscountRule]?.[mobileTierKey]) { internetDiscount = newKtDiscountRules.ì´ì•¡ê²°í•©í• ì¸[internetSpeedType][bundleTypeForDiscountRule][mobileTierKey]; }
                    else if (internetSpeedType === "1G" && bundleTypeForDiscountRule === "TV" && newKtDiscountRules.ì´ì•¡ê²°í•©í• ì¸?.["1G"]?.TV?.["ëª¨ë°”ì¼_ê²°í•©ì‹œ"] && numMobileLines > 0) { internetDiscount = newKtDiscountRules.ì´ì•¡ê²°í•©í• ì¸["1G"]["TV"]["ëª¨ë°”ì¼_ê²°í•©ì‹œ"]; }
                } else if (discountType === 'premiumFamilyBundle') {
                    const firstLineCost = numMobileLines > 0 ? mobileLinesData[0].cost : 0;
                    if (numMobileLines > 0 && firstLineCost >= 80000 && currentInternet.speed >= 500) {
                        const fullKey = (currentInternet.speed >= 1000 ? "1G" : "500M") + (isTvOrPhoneBundled ? "_TV" : "_ë‹¨ë…");
                        internetDiscount = newKtDiscountRules.í”„ë¦¬ë¯¸ì—„ê°€ì¡±ê²°í•©?.[fullKey] || 0;
                    }
                } else if (discountType === 'premiumSingleBundle') {
                    const singleLineCost = numMobileLines === 1 ? mobileLinesData[0].cost : 0;
                    if (singleLineCost >= 80000 && currentInternet.speed >= 500 && !isTvOrPhoneBundled) {
                        const speedKey = (currentInternet.speed === 500 ? "500M" : "1G") + "_ë‹¨ë…";
                        internetDiscount = newKtDiscountRules.í”„ë¦¬ë¯¸ì—„ì‹±ê¸€ê²°í•©?.[speedKey] || 0;
                    }
                } else if (discountType === 'mvnoBundle' || discountType === 'familyBundle') {
                    const fullKey = internetSpeedType + "_" + bundleTypeForDiscountRule;
                    const rule = discountType === 'mvnoBundle' ? newKtDiscountRules.ì•Œëœ°í°ê²°í•© : newKtDiscountRules.íŒ¨ë°€ë¦¬ê²°í•©;
                    internetDiscount = rule?.[fullKey] || 0;
                } else if (discountType === 'separateFamilyBundle' && isTvOrPhoneBundled) {
                    let speedKeyForë”°ì‚´ = (currentInternet.speed === 500) ? "500M_TV" : (currentInternet.speed >= 1000) ? "1G_TV" : "";
                    let mobileTierKeyForë”°ì‚´ = getMobileTierKeyForSeparateFamily(totalMobileBaseCost, numMobileLines);
                    if (speedKeyForë”°ì‚´ && mobileTierKeyForë”°ì‚´ && newKtDiscountRules["ë”°ë¡œì‚´ì•„ë„ ê°€ì¡±ê²°í•©"]?.[speedKeyForë”°ì‚´]?.[mobileTierKeyForë”°ì‚´]) {
                        internetDiscount = newKtDiscountRules["ë”°ë¡œì‚´ì•„ë„ ê°€ì¡±ê²°í•©"][speedKeyForë”°ì‚´][mobileTierKeyForë”°ì‚´];
                        currentTvDiscount = newKtDiscountRules["ë”°ë¡œì‚´ì•„ë„ ê°€ì¡±ê²°í•©"][speedKeyForë”°ì‚´].tvDiscount || 0;
                    }
                }
                internetDiscount = Math.min(internetDiscount, internetBase);
                mobileDiscountDescription = '<div class="space-y-3">';
                let mobileLineItemsHtml = '';
                totalMobileDiscount = 0;
                
                let premiumFamilyProportionalDiscounts = new Map();
                let totalAmountProportionalDiscounts = new Map();

                // âœ¨ [ìˆ˜ì •ë¨] ì´ì•¡ê²°í•©í• ì¸ ê¸°ì—¬ë„ ê¸°ë°˜ ë¶„ë°° ë¡œì§
                if (discountType === 'totalAmountBundle' && numMobileLines > 0 && totalMobileBaseCost > 0) {
                    const internetSpeedKeyForJson = (currentInternet.speed >= 500) ? "500M_1G" : "100M";
                    let mobileTierKeyForJson = null;
                    if (totalMobileBaseCost < 22000) mobileTierKeyForJson = "tier1_under_22000";
                    else if (totalMobileBaseCost < 64900) mobileTierKeyForJson = "tier2_22000_to_64899";
                    else if (totalMobileBaseCost < 108900) mobileTierKeyForJson = "tier3_64900_to_108899";
                    else if (totalMobileBaseCost < 141900) mobileTierKeyForJson = "tier4_108900_to_141899";
                    else if (totalMobileBaseCost < 174900) mobileTierKeyForJson = "tier5_141900_to_174899";
                    else mobileTierKeyForJson = "tier6_over_174900";
                    const discountInfo = kt_total_mobile_fee_discounts[internetSpeedKeyForJson]?.[mobileTierKeyForJson];
                    const totalMobileDiscountForGroup = discountInfo?.mobile_discount || 0;

                    if (totalMobileDiscountForGroup > 0) {
                        let distributedSum = 0;
                        mobileLinesData.forEach((line, index) => {
                            if (index < numMobileLines - 1) {
                                const discount = Math.round(totalMobileDiscountForGroup * (line.cost / totalMobileBaseCost));
                                totalAmountProportionalDiscounts.set(index, discount);
                                distributedSum += discount;
                            }
                        });
                        if (numMobileLines > 0) {
                           totalAmountProportionalDiscounts.set(numMobileLines - 1, totalMobileDiscountForGroup - distributedSum);
                        }
                    }
                }

                if (discountType === 'premiumFamilyBundle' && numMobileLines > 0) {
                    const linesUnder77k = mobileLinesData.map((line, index) => ({ ...line, originalIndex: index })).filter((line, index) => index > 0 && line.cost > 0 && line.cost < 77000);
                    if (linesUnder77k.length > 0 && mobileLinesData[0].cost > 0) {
                        const participatingLines = [{ ...mobileLinesData[0], originalIndex: 0 }, ...linesUnder77k];
                        const totalCostForSpecialCalc = participatingLines.reduce((sum, line) => sum + line.cost, 0);
                        const internetSpeedKeyForJson = (currentInternet.speed >= 500) ? "500M_1G" : "100M";
                        let mobileTierKeyForJson = null;
                        if (totalCostForSpecialCalc < 22000) { mobileTierKeyForJson = "tier1_under_22000"; } 
                        else if (totalCostForSpecialCalc < 64900) { mobileTierKeyForJson = "tier2_22000_to_64899"; } 
                        else if (totalCostForSpecialCalc < 108900) { mobileTierKeyForJson = "tier3_64900_to_108899"; } 
                        else if (totalCostForSpecialCalc < 141900) { mobileTierKeyForJson = "tier4_108900_to_141899"; } 
                        else if (totalCostForSpecialCalc < 174900) { mobileTierKeyForJson = "tier5_141900_to_174899"; } 
                        else { mobileTierKeyForJson = "tier6_over_174900"; }
                        const discountInfo = kt_total_mobile_fee_discounts[internetSpeedKeyForJson]?.[mobileTierKeyForJson];
                        const totalMobileDiscountForGroup = discountInfo?.mobile_discount || 0;
                        if (totalMobileDiscountForGroup > 0) {
                            let distributedSum = 0;
                            participatingLines.filter(p => p.originalIndex !== 0).forEach(pLine => { const discount = Math.round(totalMobileDiscountForGroup * (pLine.cost / totalCostForSpecialCalc)); premiumFamilyProportionalDiscounts.set(pLine.originalIndex, discount); distributedSum += discount; });
                            premiumFamilyProportionalDiscounts.set(0, totalMobileDiscountForGroup - distributedSum);
                        }
                    }
                }
                
                mobileLinesData.forEach((line, i) => {
                    if (line.cost === 0) return;
                    let selectiveDiscount = line.applySelectiveContract ? Math.floor(line.cost * 0.25) : 0;
                    let bundleDiscount = 0;
                    let totalAmountLineDiscount = totalAmountProportionalDiscounts.get(i) || 0;
                    
                    // âœ¨ [ìˆ˜ì •ë¨] í”„ë¦¬ë¯¸ì—„ ê²°í•© í• ì¸ ê³„ì‚° ì‹œ 8ë§Œì› ê¸°ì¤€ìœ¼ë¡œ ë³€ê²½
                    if (discountType === 'premiumFamilyBundle') { 
                        if (premiumFamilyProportionalDiscounts.has(i)) { 
                            bundleDiscount = premiumFamilyProportionalDiscounts.get(i); 
                        } else { 
                            if (i === 0 && line.cost >= 80000) { 
                                bundleDiscount = 5500; 
                            } else if (i >= 1 && line.cost >= 80000) { 
                                bundleDiscount = Math.floor(line.cost * 0.25); 
                            } 
                        } 
                    } else if (discountType === 'premiumSingleBundle') { 
                        if (i === 0 && line.cost >= 80000) {
                            bundleDiscount = Math.floor(line.cost * 0.25); 
                        }
                    }

                    const totalLineDiscount = selectiveDiscount + bundleDiscount + totalAmountLineDiscount;
                    const finalBill = line.cost - totalLineDiscount;
                    totalMobileDiscount += totalLineDiscount;
                    let discountDetailString = '';
                    if (totalAmountLineDiscount > 0) discountDetailString += ` - ${totalAmountLineDiscount.toLocaleString()}ì›(ì´ì•¡í• ì¸)`;
                    if (bundleDiscount > 0) discountDetailString += ` - ${bundleDiscount.toLocaleString()}ì›(ê²°í•©)`;
                    if (selectiveDiscount > 0) discountDetailString += ` - ${selectiveDiscount.toLocaleString()}ì›(ì„ íƒì•½ì •)`;
                    mobileLineItemsHtml += `<div class="p-2 border-t border-slate-200"><p class="font-semibold">${line.name} (${line.cost.toLocaleString()}ì›)</p><p class="text-sm pl-2"> ã„´ ${line.cost.toLocaleString()}ì›${discountDetailString} = <strong class="text-blue-600">${finalBill.toLocaleString()}ì›</strong> <a href="${line.url}" target="_blank" class="text-blue-500 hover:underline">(ìƒì„¸)</a></p></div>`;
                });

                if (mobileLineItemsHtml) mobileDiscountDescription += mobileLineItemsHtml;
                else if (numMobileLines > 0) mobileDiscountDescription += `<p>ê²°í•©ì— ë”°ë¥¸ ëª¨ë°”ì¼ í• ì¸ ì—†ìŒ.</p>`;
                mobileDiscountDescription += '</div>';
            }
            const finalInternetComponentCost_NoDiscount = internetBase + actualWifiRouterFee + tvBase + additionalTvCost + phoneBase + addonServicesTotalCost;
            const finalInternetComponentCost_WithDiscount = (internetBase - internetDiscount) + actualWifiRouterFee + (tvBase - currentTvDiscount) + additionalTvCost + phoneBase + addonServicesTotalCost;
            let finalMonthlyDisplayCost = (displayMode === 'preApplied') ? finalInternetComponentCost_WithDiscount : finalInternetComponentCost_NoDiscount;
            summaryFinalCostEl.textContent = `${finalMonthlyDisplayCost.toLocaleString()} ì›`;
            if (summaryPreDiscountCostEl) {
                if (finalInternetComponentCost_NoDiscount > finalMonthlyDisplayCost) {
                    summaryPreDiscountCostEl.textContent = `í• ì¸ ì „ ${finalInternetComponentCost_NoDiscount.toLocaleString()} ì›`;
                    summaryPreDiscountCostEl.style.display = 'block';
                } else {
                    summaryPreDiscountCostEl.style.display = 'none';
                }
            }
            summaryInternetDiscountEl.textContent = `- ${(internetDiscount + currentTvDiscount).toLocaleString()} ì›`;
            summaryMobileDiscountEl.textContent = `- ${totalMobileDiscount.toLocaleString()} ì›`;
            let internetPlanText = internetPlanName !== 'none' ? internetPlanEl.options[internetPlanEl.selectedIndex].text.split(" (")[0] : 'ë¯¸ì„ íƒ';
            selectedInternetEl.textContent = internetPlanText;
            selectedTvEl.textContent = tvPlanName !== 'none' ? tvPlanEl.options[tvPlanEl.selectedIndex].text.split(" (")[0] : 'ë¯¸ì„ íƒ';
            selectedAdditionalTvEl.textContent = additionalTvPlanKey !== 'none' ? additionalTvPlans_KT[additionalTvPlanKey].name : 'ë¯¸ì„ íƒ';
            selectedPhoneEl.textContent = phonePlanName !== 'none' ? phonePlanEl.options[phonePlanEl.selectedIndex].text.split(" (")[0] : 'ë¯¸ì„ íƒ';
            selectedWifiEl.textContent = selectedWifiName || 'ë¯¸ì„ íƒ';
            selectedMobileCountEl.textContent = numMobileLines;
            if (selectedWifiData && selectedWifiData.promotion) {
                selectedWifiDetailsEl.innerHTML = `<p class="text-sm text-sky-700 mt-1"> ã„´ í”„ë¡œëª¨ì…˜: ${selectedWifiData.promotion} ${selectedWifiData.url ? `<a href="${selectedWifiData.url}" target="_blank" class="font-semibold underline hover:text-sky-500 ml-2">[ì œí’ˆ ìƒì„¸ì •ë³´]</a>` : ''}</p>`;
            } else {
                selectedWifiDetailsEl.innerHTML = '';
            }
            const discountTypeMap = { none: "ê²°í•© í• ì¸ ì—†ìŒ", totalAmountBundle: "ì´ì•¡ ê²°í•©í• ì¸", premiumFamilyBundle: "í”„ë¦¬ë¯¸ì—„ ê°€ì¡±ê²°í•©", premiumSingleBundle: "í”„ë¦¬ë¯¸ì—„ ì‹±ê¸€ê²°í•©", mvnoBundle: "ì•Œëœ°í° ê²°í•©", familyBundle: "íŒ¨ë°€ë¦¬ ê²°í•© (ì¸í„°ë„· ì¶”ê°€íšŒì„ )", separateFamilyBundle: "ë”°ë¡œ ì‚´ì•„ë„ ê°€ì¡±ê²°í•©" };
            selectedDiscountTypeEl.textContent = discountTypeMap[discountType] || "ì•Œ ìˆ˜ ì—†ìŒ";
            detailInternetBaseEl.textContent = `${(internetBase + tvBase + additionalTvCost + phoneBase + addonServicesTotalCost).toLocaleString()} ì›`;
            detailWifiFeeEl.textContent = `${actualWifiRouterFee.toLocaleString()} ì›`;
            detailInternetDiscountTotalEl.textContent = `- ${(internetDiscount + currentTvDiscount).toLocaleString()} ì›`;
            detailFinalCostEl.textContent = `${finalMonthlyDisplayCost.toLocaleString()} ì›`;
            mobileDiscountDetailContainerEl.innerHTML = mobileDiscountDescription;
            let giftCash = 0, giftVoucher = 0, giftPhoneVoucherAmount = 0, giftAdditionalTvAmount = 0, giftDongpanAdditionalCashAmount = 0;
            if (internetPlanName !== 'none') {
                const internetSpeed = currentInternet.speed;
                const isTvSelectedForGift = tvPlanName !== 'none';
                const tvCategoryForGift = isTvSelectedForGift ? (tvPlanEl.options[tvPlanEl.selectedIndex].dataset.category || "ë² ì´ì§") : "ë² ì´ì§";
                let giftKeyPrefix = "";
                if (!isTvSelectedForGift) { if (internetSpeed === 100) giftKeyPrefix = "100ë‹¨ë…"; else if (internetSpeed === 500) giftKeyPrefix = "500ë‹¨ë…"; else if (internetSpeed >= 1000) giftKeyPrefix = "1Gë‹¨ë…"; }
                else { if (internetSpeed === 100) giftKeyPrefix = "100ë²ˆë“¤"; else if (internetSpeed === 500) giftKeyPrefix = "500ë²ˆë“¤"; else if (internetSpeed >= 1000) giftKeyPrefix = "ê¸°ê°€ë²ˆë“¤"; }
                if (giftTable[tvCategoryForGift] && giftTable[tvCategoryForGift][giftKeyPrefix]) { giftCash = giftTable[tvCategoryForGift][giftKeyPrefix].cash; giftVoucher = giftTable[tvCategoryForGift][giftKeyPrefix].voucher; }
                if (isDongpanChecked && numMobileLines > 0) {
                    const dongpanBundleType = isTvSelectedForGift ? "TVë²ˆë“¤" : "ë‹¨ë…";
                    let internetGiftKeyPart = (internetSpeed === 100) ? "100M" : (internetSpeed === 500) ? "500M" : "1G";
                    const maxDongpanLines = isTvSelectedForGift ? 3 : 1;
                    for (let i = 0; i < Math.min(numMobileLines, maxDongpanLines); i++) {
                        const mobileLineFee = mobileLinesData[i].cost;
                        let mobileFeeTierKey = null;
                        if (mobileLineFee >= 37000 && mobileLineFee < 61000) mobileFeeTierKey = "37K";
                        else if (mobileLineFee >= 61000 && mobileLineFee < 90000) mobileFeeTierKey = "61K";
                        else if (mobileLineFee >= 90000) mobileFeeTierKey = "90K";
                        if (mobileFeeTierKey && internetGiftKeyPart) { const giftKey = internetGiftKeyPart + "_" + dongpanBundleType; if (dongpanAdditionalGiftTable_KT[mobileFeeTierKey] && dongpanAdditionalGiftTable_KT[mobileFeeTierKey][giftKey]) giftDongpanAdditionalCashAmount += dongpanAdditionalGiftTable_KT[mobileFeeTierKey][giftKey]; }
                    }
                }
            }
            if (phonePlanName !== 'none') giftPhoneVoucherAmount = 20000;
            if (additionalTvPlanKey !== 'none') giftAdditionalTvAmount = 30000;
            const totalGift = giftCash + giftVoucher + giftPhoneVoucherAmount + giftAdditionalTvAmount + giftDongpanAdditionalCashAmount;
            summaryGiftTotalEl.textContent = `${totalGift.toLocaleString()} ì›`;
            giftCashEl.textContent = `${giftCash.toLocaleString()} ì›`;
            giftVoucherEl.textContent = `${giftVoucher.toLocaleString()} ì›`;
            giftPhoneVoucherEl.textContent = `${giftPhoneVoucherAmount.toLocaleString()} ì›`;
            giftAdditionalTvEl.textContent = `${giftAdditionalTvAmount.toLocaleString()} ì›`;
            dongpanCashContainerKtEl.classList.toggle('hidden', !isDongpanChecked || giftDongpanAdditionalCashAmount === 0);
            giftDongpanAdditionalCashKtEl.textContent = `${giftDongpanAdditionalCashAmount.toLocaleString()} ì›`;
            giftTotalEl.textContent = `${totalGift.toLocaleString()} ì›`;
            const installInfo = calculateInstallationFee(internetPlanName !== 'none', tvPlanName !== 'none', phonePlanName, additionalTvPlanKey !== 'none', installationTime);
            installationFeeResultEl.textContent = `${installInfo.fee.toLocaleString()} ì›`;
            installationFeeDescriptionEl.textContent = `(${installInfo.desc}, ${installationTime === 'weekday' ? 'í‰ì¼ ì£¼ê°„' : 'ì£¼ë§/ì•¼ê°„'} ê¸°ì¤€)`;
            const tvOptionForMessage = tvPlanEl.options[tvPlanEl.selectedIndex];
            const firstTvTextForMessage = tvOptionForMessage.value !== 'none' ? tvOptionForMessage.text.split(' (')[0] : 'ë¯¸ì„ íƒ';
            const additionalTvTextForMessage = additionalTvPlanKey !== 'none' ? ` + (ì¶”ê°€)${additionalTvPlans_KT[additionalTvPlanKey].name}` : "";
            const giftAmountText = summaryGiftTotalEl.textContent.trim();
            const consultMessage = `[KT ê²°í•© ê³„ì‚°ê¸° ë¬¸ì˜]\n- ì¸í„°ë„·: ${internetPlanText}\n- TV: ${firstTvTextForMessage}${additionalTvTextForMessage}\n- í• ì¸ìœ í˜•: ${selectedDiscountTypeEl.textContent}\n- ìµœì¢… ì›” ìš”ê¸ˆ: ${finalMonthlyDisplayCost.toLocaleString()}ì›\n- ì´ ì‚¬ì€í’ˆ: ${giftAmountText}\n\nìœ„ ë‚´ìš©ìœ¼ë¡œ ìƒë‹´ ë¶€íƒë“œë¦½ë‹ˆë‹¤.`;
            const encodedMessage = encodeURIComponent(consultMessage);
            kakaoBtn.href = `https://pf.kakao.com/${kakaoChannelId}/chat?text=${encodedMessage}`;
            smsBtn.href = `sms:${myPhoneNumber}?body=${encodedMessage}`;
            resultSection.classList.remove('hidden');
            customerConsultSection.classList.remove('hidden');
            installationFeeSectionEl.classList.remove('hidden');
        } catch (error) {
            console.error("ê³„ì‚° ì¤‘ ì˜¤ë¥˜ ë°œìƒ:", error);
            // alert("ê³„ì‚° ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤. ì…ë ¥ ê°’ì„ í™•ì¸í•˜ê±°ë‚˜ ì ì‹œ í›„ ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.");
        }
    }
    function resetCalculator() {
        setInitialDefaults();
        resultSection.classList.add('hidden');
        customerConsultSection.classList.add('hidden');
        installationFeeSectionEl.classList.add('hidden');
        expandedDetailsContainer.classList.add('hidden');
        toggleDetailsButton.innerHTML = 'ìƒì„¸ ìš”ê¸ˆ ë‚´ì—­ í¼ì³ë³´ê¸° â–¼';
        if(selectedWifiDetailsEl) selectedWifiDetailsEl.innerHTML = '';
        window.scrollTo(0, 0);
    }
    function setInitialDefaults() {
        document.querySelector('input[name="internetType"][value="standalone"]').checked = true;
        populateInternetPlans();
        internetPlanEl.value = "KTì¸í„°ë„·(ë‹¨ë…) 100mb";
        tvPlanEl.value = "none";
        additionalTvPlanEl.value = "none";
        phonePlanEl.value = "none";
        wifiRouterRentalEl.value = "1100";
        wifiRouterRentalEl.disabled = false;
        const addonCheckboxes = document.querySelectorAll('#addonServicesContainer input[type="checkbox"]');
        addonCheckboxes.forEach(cb => cb.checked = false);
        document.querySelector('input[name="discountType"][value="totalAmountBundle"]').checked = true;
        document.querySelector('input[name="displayModeKt"][value="preApplied"]').checked = true;
        document.querySelector('input[name="installationTime"][value="weekday"]').checked = true;
        if (dongpanSalesCheckKtEl) {
            dongpanSalesCheckKtEl.checked = false;
            if(dongpanPolicyDetailsContainerKtEl) dongpanPolicyDetailsContainerKtEl.classList.add('hidden');
        }
        allDetailSections.forEach(section => {
            if (section.containerEl && section.toggleEl) {
                const isSelected = document.querySelector(`input[name="discountType"][value="${section.radioValue}"]`).checked;
                let shouldBeVisible = false;
                if (isSelected) {
                    section.toggleEl.checked = false;
                    shouldBeVisible = section.toggleEl.checked;
                } else {
                    section.toggleEl.checked = false;
                }
                section.containerEl.classList.toggle('hidden', !shouldBeVisible);
            }
        });
        document.querySelector('input[name="internetType"]:checked').dispatchEvent(new Event('change'));
        document.querySelector('input[name="discountType"]:checked').dispatchEvent(new Event('change'));
        document.querySelectorAll('.selective-contract-checkbox').forEach(cb => cb.checked = false);
    }
    window.onload = setInitialDefaults;
    </script>
</body>
</html>
